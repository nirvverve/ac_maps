(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{425:function(e,s,t){Promise.resolve().then(t.bind(t,9407))},9407:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return to}});var l=t(7437),a=t(2265),r=t(605),n=t(7648),i=t(3145),o=t(6070),c=t(2869),d=t(5974),m=t(3774),x=t(2048),h=t(1671),u=t(7168),f=t(5805),p=t(8420),j=t(4401),g=t(525),b=t(5252),N=t(8406),y=t(3247),v=t(6215),C=t(740),w=t(1964);let k=["places","geometry"];function S({children:e}){let{isLoaded:s,loadError:t}=(0,w.Db)({googleMapsApiKey:"AIzaSyAKMtorawPHrpVNqAZlv5vUpfMSDif57MQ",libraries:k});return t?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center text-red-600",children:[(0,l.jsx)("p",{className:"font-semibold mb-2",children:"Error loading Google Maps"}),(0,l.jsx)("p",{className:"text-sm",children:"Please check your internet connection and try refreshing the page."})]})}):s?(0,l.jsx)(l.Fragment,{children:e}):(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Loading maps..."})]})})}var z=t(5186),T=t(2489),Z=t(4508);let A={width:"100%",height:"600px"},R={lat:33.4484,lng:-112.074},P={disableDefaultUI:!1,zoomControl:!0,streetViewControl:!1,mapTypeControl:!0,fullscreenControl:!0,styles:[{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]};function E({territoryData:e,areaFilter:s}){let[t,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(!1),[d,x]=(0,a.useState)([]),[h,u]=(0,a.useState)(!0),[j,g]=(0,a.useState)([]),[b,N]=(0,a.useState)(null),[v,C]=(0,a.useState)(""),[k,S]=(0,a.useState)(null),E=(0,a.useRef)(null);(0,a.useEffect)(()=>{n&&e?.length&&E.current&&(async()=>{u(!0);try{let s=await fetch("/api/zip-boundaries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({zipCodes:e.map(e=>({zip:e.zip,area:e.area}))})});if(s.ok){let e=await s.json();x(e.boundaries||[])}}catch(e){console.error("Error loading zip boundaries:",e)}finally{u(!1)}})()},[n,e]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/office-locations.json");if(e.ok){let s=await e.json();g(s)}}catch(e){console.error("Error loading office locations:",e)}})()},[]);let F=(0,a.useMemo)(()=>{let s={};return d?.length>0?d.forEach(e=>{s[e.zipCode]=e.center}):e?.forEach(e=>{if(e?.zip){let t=Math.abs(e.zip.toString().split("").reduce((e,s)=>(e=(e<<5)-e+s.charCodeAt(0))&e,0))/2147483647;s[e.zip]={lat:33.2+t%1*(33.7-33.2),lng:-112.4+1.618*t%1*(-111.6- -112.4)}}}),s},[e,d]),M=(e,s=!1)=>{let t={West:{fill:"#3B82F6",stroke:"#2563EB"},Central:{fill:"#10B981",stroke:"#059669"},East:{fill:"#F59E0B",stroke:"#D97706"},Tucson:{fill:"#A855F7",stroke:"#9333EA"}}[e]||{fill:"#6B7280",stroke:"#4B5563"};return{fillColor:t.fill,fillOpacity:s?.6:.35,strokeColor:s?"#DC2626":t.stroke,strokeOpacity:s?1:.8,strokeWeight:s?4:2,clickable:!0,draggable:!1,editable:!1,geodesic:!1,zIndex:s?100:1}},$=e=>({path:google?.maps?.SymbolPath?.CIRCLE||0,scale:8,fillColor:({West:"#3B82F6",Central:"#10B981",East:"#F59E0B",Tucson:"#A855F7"})[e]||"#6B7280",fillOpacity:.9,strokeWeight:2,strokeColor:"#FFFFFF"}),O=(0,a.useCallback)(e=>{r(e)},[]),L=(0,a.useCallback)(()=>{r(null)},[]),D=(0,a.useCallback)(()=>{let s=v.trim();if(!s||!E.current)return;let t=e.find(e=>e.zip===s);if(t){let e=F[s];e&&(E.current.panTo(e),E.current.setZoom(13),S(s),r(t))}else alert(`ZIP code ${s} not found in territory data.`)},[v,e,F]),I=(0,a.useCallback)(()=>{C(""),S(null),r(null),E.current&&(E.current.panTo(R),E.current.setZoom(10))},[]),Y=(0,a.useCallback)(e=>{"Enter"===e.key&&D()},[D]);return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(o.Zb,{className:"mb-4 bg-white/90 backdrop-blur-sm border-0 shadow-md",children:(0,l.jsx)(o.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Search ZIP Code:"})]}),(0,l.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,l.jsx)(z.I,{type:"text",placeholder:"Enter 5-digit ZIP code...",value:v,onChange:e=>C(e.target.value),onKeyPress:Y,className:"max-w-xs",maxLength:5}),(0,l.jsxs)(c.z,{onClick:D,size:"sm",className:"gap-2",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4"}),"Search"]}),(v||k)&&(0,l.jsxs)(c.z,{onClick:I,size:"sm",variant:"outline",className:"gap-2",children:[(0,l.jsx)(T.Z,{className:"h-4 w-4"}),"Clear"]})]}),k&&(0,l.jsxs)("div",{className:"text-sm text-slate-600 bg-blue-50 px-3 py-1.5 rounded-md border border-blue-200",children:["Viewing: ",(0,l.jsxs)("span",{className:"font-semibold text-blue-700",children:["ZIP ",k]})]})]})})}),(0,l.jsxs)(w.b6,{mapContainerStyle:A,center:R,zoom:8,options:P,onLoad:e=>{E.current=e,i(!0)},children:[n&&d?.map(t=>{if(!s[t.area]||!t.paths?.length)return null;let a=k===t.zipCode.toString();return l.jsx(w.Q8,{paths:t.paths,options:M(t.area,a),onClick:()=>{let s=e.find(e=>parseInt(e.zip)===t.zipCode);s&&O(s)}},`polygon-${t.zipCode}`)}),n&&e?.map(e=>{let s=F?.[e?.zip];return s&&e?.zip?l.jsx(w.jC,{position:s,icon:$(e?.area||""),onClick:()=>O(e),title:`ZIP ${e.zip} - ${e?.area||""} Area`},`marker-${e.zip}`):null}),j.filter(e=>!1!==s[e.area]).map(e=>{let s="NEXT YEAR"===e.category;return(0,l.jsx)(w.jC,{position:{lat:e.lat,lng:e.lng},icon:{path:"M 0,-24 L 6,-8 L 24,-8 L 10,4 L 16,20 L 0,8 L -16,20 L -10,4 L -24,-8 L -6,-8 Z",fillColor:s?"#DC2626":"#F97316",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:s?.7:.6,anchor:new google.maps.Point(0,0)},onClick:()=>N(e),title:e.label,zIndex:1e3},`office-${e.zipCode}-${e.category}`)}),t&&F?.[t?.zip]&&(0,l.jsx)(w.kp,{position:F[t.zip],onCloseClick:L,children:(0,l.jsxs)("div",{className:"p-3 min-w-0 max-w-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:t?.area==="West"?"#3B82F6":t?.area==="Central"?"#10B981":t?.area==="East"?"#F59E0B":t?.area==="Tucson"?"#A855F7":"#6B7280"}}),(0,l.jsxs)("h3",{className:"font-semibold text-slate-900",children:["ZIP ",t?.zip||"N/A"]})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsx)("span",{className:"text-slate-600",children:t?.area?(0,Z.G)(t.area):"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:[t?.accounts||0," Active Accounts"]})]})]})]})}),b&&(0,l.jsx)(w.kp,{position:{lat:b.lat,lng:b.lng},onCloseClick:()=>N(null),children:(0,l.jsxs)("div",{className:"p-3 min-w-0 max-w-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:"NEXT YEAR"===b.category?"#DC2626":"#F97316"}}),(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:b.label})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsx)("span",{className:"text-slate-600",children:b.fullName||(0,Z.G)(b.area)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:["ZIP ",b.zipCode]})]}),(0,l.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-200",children:(0,l.jsx)("span",{className:`text-xs font-medium px-2 py-1 rounded ${"NEXT YEAR"===b.category?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:b.category})})]})]})})]}),(h||!n)&&(0,l.jsx)("div",{className:"absolute inset-0 bg-slate-100/90 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:n?"Loading territory boundaries...":"Initializing map..."})]})})]})}let F={width:"100%",height:"600px"},M=e=>"miami"===e?{lat:25.7617,lng:-80.1918}:"dallas"===e?{lat:32.7767,lng:-96.797}:"orlando"===e?{lat:28.5383,lng:-81.3792}:"jacksonville"===e?{lat:30.3322,lng:-81.6557}:"portCharlotte"===e?{lat:26.9762,lng:-82.0909}:{lat:33.4484,lng:-112.074};function $({densityMode:e,areaFilter:s,location:t,accountType:r="residential"}){let[n,i]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[d,m]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),[u,f]=(0,a.useState)([]),[p,j]=(0,a.useState)(null),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e="/density-data.json";"miami"===t?e="commercial"===r?"/miami-commercial-density-data.json":"/miami-density-data.json":"dallas"===t?e="commercial"===r?"/dallas-commercial-density-data.json":"/dallas-density-data.json":"orlando"===t?e="commercial"===r?"/orlando-commercial-density-data.json":"/orlando-density-data.json":"jacksonville"===t&&(e="commercial"===r?"/jacksonville-commercial-density-data.json":"/jacksonville-density-data.json"),fetch(e).then(e=>e.json()).then(e=>i(e)).catch(e=>console.error("Error loading density data:",e))},[t,r]),(0,a.useEffect)(()=>{x&&n.length&&g.current&&(async()=>{try{if("miami"===t){let e=await fetch("/miami-zip-boundaries.json"),s=await e.json(),t=n.map(e=>{let t=s[e.zipCode];if(!t||!t.coordinates)return{...e,center:{lat:e.latitude||25.7617,lng:e.longitude||-80.1918}};let l={type:t.type,coordinates:t.coordinates};return{...e,geometry:l,center:b(l)}});c(t)}else if("dallas"===t){let e=await fetch("/dallas-zip-boundaries.json"),s=await e.json(),t=n.map(e=>{let t=s.find(s=>s.zipCode===e.zipCode);return t&&t.geometry?{...e,geometry:t.geometry,center:b(t.geometry)}:{...e,center:{lat:e.latitude||32.7767,lng:e.longitude||-96.797}}});c(t)}else if("orlando"===t){let e=await fetch("/orlando-zip-boundaries.json"),s=await e.json(),t=n.map(e=>{let t=s.find(s=>s.zipCode===e.zipCode);return t&&t.geometry?{...e,geometry:t.geometry,center:b(t.geometry)}:{...e,center:{lat:e.latitude||28.5383,lng:e.longitude||-81.3792}}});c(t)}else if("jacksonville"===t){let e=await fetch("/jacksonville-zip-boundaries.json"),s=await e.json(),t=n.map(e=>{let t=e.zip||e.zipCode,l=s[t];if(!l||!l.coordinates)return{...e,zipCode:t};let a={type:l.type,coordinates:l.coordinates};return{...e,zipCode:t,geometry:a,center:b(a)}});c(t)}else{let e=await fetch("/az-zip-boundaries.json"),t=await e.json(),l=n.filter(e=>e.area&&s[e.area]).map(e=>{let s=t.features?.find(s=>s.properties?.ZCTA5CE10===e.zipCode);return s?{...e,geometry:s.geometry,center:b(s.geometry)}:null}).filter(Boolean);c(l)}}catch(e){console.error("Error loading boundaries:",e)}})()},[x,n,s,t]),(0,a.useEffect)(()=>{if("arizona"!==t){f([]);return}(async()=>{try{let e=await fetch("/office-locations.json");if(e.ok){let s=await e.json();f(s)}}catch(e){console.error("Error loading office locations:",e)}})()},[t]);let b=e=>{if(!e?.coordinates)return{lat:33.4484,lng:-112.074};let s="Polygon"===e.type?e.coordinates[0]:e.coordinates[0][0],t=s.map(e=>e[1]),l=s.map(e=>e[0]);return{lat:(Math.min(...t)+Math.max(...t))/2,lng:(Math.min(...l)+Math.max(...l))/2}},N=s=>{if("active"===e){let e=s.activeCount;return"miami"===t&&"commercial"===r?0===e?"#f0fdf4":e<=2?"#d1fae5":e<=4?"#a7f3d0":e<=6?"#6ee7b7":e<=9?"#34d399":e<=12?"#10b981":e<=15?"#059669":e<=18?"#047857":"#065f46":"miami"===t?0===e?"#f0fdf4":e<=10?"#d1fae5":e<=20?"#a7f3d0":e<=35?"#6ee7b7":e<=50?"#34d399":e<=75?"#10b981":e<=100?"#059669":e<=125?"#047857":"#065f46":"dallas"===t&&"commercial"===r?0===e?"#f0fdf4":1===e?"#6ee7b7":"#10b981":"dallas"===t?0===e?"#f0fdf4":e<=5?"#d1fae5":e<=10?"#a7f3d0":e<=20?"#6ee7b7":e<=30?"#34d399":e<=40?"#10b981":e<=50?"#059669":"#047857":"orlando"===t&&"commercial"===r?0===e?"#f0fdf4":e<=2?"#d1fae5":e<=4?"#6ee7b7":e<=6?"#34d399":e<=9?"#10b981":"#059669":"orlando"===t?0===e?"#f0fdf4":e<=10?"#d1fae5":e<=20?"#a7f3d0":e<=35?"#6ee7b7":e<=50?"#34d399":e<=70?"#10b981":e<=90?"#059669":"#047857":"jacksonville"===t&&"commercial"===r?0===e?"#f0fdf4":1===e?"#6ee7b7":"#10b981":"jacksonville"===t?0===e?"#f0fdf4":e<=10?"#d1fae5":e<=25?"#a7f3d0":e<=40?"#6ee7b7":e<=60?"#34d399":e<=80?"#10b981":e<=110?"#059669":"#047857":0===e?"#f0fdf4":e<=5?"#d1fae5":e<=15?"#86efac":e<=30?"#22c55e":e<=50?"#16a34a":"#15803d"}if("terminated"===e){let e=s.terminatedCount;return"miami"===t&&"commercial"===r?0===e?"#fef2f2":e<=3?"#fecaca":e<=6?"#fca5a5":e<=9?"#f87171":e<=12?"#ef4444":e<=15?"#dc2626":e<=18?"#b91c1c":e<=21?"#991b1b":"#7f1d1d":"miami"===t?0===e?"#fef2f2":e<=15?"#fecaca":e<=30?"#fca5a5":e<=50?"#f87171":e<=75?"#ef4444":e<=100?"#dc2626":e<=150?"#b91c1c":e<=200?"#991b1b":"#7f1d1d":"dallas"===t&&"commercial"===r?0===e?"#fef2f2":e<=2?"#fecaca":e<=4?"#fca5a5":e<=6?"#f87171":e<=8?"#ef4444":"#dc2626":"dallas"===t?0===e?"#fef2f2":e<=20?"#fecaca":e<=40?"#fca5a5":e<=60?"#f87171":e<=80?"#ef4444":e<=100?"#dc2626":e<=150?"#b91c1c":"#991b1b":"orlando"===t&&"commercial"===r?0===e?"#fef2f2":e<=5?"#fecaca":e<=10?"#fca5a5":e<=15?"#f87171":e<=20?"#ef4444":e<=30?"#dc2626":"#b91c1c":"orlando"===t?0===e?"#fef2f2":e<=10?"#fecaca":e<=20?"#fca5a5":e<=30?"#f87171":e<=50?"#ef4444":e<=75?"#dc2626":e<=100?"#b91c1c":"#991b1b":"jacksonville"===t&&"commercial"===r?"#fef2f2":"jacksonville"===t?0===e?"#fef2f2":e<=5?"#fecaca":e<=10?"#fca5a5":e<=20?"#f87171":e<=30?"#ef4444":e<=50?"#dc2626":"#b91c1c":0===e?"#fef2f2":e<=20?"#fecaca":e<=50?"#fca5a5":e<=100?"#f87171":e<=200?"#dc2626":"#991b1b"}if("lifetime"===e){let e=s.avgCustomerLifetimeMonths||0;return 0===e?"#fef2f2":e<12?"#fbbf24":e<24?"#a3e635":e<36?"#86efac":e<60?"#22c55e":e<120?"#16a34a":"#15803d"}{let e=s.churnRate;return 0===e?"#f0fdf4":e<=50?"#d1fae5":e<=70?"#fef3c7":e<=85?"#fbbf24":e<=95?"#f97316":"#991b1b"}},y=(0,a.useCallback)(e=>{g.current=e,h(!0)},[]);return(0,l.jsxs)(w.b6,{mapContainerStyle:F,center:M(t),zoom:9,onLoad:y,options:{disableDefaultUI:!1,zoomControl:!0,streetViewControl:!1,mapTypeControl:!0,fullscreenControl:!0},children:[o.map(e=>{if(e?.geometry){var s;let a=(s=e.geometry,s?.coordinates?"Polygon"===s.type?s.coordinates.map(e=>e.map(([e,s])=>({lat:s,lng:e}))):"MultiPolygon"===s.type?s.coordinates.flatMap(e=>e.map(e=>e.map(([e,s])=>({lat:s,lng:e})))):[]:[]),r=N(e),n="miami"===t||"dallas"===t||"orlando"===t||"jacksonville"===t?{strokeColor:"#1e293b",strokeOpacity:.85,strokeWeight:2}:{strokeColor:"#64748b",strokeOpacity:.5,strokeWeight:1};return(0,l.jsx)(w.Q8,{paths:a,options:{fillColor:r,fillOpacity:.7,...n,clickable:!0},onClick:()=>m(e)},e.zipCode)}if("arizona"===t&&e?.center){let s=N(e),t=150*Math.sqrt(e.totalHistorical);return(0,l.jsx)(w.jC,{position:e.center,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:s,fillOpacity:.7,strokeColor:"#64748b",strokeOpacity:.8,strokeWeight:2,scale:Math.max(t/10,8)},onClick:()=>m(e)},e.zipCode)}return null}),u.filter(e=>!1!==s[e.area]).map(e=>{let s="NEXT YEAR"===e.category;return(0,l.jsx)(w.jC,{position:{lat:e.lat,lng:e.lng},icon:{path:"M 0,-24 L 6,-8 L 24,-8 L 10,4 L 16,20 L 0,8 L -16,20 L -10,4 L -24,-8 L -6,-8 Z",fillColor:s?"#DC2626":"#F97316",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:s?.7:.6,anchor:new google.maps.Point(0,0)},onClick:()=>j(e),title:e.label,zIndex:1e3},`office-${e.zipCode}-${e.category}`)}),d&&(0,l.jsx)(w.kp,{position:d.center,onCloseClick:()=>m(null),children:(0,l.jsxs)("div",{style:{minWidth:"250px",padding:"8px"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,l.jsxs)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"bold"},children:["ZIP ",d.zipCode]}),"arizona"===t&&d.area&&(0,l.jsx)("span",{style:{background:{West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#a855f7"}[d.area]||"#6b7280",color:"white",padding:"4px 10px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:(0,Z.G)(d.area)}),"miami"===t&&d.city&&(0,l.jsx)("span",{style:{background:"#0891b2",color:"white",padding:"4px 10px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:d.city})]}),(0,l.jsxs)("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"12px"},children:[(0,l.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,l.jsx)("span",{style:{color:"#059669",fontWeight:"600",fontSize:"20px"},children:d.activeCount}),(0,l.jsx)("span",{style:{color:"#6b7280",fontSize:"14px",marginLeft:"4px"},children:"Active Accounts"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{style:{color:"#dc2626",fontWeight:"600",fontSize:"20px"},children:d.terminatedCount}),(0,l.jsx)("span",{style:{color:"#6b7280",fontSize:"14px",marginLeft:"4px"},children:"Terminated"})]})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"13px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{color:"#6b7280",marginBottom:"2px"},children:"Total Historical"}),(0,l.jsx)("div",{style:{fontWeight:"600",fontSize:"16px"},children:d.totalHistorical})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{color:"#6b7280",marginBottom:"2px"},children:"Churn Rate"}),(0,l.jsxs)("div",{style:{fontWeight:"600",fontSize:"16px",color:d.churnRate>85?"#dc2626":d.churnRate>75?"#f97316":"#059669"},children:[d.churnRate,"%"]})]}),void 0!==d.avgCustomerLifetimeMonths&&(0,l.jsxs)("div",{style:{gridColumn:"1 / -1",marginTop:"4px"},children:[(0,l.jsx)("div",{style:{color:"#6b7280",marginBottom:"2px"},children:"Avg Customer Lifetime"}),(0,l.jsxs)("div",{style:{fontWeight:"600",fontSize:"16px",color:"#059669"},children:[d.avgCustomerLifetimeMonths.toFixed(1)," months",(0,l.jsxs)("span",{style:{color:"#6b7280",fontSize:"13px",marginLeft:"4px"},children:["(",(d.avgCustomerLifetimeMonths/12).toFixed(1)," years)"]})]})]})]})]})}),p&&(0,l.jsx)(w.kp,{position:{lat:p.lat,lng:p.lng},onCloseClick:()=>j(null),children:(0,l.jsxs)("div",{style:{minWidth:"200px",padding:"12px"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[(0,l.jsx)("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"NEXT YEAR"===p.category?"#DC2626":"#F97316"}}),(0,l.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:p.label})]}),(0,l.jsxs)("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:[(0,l.jsx)("div",{style:{marginBottom:"4px"},children:p.fullName||(0,Z.G)(p.area)}),(0,l.jsxs)("div",{style:{marginBottom:"8px"},children:["ZIP ",p.zipCode]})]}),(0,l.jsx)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:(0,l.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",padding:"4px 8px",borderRadius:"4px",backgroundColor:"NEXT YEAR"===p.category?"#FEE2E2":"#FFEDD5",color:"NEXT YEAR"===p.category?"#B91C1C":"#C2410C"},children:p.category})})]})})]})}let O={width:"100%",height:"600px"},L={lat:33.4484,lng:-112.074};function D({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[i,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),[u,f]=(0,a.useState)([]),[j,g]=(0,a.useState)(null),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/market-size-data.json");if(!e.ok)throw Error("Failed to load market data");let s=await e.json();t(s||[])}catch(e){console.error("Error loading market data:",e)}})()},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/phoenix-tucson-map-data.json");if(!e.ok)throw Error("Failed to load territory data");let s=await e.json();console.log("Territory data loaded:",s?.length,"records"),o(s||[])}catch(e){console.error("Error loading territory data:",e)}})()},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/az-zip-boundaries.json");if(!e.ok)throw Error("Failed to load zip boundaries");let s=await e.json();n(s?.features||[])}catch(e){console.error("Error loading zip boundaries:",e)}})()},[]);let N=(0,a.useCallback)(e=>{b.current=e,h(!0)},[]);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/office-locations.json");if(e.ok){let s=await e.json();f(s)}}catch(e){console.error("Error loading office locations:",e)}})()},[]);let y=e=>e>=6e3?"#1a237e":e>=4e3?"#283593":e>=3e3?"#3949ab":e>=2e3?"#5e35b1":e>=1500?"#7e57c2":e>=1e3?"#9575cd":e>=500?"#b39ddb":e>=250?"#d1c4e9":"#e8eaf6",v=i.reduce((e,s)=>(e[s.zip]=s.area,e),{}),C=r.filter(t=>{let l=t?.properties?.ZCTA5CE10;if(!l||!s.find(e=>e.zipCode===l))return!1;let a=v[l];return!a||!1!==e[a]});(0,a.useEffect)(()=>{console.log("Market Size View Debug:",{zipBoundariesCount:r.length,marketDataCount:s.length,territoryDataCount:i.length,filteredBoundariesCount:C.length,sampleMarketZips:s.slice(0,5).map(e=>e.zipCode),sampleBoundaryZips:r.slice(0,5).map(e=>e?.properties?.ZCTA5CE10)})},[r,s,i,C]);let k=e=>{let t=s.find(s=>s.zipCode===e),l=i.find(s=>s.zip===e);if(t){let s=r.find(s=>s?.properties?.ZCTA5CE10===e);if(s?.geometry?.coordinates){let a=s.geometry.coordinates[0],r=a.reduce((e,s)=>e+s[1],0),n=a.reduce((e,s)=>e+s[0],0);d({zipCode:e,position:{lat:r/a.length,lng:n/a.length},marketInfo:t,territoryInfo:l})}}};return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)(w.b6,{mapContainerStyle:O,center:L,zoom:9,onLoad:N,options:{styles:[{featureType:"all",elementType:"labels",stylers:[{visibility:"on"}]}],streetViewControl:!1,mapTypeControl:!0,fullscreenControl:!0},children:[C.map((e,t)=>{let a=e?.properties?.ZCTA5CE10,r=s.find(e=>e.zipCode===a);if(!r||!e?.geometry?.coordinates)return null;let n=e.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]})),i=y(r.permittedPools);return(0,l.jsx)(w.Q8,{paths:n,options:{fillColor:i,fillOpacity:.6,strokeColor:"#1e293b",strokeOpacity:.8,strokeWeight:1,clickable:!0},onClick:()=>k(a)},`${a}-${t}`)}),u.filter(s=>!1!==e[s.area]).map(e=>{let s="NEXT YEAR"===e.category;return(0,l.jsx)(w.jC,{position:{lat:e.lat,lng:e.lng},icon:{path:"M 0,-24 L 6,-8 L 24,-8 L 10,4 L 16,20 L 0,8 L -16,20 L -10,4 L -24,-8 L -6,-8 Z",fillColor:s?"#DC2626":"#F97316",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:s?.7:.6,anchor:new google.maps.Point(0,0)},onClick:()=>g(e),title:e.label,zIndex:1e3},`office-${e.zipCode}-${e.category}`)}),c&&(0,l.jsx)(w.kp,{position:c.position,onCloseClick:()=>d(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[200px]",children:[(0,l.jsxs)("h3",{className:"font-bold text-lg mb-2",children:["Zip Code ",c.zipCode]}),c.territoryInfo&&(0,l.jsxs)("p",{className:"text-sm text-slate-600 mb-2",children:["Area: ",(0,l.jsx)("span",{className:"font-semibold",children:(0,Z.G)(c.territoryInfo.area)})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-semibold text-blue-700",children:"Permitted Pools:"})," ",c.marketInfo.permittedPools.toLocaleString()]}),c.territoryInfo&&(0,l.jsxs)("p",{className:"text-sm text-slate-500",children:["Current Accounts: ",c.territoryInfo.accounts]}),c.territoryInfo&&c.marketInfo.permittedPools>0&&(0,l.jsxs)("p",{className:"text-sm text-slate-500",children:["Market Penetration: ",(c.territoryInfo.accounts/c.marketInfo.permittedPools*100).toFixed(1),"%"]})]})]})}),j&&(0,l.jsx)(w.kp,{position:{lat:j.lat,lng:j.lng},onCloseClick:()=>g(null),children:(0,l.jsxs)("div",{className:"p-3 min-w-0 max-w-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:"NEXT YEAR"===j.category?"#DC2626":"#F97316"}}),(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:j.label})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:[j.area," Territory"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4 text-slate-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:["ZIP ",j.zipCode]})]}),(0,l.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-200",children:(0,l.jsx)("span",{className:`text-xs font-medium px-2 py-1 rounded ${"NEXT YEAR"===j.category?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:j.category})})]})]})})]}),!x&&(0,l.jsx)("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"Rendering map..."})]})})]})}var I=t(3578),Y=t(265),W=t(5051),B=t(8842);let U={width:"100%",height:"800px"},J={lat:33.4484,lng:-111.9269},V={styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#7c93a3"},{lightness:"-10"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:"0"},{saturation:"0"},{color:"#f5f5f2"},{gamma:"1"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#C6E2FF"}]}],disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0};function X({areaFilter:e,onToggleArea:s,onResetFilters:t}){let[r,n]=(0,a.useState)([]),[i,d]=(0,a.useState)([]),[x,h]=(0,a.useState)(null),[u,p]=(0,a.useState)(null),[j,N]=(0,a.useState)([]),[y,v]=(0,a.useState)([]),[k,S]=(0,a.useState)("none");(0,a.useEffect)(()=>{fetch("/zip-revenue-data.json").then(e=>e.json()).then(e=>{n(e)}).catch(e=>console.error("Error loading revenue data:",e))},[]),(0,a.useEffect)(()=>{fetch("/az-zip-boundaries.json").then(e=>e.json()).then(e=>{e.features&&d(e.features)}).catch(e=>console.error("Error loading boundaries:",e))},[]),(0,a.useEffect)(()=>{fetch("/route-assignments.json").then(e=>e.json()).then(e=>{N(e)}).catch(e=>console.error("Error loading customer accounts:",e))},[]);let z=(0,a.useMemo)(()=>r.filter(s=>{let t=s.Territory;return("APS of Glendale"!==t||!!e.West)&&("APS of Scottsdale"!==t||!!e.Central)&&("APS of Chandler"!==t||!!e.East)&&("APS of Tucson"!==t||!!e.Tucson)}),[r,e]),T=(0,a.useCallback)(e=>e>=200?"#047857":e>=180?"#059669":e>=170?"#10b981":e>=165?"#34d399":e>=160?"#fbbf24":e>=155?"#f59e0b":"#dc2626",[]),Z=(0,a.useCallback)(e=>{switch(e){case"APS of Glendale":return"#3b82f6";case"APS of Scottsdale":return"#10b981";case"APS of Chandler":return"#f97316";case"APS of Tucson":return"#ec4899";default:return"#6b7280"}},[]),A=e=>"Polygon"===e.type?e.coordinates.map(e=>e.map(e=>({lat:e[1],lng:e[0]}))):"MultiPolygon"===e.type?e.coordinates.flatMap(e=>e.map(e=>e.map(e=>({lat:e[1],lng:e[0]})))):[],R=(0,a.useMemo)(()=>{let e=[];return z.forEach(s=>{let t=i.find(e=>e.properties?.ZCTA5CE20===s.ZIP||e.properties?.ZCTA5CE10===s.ZIP||e.properties?.ZIP===s.ZIP||e.properties?.GEOID20===s.ZIP||e.properties?.GEOID10===s.ZIP);if(t&&t.geometry){let l=A(t.geometry),a=T(s.Avg_Monthly_Price);e.push({paths:l,zipData:s,options:{fillColor:a,fillOpacity:.5,strokeColor:"#1e293b",strokeOpacity:.8,strokeWeight:1.5,clickable:!0}})}}),e},[z,i,T]),P=(0,a.useCallback)((e,s)=>{let t=Array.isArray(s[0])?s.flat():s,l=t.reduce((e,s)=>({lat:e.lat+s.lat/t.length,lng:e.lng+s.lng/t.length}),{lat:0,lng:0});h(e),p(l),v(j.filter(s=>s.zipCode===e.ZIP)),S("none")},[j]),E=(0,a.useMemo)(()=>"none"===k?y:[...y].sort((e,s)=>{let t=e.monthlyPrice||0,l=s.monthlyPrice||0;return"asc"===k?t-l:l-t}),[y,k]),F=(0,a.useMemo)(()=>{let e={};return z.forEach(s=>{e[s.Territory]||(e[s.Territory]={accounts:0,revenue:0,avgPrice:0}),e[s.Territory].accounts+=s.Account_Count,e[s.Territory].revenue+=s.Total_Monthly_Revenue}),Object.keys(e).forEach(s=>{e[s].avgPrice=e[s].revenue/e[s].accounts}),e},[z]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"font-medium text-slate-900",children:"Filter by Territory:"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)(c.z,{variant:e.West?"default":"outline",size:"sm",onClick:()=>s("West"),className:e.West?"bg-blue-600 hover:bg-blue-700":"",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-600"}),(0,l.jsx)("span",{children:"APS of Glendale"})]})}),(0,l.jsx)(c.z,{variant:e.Central?"default":"outline",size:"sm",onClick:()=>s("Central"),className:e.Central?"bg-green-600 hover:bg-green-700":"",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-600"}),(0,l.jsx)("span",{children:"APS of Scottsdale"})]})}),(0,l.jsx)(c.z,{variant:e.East?"default":"outline",size:"sm",onClick:()=>s("East"),className:e.East?"bg-orange-600 hover:bg-orange-700":"",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-600"}),(0,l.jsx)("span",{children:"APS of Chandler"})]})}),(0,l.jsx)(c.z,{variant:e.Tucson?"default":"outline",size:"sm",onClick:()=>s("Tucson"),className:e.Tucson?"bg-pink-600 hover:bg-pink-700":"",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-pink-600"}),(0,l.jsx)("span",{children:"APS of Tucson"})]})}),(0,l.jsx)(c.z,{variant:"outline",size:"sm",onClick:t,className:"ml-2",children:"Show All"})]})]})})}),(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[(0,l.jsx)(b.Z,{className:"h-5 w-5 text-green-600"}),"Average Monthly Revenue per ZIP Code"]}),(0,l.jsxs)("div",{className:"grid grid-cols-7 gap-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#dc2626"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"< $155"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#f59e0b"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"$155-160"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#fbbf24"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"$160-165"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#34d399"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"$165-170"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#10b981"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"$170-180"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#059669"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"$180-200"})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-full h-8 rounded",style:{backgroundColor:"#047857"}}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-600",children:"> $200"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[(0,l.jsx)(g.Z,{className:"h-5 w-5 text-blue-600"}),"Revenue by Territory"]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(F).map(([e,s])=>(0,l.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Z(e)}}),(0,l.jsx)("span",{className:"font-medium text-slate-900 text-sm",children:e})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-3 w-3 text-slate-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:[s.accounts," accounts"]})]}),(0,l.jsxs)("div",{className:"text-lg font-bold text-slate-900",children:["$",s.revenue.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"/mo"]}),(0,l.jsxs)("div",{className:"text-xs text-slate-600",children:["Avg: $",s.avgPrice.toFixed(2),"/account"]})]})]},e))})]})]})})}),(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-0",children:(0,l.jsxs)(w.b6,{mapContainerStyle:U,center:J,zoom:9,options:V,children:[R.map((e,s)=>(0,l.jsx)(w.Q8,{paths:e.paths,options:e.options,onClick:()=>P(e.zipData,e.paths)},`revenue-${s}`)),x&&u&&(0,l.jsx)(w.kp,{position:u,onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("h3",{className:"font-bold text-lg mb-2",children:["ZIP Code ",x.ZIP]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Z(x.Territory)}}),(0,l.jsx)("span",{className:"font-medium",children:x.Territory})]}),(0,l.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,l.jsxs)("div",{className:"font-semibold",children:["Accounts: ",x.Account_Count]}),(0,l.jsxs)("div",{className:"text-slate-600",children:["Avg Monthly: $",x.Avg_Monthly_Price.toFixed(2)]}),(0,l.jsxs)("div",{className:"text-slate-600",children:["Total Monthly: $",x.Total_Monthly_Revenue.toFixed(2)]}),(0,l.jsxs)("div",{className:"text-slate-600",children:["Total Yearly: $",x.Total_Yearly_Revenue.toFixed(2)]})]})]})]})})]})})}),x&&y.length>0&&(0,l.jsxs)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-blue-600"}),"Accounts in ZIP Code ",x.ZIP," - ",x.Territory,(0,l.jsxs)("span",{className:"text-sm font-normal text-slate-600 ml-2",children:["(",y.length," account",1!==y.length?"s":"",")"]})]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{S(e=>"none"===e?"asc":"asc"===e?"desc":"none")},className:"flex items-center gap-2",children:["asc"===k?(0,l.jsx)(Y.Z,{className:"h-4 w-4"}):"desc"===k?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(B.Z,{className:"h-4 w-4"}),(0,l.jsxs)("span",{children:["none"===k&&"Sort by Price","asc"===k&&"Price: Low to High","desc"===k&&"Price: High to Low"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"rounded-lg border overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{className:"bg-slate-50 sticky top-0 z-10",children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"font-semibold",children:"Customer"}),(0,l.jsx)(I.ss,{className:"font-semibold",children:"Address"}),(0,l.jsx)(I.ss,{className:"font-semibold",children:"City"}),(0,l.jsx)(I.ss,{className:"font-semibold",children:"Territory"}),(0,l.jsx)(I.ss,{className:"font-semibold",children:"Technician"}),(0,l.jsx)(I.ss,{className:"font-semibold",children:"Service Days"}),(0,l.jsx)(I.ss,{className:"font-semibold text-right",children:"Monthly Price"}),(0,l.jsx)(I.ss,{className:"font-semibold text-right",children:"Yearly Price"})]})}),(0,l.jsx)(I.RM,{children:E.map(e=>(0,l.jsxs)(I.SC,{className:"hover:bg-slate-50",children:[(0,l.jsx)(I.pj,{className:"font-medium",children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:e.customerName}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:e.customerNumber})]})}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:Z(e.newTerritory||e.territory)}}),(0,l.jsx)("span",{className:"text-sm",children:e.newTerritory||e.territory})]})}),(0,l.jsx)(I.pj,{children:e.technician}),(0,l.jsx)(I.pj,{children:(0,l.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e.daysOfService})}),(0,l.jsx)(I.pj,{className:"text-right font-medium",children:e.monthlyPrice&&e.monthlyPrice>0?`$${e.monthlyPrice.toFixed(2)}`:"-"}),(0,l.jsx)(I.pj,{className:"text-right font-medium",children:e.yearlyPrice&&e.yearlyPrice>0?`$${e.yearlyPrice.toFixed(2)}`:"-"})]},e.customerNumber))})]})})})})]})]})}function Q(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)(null),[c,m]=(0,a.useState)(null),[x,h]=(0,a.useState)("all"),[u,f]=(0,a.useState)([]),[p,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/employee-locations.json").then(e=>e.json()),fetch("/office-locations.json").then(e=>e.json()),fetch("/phoenix-tucson-map-data.json").then(e=>e.json()),fetch("/az-zip-boundaries.json").then(e=>e.json())]).then(([e,t,l,a])=>{s(e),r(t),f(l),j(a)})},[]),(0,a.useEffect)(()=>{if(!window.google||0===e.length)return;let s=new google.maps.Map(document.getElementById("employee-map"),{zoom:10,center:{lat:33.4484,lng:-112.074},mapTypeId:"roadmap"});if(i(s),u.length>0&&p){let e=new Map;u.forEach(s=>{e.has(s.area)||e.set(s.area,[]);let t=p.features?.find(e=>e.properties?.ZCTA5CE10===s.zip);t&&e.get(s.area)?.push(t.geometry)});let t={West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#ec4899"};e.forEach((e,l)=>{let a=t[l]||"#6b7280";e.forEach(e=>{G(e).forEach(e=>{new google.maps.Polygon({paths:e,strokeColor:a,strokeOpacity:.15,strokeWeight:.5,fillColor:a,fillOpacity:.15,map:s,clickable:!1,zIndex:1})})});let r=[];if(e.forEach(e=>{G(e).forEach(e=>{r.push(...e)})}),r.length>0){let e=new google.maps.LatLngBounds;r.forEach(s=>e.extend(s))}})}t.forEach(e=>{let t={West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#ec4899"}[e.area]||("NEXT YEAR"===e.category?"#ef4444":"#f97316"),l=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:s,icon:{path:"M 0,-24 L 7,-7 L 24,-7 L 10,3 L 15,20 L 0,10 L -15,20 L -10,3 L -24,-7 L -7,-7 Z",fillColor:t,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:.8},title:e.label,zIndex:1e3}),a=e.fullName||(0,Z.G)(e.area),r=new google.maps.InfoWindow({content:`
          <div style="padding: 8px;">
            <h3 style="font-weight: bold; margin-bottom: 4px;">${e.label}</h3>
            <p style="color: #666; margin: 0;">${a}</p>
          </div>
        `});l.addListener("click",()=>{r.open(s,l)})}),("all"===x?e:e.filter(e=>e.troyAssignment===x)).forEach(e=>{let t=e.troyAssignment||e.recommendedOffice,l=new google.maps.Marker({position:{lat:e.latitude,lng:e.longitude},map:s,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"West"===t?"#3b82f6":"Central"===t?"#10b981":"East"===t?"#8b5cf6":"Commercial"===t?"#f59e0b":"Tucson"===t?"#ec4899":"#6b7280",fillOpacity:.8,strokeColor:"#ffffff",strokeWeight:2,scale:8},title:e.name});l.addListener("click",()=>{m(e);let t=e.troyAssignment||"Not assigned",a=e.recommendedOffice||"N/A";new google.maps.InfoWindow({content:`
            <div style="padding: 12px; max-width: 320px;">
              <h3 style="font-weight: bold; margin-bottom: 8px;">${e.name}</h3>
              <p style="margin: 4px 0;"><strong>Title:</strong> ${e.title}</p>
              <p style="margin: 4px 0;"><strong>Location:</strong> ${e.city}, ${e.zip}</p>
              <p style="margin: 4px 0;"><strong>Manager:</strong> ${e.manager}</p>
              <hr style="margin: 8px 0;">
              <p style="margin: 4px 0;"><strong>Troy's Assignment:</strong> <span style="color: #059669; font-weight: bold;">${t}</span></p>
              ${t===a||"N/A"===a?"":`
                <p style="margin: 4px 0; font-size: 12px; color: #6b7280;">
                  <em>(Previous recommendation: ${a})</em>
                </p>
              `}
              <hr style="margin: 8px 0;">
              <p style="margin: 4px 0; font-size: 12px;"><strong>Distances to 2026 Offices:</strong></p>
              <p style="margin: 2px 0; font-size: 12px;">• West: ${e.distanceToWest} mi</p>
              <p style="margin: 2px 0; font-size: 12px;">• Central: ${e.distanceToCentral} mi</p>
              <p style="margin: 2px 0; font-size: 12px;">• East: ${e.distanceToEast} mi</p>
            </div>
          `}).open(s,l)})})},[e,t,x,u,p]);let g={West:e.filter(e=>"West"===e.troyAssignment).length,Central:e.filter(e=>"Central"===e.troyAssignment).length,East:e.filter(e=>"East"===e.troyAssignment).length,Commercial:e.filter(e=>"Commercial"===e.troyAssignment).length,Tucson:e.filter(e=>"Tucson"===e.troyAssignment).length};return(0,l.jsxs)("div",{className:"flex h-full",children:[(0,l.jsxs)("div",{className:"w-80 bg-white border-r overflow-y-auto",children:[(0,l.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Employee Locations"}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Showing home addresses with Troy's branch assignments"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("button",{onClick:()=>h("all"),className:`w-full px-3 py-2 text-left rounded ${"all"===x?"bg-gray-700 text-white":"bg-gray-100 hover:bg-gray-200"}`,children:["All Employees (",e.length,")"]}),(0,l.jsxs)("button",{onClick:()=>h("West"),className:`w-full px-3 py-2 text-left rounded flex items-center justify-between ${"West"===x?"bg-blue-600 text-white":"bg-blue-50 hover:bg-blue-100"}`,children:[(0,l.jsx)("span",{children:"West Branch"}),(0,l.jsx)(d.C,{variant:"secondary",children:g.West})]}),(0,l.jsxs)("button",{onClick:()=>h("Central"),className:`w-full px-3 py-2 text-left rounded flex items-center justify-between ${"Central"===x?"bg-green-600 text-white":"bg-green-50 hover:bg-green-100"}`,children:[(0,l.jsx)("span",{children:"Central Branch"}),(0,l.jsx)(d.C,{variant:"secondary",children:g.Central})]}),(0,l.jsxs)("button",{onClick:()=>h("East"),className:`w-full px-3 py-2 text-left rounded flex items-center justify-between ${"East"===x?"bg-purple-600 text-white":"bg-purple-50 hover:bg-purple-100"}`,children:[(0,l.jsx)("span",{children:"East Branch"}),(0,l.jsx)(d.C,{variant:"secondary",children:g.East})]}),(0,l.jsxs)("button",{onClick:()=>h("Commercial"),className:`w-full px-3 py-2 text-left rounded flex items-center justify-between ${"Commercial"===x?"bg-amber-600 text-white":"bg-amber-50 hover:bg-amber-100"}`,children:[(0,l.jsx)("span",{children:"Commercial Branch"}),(0,l.jsx)(d.C,{variant:"secondary",children:g.Commercial})]}),(0,l.jsxs)("button",{onClick:()=>h("Tucson"),className:`w-full px-3 py-2 text-left rounded flex items-center justify-between ${"Tucson"===x?"bg-pink-600 text-white":"bg-pink-50 hover:bg-pink-100"}`,children:[(0,l.jsx)("span",{children:"Tucson Branch"}),(0,l.jsx)(d.C,{variant:"secondary",children:g.Tucson})]})]})]}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h3",{className:"font-semibold mb-3",children:"Legend"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-blue-500"}),(0,l.jsx)("span",{children:"West Branch"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-green-500"}),(0,l.jsx)("span",{children:"Central Branch"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-purple-500"}),(0,l.jsx)("span",{children:"East Branch"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-amber-500"}),(0,l.jsx)("span",{children:"Commercial Branch"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-pink-500"}),(0,l.jsx)("span",{children:"Tucson Branch"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t",children:[(0,l.jsx)("div",{className:"text-red-500 text-xl",children:"★"}),(0,l.jsx)("span",{children:"2026 Office Location"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"text-orange-500 text-xl",children:"★"}),(0,l.jsx)("span",{children:"Future Office Location"})]})]}),c&&(0,l.jsxs)(o.Zb,{className:"mt-4 p-4",children:[(0,l.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Employee"}),(0,l.jsx)("p",{className:"text-sm font-medium",children:c.name}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:c.title}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:c.city}),(0,l.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,l.jsxs)("p",{className:"text-xs",children:[(0,l.jsx)("span",{className:"font-medium",children:"Troy's Assignment:"})," ",c.troyAssignment||"N/A"]}),(0,l.jsxs)("p",{className:"text-xs",children:[(0,l.jsx)("span",{className:"font-medium",children:"Manager:"})," ",c.manager]}),c.troyAssignment!==c.recommendedOffice&&(0,l.jsxs)("p",{className:"text-xs text-gray-500 italic",children:["(Previous rec.: ",c.recommendedOffice,")"]})]})]})]})]}),(0,l.jsx)("div",{className:"flex-1 relative",children:(0,l.jsx)("div",{id:"employee-map",className:"w-full h-full"})})]})}function G(e){return e?.coordinates?"Polygon"===e.type?e.coordinates.map(e=>e.map(([e,s])=>({lat:s,lng:e}))):"MultiPolygon"===e.type?e.coordinates.flatMap(e=>e.map(e=>e.map(([e,s])=>({lat:s,lng:e})))):[]:[]}let _={width:"100%",height:"600px"},H={lat:33.4484,lng:-112.074};function q({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[i,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(!1),[h,u]=(0,a.useState)([]),[f,p]=(0,a.useState)(null),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/commercial-accounts.json").then(e=>e.json()),fetch("/phoenix-tucson-map-data.json").then(e=>e.json())]).then(([e,s])=>{t(e),o(s)}).catch(e=>console.error("Error loading data:",e))},[]),(0,a.useEffect)(()=>{m&&i.length&&j.current&&(async()=>{try{let s=await fetch("/az-zip-boundaries.json"),t=await s.json(),l=new Map;i.forEach(e=>{l.has(e.area)||l.set(e.area,[]);let s=t.features?.find(s=>s.properties?.ZCTA5CE10===e.zip);s&&l.get(e.area)?.push({zip:e.zip,geometry:s.geometry})});let a=[];l.forEach((s,t)=>{a.push({area:t,zips:s,show:!1!==e[t]})}),n(a)}catch(e){console.error("Error loading boundaries:",e)}})()},[m,i,e]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/office-locations.json");if(e.ok){let s=await e.json();u(s)}}catch(e){console.error("Error loading office locations:",e)}})()},[]);let g=e=>({West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#ec4899",Commercial:"#9333ea"})[e]||"#6b7280",b=(0,a.useCallback)(e=>{j.current=e,x(!0)},[]);return(0,l.jsxs)(w.b6,{mapContainerStyle:_,center:H,zoom:9,onLoad:b,options:{disableDefaultUI:!1,zoomControl:!0,streetViewControl:!1,mapTypeControl:!0,fullscreenControl:!0},children:[r.filter(e=>e.show).map(e=>{let s=g(e.area);return e.zips.map(t=>{var a;if(!t?.geometry)return null;let r=(a=t.geometry,a?.coordinates?"Polygon"===a.type?a.coordinates.map(e=>e.map(([e,s])=>({lat:s,lng:e}))):"MultiPolygon"===a.type?a.coordinates.flatMap(e=>e.map(e=>e.map(([e,s])=>({lat:s,lng:e})))):[]:[]);return(0,l.jsx)(w.Q8,{paths:r,options:{fillColor:s,fillOpacity:.15,strokeColor:s,strokeOpacity:.15,strokeWeight:.5,clickable:!1,zIndex:1}},`territory-${e.area}-${t.zip}`)})}),s.filter(s=>!!e.Commercial).map(e=>{let s=g(e.closestOffice);return(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:s,fillOpacity:.9,strokeColor:"#FFFFFF",strokeWeight:2,scale:7},onClick:()=>d(e),title:e.accountName,zIndex:100},e.customerNumber)}),h.filter(e=>"NEXT YEAR"===e.category).map(e=>{let s="Tucson"===e.area?"#ec4899":"West"===e.area?"#3b82f6":"Central"===e.area?"#10b981":"East"===e.area?"#f97316":"#DC2626";return(0,l.jsx)(w.jC,{position:{lat:e.lat,lng:e.lng},icon:{path:"M 0,-24 L 6,-8 L 24,-8 L 10,4 L 16,20 L 0,8 L -16,20 L -10,4 L -24,-8 L -6,-8 Z",fillColor:s,fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:.7,anchor:new google.maps.Point(0,0)},onClick:()=>p(e),title:e.label,zIndex:1e3},`office-${e.zipCode}-${e.category}`)}),c&&(0,l.jsx)(w.kp,{position:{lat:c.latitude,lng:c.longitude},onCloseClick:()=>d(null),children:(0,l.jsxs)("div",{style:{minWidth:"300px",maxWidth:"400px",padding:"12px"},children:[(0,l.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,l.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"bold",marginBottom:"4px"},children:c.accountName}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px"},children:[(0,l.jsx)("span",{style:{background:g(c.closestOffice),color:"white",padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:c.closestOffice}),(0,l.jsxs)("span",{style:{fontSize:"12px",color:"#6b7280"},children:[c.distanceToClosest.toFixed(1)," mi"]})]})]}),(0,l.jsxs)("div",{style:{background:"#f9fafb",padding:"10px",borderRadius:"6px",marginBottom:"10px"},children:[(0,l.jsx)("div",{style:{fontSize:"13px",color:"#374151",marginBottom:"4px"},children:(0,l.jsx)("strong",{children:"\uD83D\uDCCD Address:"})}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#6b7280"},children:[c.address,(0,l.jsx)("br",{}),c.city,", ",c.state," ",c.zip]})]}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"6px"},children:[(0,l.jsx)("strong",{children:"Customer #:"})," ",c.customerNumber]}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"6px"},children:[(0,l.jsx)("strong",{children:"Service Days:"}),(0,l.jsx)("br",{}),c.daysOfService]}),c.existingTerritory&&(0,l.jsxs)("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid #e2e8f0",fontSize:"11px",color:"#9ca3af"},children:["Previous: ",c.existingTerritory]})]})}),f&&(0,l.jsx)(w.kp,{position:{lat:f.lat,lng:f.lng},onCloseClick:()=>p(null),children:(0,l.jsxs)("div",{style:{minWidth:"200px",padding:"12px"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[(0,l.jsx)("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#DC2626"}}),(0,l.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:f.label})]}),(0,l.jsxs)("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:[(0,l.jsx)("div",{style:{marginBottom:"4px"},children:f.fullName||(0,Z.G)(f.area)}),(0,l.jsxs)("div",{style:{marginBottom:"8px"},children:["ZIP ",f.zipCode]})]}),(0,l.jsx)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:(0,l.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",padding:"4px 8px",borderRadius:"4px",backgroundColor:"#FEE2E2",color:"#B91C1C"},children:"Opening 2026"})})]})})]})}var K=t(3647),ee=t(9322);let es={width:"100%",height:"600px"},et={lat:33.4484,lng:-112.074},el=e=>({West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#ec4899",Commercial:"#8b5cf6"})[e]||"#6b7280";function ea({areaFilter:e,onAreaChange:s}){let[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(""),[h,u]=(0,a.useState)("all"),[f,p]=(0,a.useState)(null),[j,g]=(0,a.useState)([]),[b,N]=(0,a.useState)(et),[y,v]=(0,a.useState)(10);(0,a.useEffect)(()=>{fetch("/route-assignments.json").then(e=>e.json()).then(e=>{console.log("\uD83D\uDCCA Routes data loaded:",e.length,"records"),r(e);let s=Array.from(new Set(e.map(e=>e.technician)));s.sort(),console.log("\uD83D\uDC77 Technicians found:",s.length),g(s)}).catch(e=>{console.error("❌ Error loading routes:",e)}),fetch("/office-locations.json").then(e=>e.json()).then(e=>i(e)).catch(e=>console.error("❌ Error loading offices:",e)),fetch("/az-zip-boundaries.json").then(e=>e.json()).then(e=>d(e)).catch(e=>console.error("❌ Error loading boundaries:",e))},[]);let C=(0,a.useMemo)(()=>{let e={};return t.forEach(s=>{e[s.technician]=(e[s.technician]||0)+1}),e},[t]),k=(0,a.useMemo)(()=>{let e={};return t.forEach(s=>{e[s.technician]||(e[s.technician]={});let t=s.territory||"Unknown";e[s.technician][t]=(e[s.technician][t]||0)+1}),e},[t]),S=(0,a.useMemo)(()=>t.filter(s=>!!m&&s.technician===m&&("all"===e||s.territory===e)&&("all"===h||(Array.isArray(s.daysOfService)?s.daysOfService.includes(h):(console.warn("Invalid daysOfService for route:",s.customerNumber),!1)))),[t,m,e,h]),z=(0,a.useMemo)(()=>m?["all",...Object.keys(k[m]||{}).sort()]:["all"],[m,k]);(0,a.useEffect)(()=>{if(m){let t=Object.keys(k[m]||{});if("all"!==e&&!t.includes(e)){console.log(`🔄 Resetting territory filter from ${e} to 'all'`),s("all");return}if(1===t.length&&"all"===e){let e=t[0];console.log(`🎯 Auto-selecting single territory: ${e}`),s(e)}}},[m,k,e]),(0,a.useEffect)(()=>{if(m&&S.length>0){console.log(`🚗 Selected technician: ${m}, ${S.length} stops`);let e=S.reduce((e,s)=>e+s.latitude,0)/S.length,s=S.reduce((e,s)=>e+s.longitude,0)/S.length;console.log(`📍 Map centering to: ${e.toFixed(4)}, ${s.toFixed(4)}`),N({lat:e,lng:s}),v(13)}else N(et),v(10)},[m,S]);let T=e=>{try{if(!e||!e.type||!e.coordinates)return[];if("Polygon"===e.type)return e.coordinates.map(e=>e.map(e=>({lat:e[1],lng:e[0]})));if("MultiPolygon"===e.type)return e.coordinates.flatMap(e=>e.map(e=>e.map(e=>({lat:e[1],lng:e[0]}))))}catch(e){console.error("Error converting geometry:",e)}return[]},Z=(0,a.useMemo)(()=>{if(!c||!c.features)return console.warn("⚠️ No boundary data available"),[];if(!m)return[];try{let e=new Set(S.map(e=>e.zipCode));console.log(`🗺️ Rendering polygons for ${e.size} unique ZIP codes`);let s=[],t=new Set;return e.forEach(e=>{if(!t.has(e)){t.add(e);try{let t=c.features.find(s=>s.properties?.ZCTA5CE10===e);if(t?.geometry){let l=T(t.geometry);if(l&&l.length>0){let t=S.find(s=>s.zipCode===e),a=t?.territory||"Unknown";l.forEach((t,l)=>{t&&t.length>0&&s.push({key:`${a}-${e}-${l}`,paths:t,territory:a,zip:e})})}}}catch(s){console.error(`❌ Error processing ZIP ${e}:`,s)}}}),console.log(`✅ Generated ${s.length} polygon objects`),s}catch(e){return console.error("❌ Error in getTerritoryPolygons:",e),[]}},[c,m,S]),A=(0,a.useMemo)(()=>({totalAccounts:S.length,territories:Array.from(new Set(S.map(e=>e.territory))),zips:Array.from(new Set(S.map(e=>e.zipCode)))}),[S]);return"undefined"!=typeof google&&google.maps?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Territory (Optional)",m&&z.length>1&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",z.length-1," available)"]})]}),(0,l.jsxs)(K.Ph,{value:e,onValueChange:s,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"all",children:"All Territories"}),z.filter(e=>"all"!==e).map(e=>{let s=m&&k[m]?.[e]||0;return(0,l.jsxs)(K.Ql,{value:e,children:[{West:"APS of Glendale (West)",Central:"APS of Scottsdale (Central)",East:"APS of Chandler (East)",Tucson:"APS of Tucson"}[e]||e,m&&s>0&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",s," stops)"]})]},e)})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Select Technician ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})," (",j.length,")"]}),(0,l.jsxs)(K.Ph,{value:m,onValueChange:x,children:[(0,l.jsx)(K.i4,{className:m?"":"border-red-500",children:(0,l.jsx)(K.ki,{placeholder:"Select a technician..."})}),(0,l.jsx)(K.Bw,{className:"max-h-[300px]",children:j.map(e=>{let s=C[e]||0,t=Object.entries(k[e]||{}).sort(([,e],[,s])=>s-e).map(([e,s])=>`${e}: ${s}`).join(", ");return(0,l.jsx)(K.Ql,{value:e,children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("span",{className:"font-medium",children:[e," (",s," stops)"]}),t&&(0,l.jsx)("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})]})},e)})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Day of Service (Optional)"}),(0,l.jsxs)(K.Ph,{value:h,onValueChange:u,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"all",children:"All Days"}),(0,l.jsx)(K.Ql,{value:"Monday",children:"Monday"}),(0,l.jsx)(K.Ql,{value:"Tuesday",children:"Tuesday"}),(0,l.jsx)(K.Ql,{value:"Wednesday",children:"Wednesday"}),(0,l.jsx)(K.Ql,{value:"Thursday",children:"Thursday"}),(0,l.jsx)(K.Ql,{value:"Friday",children:"Friday"})]})]})]})]}),!m&&(0,l.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg flex items-start gap-2",children:[(0,l.jsx)(ee.Z,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 shrink-0 mt-0.5"}),(0,l.jsxs)("div",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,l.jsx)("strong",{children:"Select a technician to view their route"})," - This shows how an individual's route crosses different territories and ZIP codes. The map will zoom to their service area."]})]}),m&&(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t flex flex-wrap gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Service Stops:"})," ",(0,l.jsx)("span",{className:"font-semibold",children:A.totalAccounts})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Territories Covered:"})," ",(0,l.jsx)("span",{className:"font-semibold",children:A.territories.length}),A.territories.length>0&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground ml-1",children:["(",A.territories.join(", "),")"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"ZIP Codes:"})," ",(0,l.jsx)("span",{className:"font-semibold",children:A.zips.length})]})]})]}),(0,l.jsx)(o.Zb,{className:"p-4",children:(0,l.jsxs)(w.b6,{mapContainerStyle:es,center:b,zoom:y,options:{mapTypeId:"roadmap",streetViewControl:!1,mapTypeControl:!0},children:[Z.map(e=>(0,l.jsx)(w.mg,{paths:e.paths,options:{fillColor:el(e.territory),fillOpacity:.1,strokeColor:el(e.territory),strokeOpacity:.4,strokeWeight:1}},e.key)),n.filter(s=>"all"===e||s.area===e).map(e=>{let s="NEXT YEAR"===e.category?"#ef4444":"#f97316";return(0,l.jsx)(w.Jx,{position:{lat:e.lat,lng:e.lng},icon:{path:"M 0,-24 6,-7 24,-7 10,4 15,22 0,11 -15,22 -10,4 -24,-7 -6,-7 Z",fillColor:s,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:.7}},e.zipCode)}),S.filter(e=>{let s=e.latitude&&e.longitude&&!isNaN(e.latitude)&&!isNaN(e.longitude)&&e.latitude>=-90&&e.latitude<=90&&e.longitude>=-180&&e.longitude<=180;return s||console.warn("⚠️ Invalid coordinates for:",e.customerNumber,e.latitude,e.longitude),s&&e.customerNumber}).map(e=>(0,l.jsx)(w.Jx,{position:{lat:e.latitude,lng:e.longitude},onClick:()=>p(e),icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:el(e.territory),fillOpacity:.9,strokeColor:"#ffffff",strokeWeight:1.5,scale:7}},e.customerNumber)),f&&(0,l.jsx)(w.nx,{position:{lat:f.latitude,lng:f.longitude},onCloseClick:()=>p(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h3",{className:"font-semibold text-sm mb-1",children:f.customerName||"Unknown"}),(0,l.jsxs)("div",{className:"text-xs space-y-1",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Account:"})," ",f.customerNumber||"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",f.address||"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Location:"})," ",f.city&&"null"!==f.city?`${f.city}, AZ ${f.zipCode||""}`:`AZ ${f.zipCode||""}`]}),f.newTerritory&&(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"New Territory:"})," ",f.newTerritory]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Technician:"})," ",f.technician||"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Days:"})," ",Array.isArray(f.daysOfService)?f.daysOfService.join(", "):"N/A"]}),(f.monthlyPrice||f.yearlyPrice)&&(0,l.jsxs)("div",{className:"border-t pt-1 mt-1",children:[f.monthlyPrice&&f.monthlyPrice>0&&(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Monthly Price:"})," $",f.monthlyPrice.toFixed(2)]}),f.yearlyPrice&&f.yearlyPrice>0&&(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Yearly Price:"})," $",f.yearlyPrice.toFixed(2)]})]})]})]})})]})}),m&&S.length>0&&(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Account Listing (",S.length," ",1===S.length?"account":"accounts",")"]}),(0,l.jsx)("div",{className:"rounded-md border overflow-auto max-h-[600px]",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{className:"sticky top-0 bg-background z-10",children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"w-[120px]",children:"Account #"}),(0,l.jsx)(I.ss,{className:"min-w-[200px]",children:"Customer Name"}),(0,l.jsx)(I.ss,{className:"min-w-[250px]",children:"Street Address"}),(0,l.jsx)(I.ss,{className:"w-[140px]",children:"City"}),(0,l.jsx)(I.ss,{className:"w-[80px]",children:"State"}),(0,l.jsx)(I.ss,{className:"w-[90px]",children:"ZIP Code"}),(0,l.jsx)(I.ss,{className:"min-w-[150px]",children:"Days of Service"})]})}),(0,l.jsx)(I.RM,{children:S.sort((e,s)=>e.customerNumber.localeCompare(s.customerNumber)).map(e=>(0,l.jsxs)(I.SC,{className:"hover:bg-muted/50",children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.customerName||"Unknown"}),(0,l.jsx)(I.pj,{children:e.address||"N/A"}),(0,l.jsx)(I.pj,{children:e.city||"N/A"}),(0,l.jsx)(I.pj,{children:"AZ"}),(0,l.jsx)(I.pj,{children:e.zipCode||"N/A"}),(0,l.jsx)(I.pj,{children:Array.isArray(e.daysOfService)?e.daysOfService.join(", "):"N/A"})]},e.customerNumber))})]})})]})]}):(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Loading Google Maps..."})]})})}var er=t(2369),en=t(44);let ei={width:"100%",height:"400px"},eo=e=>({West:"bg-blue-500",Central:"bg-green-500",East:"bg-orange-500",Tucson:"bg-pink-500",Commercial:"bg-purple-500","JAX - Maint Ponte Vedra":"bg-cyan-500","JAX - Maint Jacksonville":"bg-blue-600","JAX - Maint St. Augustine":"bg-teal-500","JAX - Maint St. Johns":"bg-emerald-500","JAX - Maint Nocatee":"bg-lime-500","JAX - Maint Beaches":"bg-sky-500","JAX - Maint Outskirts":"bg-indigo-500","JAX - Comm Maint":"bg-violet-500"})[e]||"bg-gray-500",ec=e=>({West:"#3b82f6",Central:"#10b981",East:"#f97316",Tucson:"#ec4899",Commercial:"#8b5cf6","JAX - Maint Ponte Vedra":"#06b6d4","JAX - Maint Jacksonville":"#2563eb","JAX - Maint St. Augustine":"#14b8a6","JAX - Maint St. Johns":"#10b981","JAX - Maint Nocatee":"#84cc16","JAX - Maint Beaches":"#0ea5e9","JAX - Maint Outskirts":"#6366f1","JAX - Comm Maint":"#8b5cf6"})[e]||"#6b7280",ed=e=>({West:"APS of Glendale",Central:"APS of Scottsdale",East:"APS of Chandler",Tucson:"APS of Tucson",Commercial:"APS - Commercial"})[e]||e;function em(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(""),[n,i]=(0,a.useState)([]),[c,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{Promise.all([fetch("/customer-lookup.json").then(e=>e.json()),fetch("/jacksonville-route-assignments.json").then(e=>e.json())]).then(([e,t])=>{s([...e,...t.map(e=>({accountNumber:e.customerNumber,customerName:e.customerName||"Unknown",address:e.address||"Address not available",zipCode:e.zip,city:e.city||"",territory:e.territory||"Jacksonville",latitude:e.latitude,longitude:e.longitude,status:e.status||"Active"}))]),i([])}).catch(e=>{console.error("Error loading customers:",e)})},[]),(0,a.useEffect)(()=>{if(t.length<2){i([]),x(null);return}let s=t.toLowerCase(),l=e.filter(e=>{let t=String(e.customerName||"").toLowerCase(),l=String(e.accountNumber||"").toLowerCase(),a=String(e.address||"").toLowerCase();return t.includes(s)||l.includes(s)||a.includes(s)});i(l.slice(0,50)),1===l.length&&x(l[0])},[t,e]);let f=e=>{x(e),u(!0)},p=e=>{let s=`https://www.google.com/maps/search/?api=1&query=${e.latitude},${e.longitude}`;window.open(s,"_blank")},j="undefined"!=typeof google&&google.maps;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Customer Territory Lookup"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Search by customer name, account number, or address to find territory assignments."})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(y.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,l.jsx)(z.I,{type:"text",placeholder:"Search customer name, account number, or address...",value:t,onChange:e=>r(e.target.value),className:"pl-10 text-lg h-12"})]}),t.length>0&&t.length<2&&(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Type at least 2 characters to search"}),t.length>=2&&0===n.length&&(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:['No customers found matching "',t,'"']}),n.length>0&&(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Found ",n.length," customer",1!==n.length?"s":"",50===n.length&&" (showing first 50)"]})]})}),n.length>0&&(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"font-semibold mb-3",children:"Search Results"}),(0,l.jsx)("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:n.map(e=>(0,l.jsx)("div",{onClick:()=>f(e),className:`p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md ${c?.accountNumber===e.accountNumber?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:(0,l.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("div",{className:"font-medium text-sm truncate",children:String(e.customerName||"Unknown")}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:String(e.accountNumber||"N/A")})]}),(0,l.jsx)(d.C,{className:`${eo(e.territory)} text-white shrink-0 text-xs`,children:String(e.territory||"Unknown")})]})},e.accountNumber))})]}),c&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-4",children:"Customer Details"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,l.jsx)(er.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Customer Name"})]}),(0,l.jsx)("div",{className:"font-medium",children:c.customerName&&"nan"!==c.customerName&&"null"!==c.customerName?String(c.customerName):"Unknown"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,l.jsx)(en.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Account Number"})]}),(0,l.jsx)("div",{className:"font-medium",children:String(c.accountNumber||"N/A")})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Address"})]}),(0,l.jsx)("div",{className:"font-medium",children:c.address&&"nan"!==c.address&&"null"!==c.address?String(c.address):"Address not available"}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[c.city&&"null"!==c.city?`${c.city}, `:"","AZ ",c.zipCode||"N/A"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-muted-foreground text-sm mb-2",children:"Assigned Territory"}),(0,l.jsx)(d.C,{className:`${eo(c.territory)} text-white text-sm py-2 px-3`,children:ed(String(c.territory||"Unknown"))})]}),(0,l.jsxs)("button",{onClick:()=>p(c),className:"w-full mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4"}),"Open in Google Maps (New Tab)"]})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"font-semibold mb-3",children:"Location Map"}),j?(0,l.jsxs)(w.b6,{mapContainerStyle:ei,center:{lat:c.latitude,lng:c.longitude},zoom:15,options:{mapTypeId:"hybrid",streetViewControl:!0,mapTypeControl:!0},children:[(0,l.jsx)(w.Jx,{position:{lat:c.latitude,lng:c.longitude},onClick:()=>u(!0),icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:ec(c.territory),fillOpacity:.9,strokeColor:"#ffffff",strokeWeight:2,scale:10}}),h&&(0,l.jsx)(w.nx,{position:{lat:c.latitude,lng:c.longitude},onCloseClick:()=>u(!1),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h4",{className:"font-semibold text-sm mb-1",children:c.customerName&&"nan"!==c.customerName&&"null"!==c.customerName?String(c.customerName):"Unknown"}),(0,l.jsxs)("div",{className:"text-xs space-y-1",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Account:"})," ",String(c.accountNumber||"N/A")]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",c.address&&"nan"!==c.address&&"null"!==c.address?String(c.address):"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Location:"})," ",c.city&&"null"!==c.city?`${c.city}, AZ ${c.zipCode||""}`:`AZ ${c.zipCode||"N/A"}`]})]})]})})]}):(0,l.jsx)("div",{className:"flex items-center justify-center h-[400px] bg-muted rounded-lg",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Loading map..."})]})})]})]})]})]})}var ex=t(1817),eh=t(2735),eu=t(7844),ef=t(401);let ep=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(eu.fC,{ref:t,className:(0,Z.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:(0,l.jsx)(eu.z$,{className:(0,Z.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(ef.Z,{className:"h-4 w-4"})})}));ep.displayName=eu.fC.displayName;let ej={width:"100%",height:"600px"},eg={lat:33.4484,lng:-112.074},eb={mapTypeControl:!1,fullscreenControl:!0,streetViewControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],zoomControl:!0};function eN(){let[e,s]=(0,a.useState)(!0),[t,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(null),[d,m]=(0,a.useState)({}),[x,h]=(0,a.useState)("view2"),[u,f]=(0,a.useState)(2025),[p,j]=(0,a.useState)(null),[g,N]=(0,a.useState)(null),[y,v]=(0,a.useState)(!0),[C,k]=(0,a.useState)(!0),[S,z]=(0,a.useState)(!0),[T,Z]=(0,a.useState)(!0),[A,R]=(0,a.useState)(!0),[P,E]=(0,a.useState)(!0),[F,M]=(0,a.useState)(!0),[$,O]=(0,a.useState)("total"),[L,D]=(0,a.useState)("desc");(0,a.useEffect)(()=>{!async function(){try{s(!0),r(null);let[e,t]=await Promise.all([fetch("/ancillary-sales-data.json"),fetch("/az-zip-boundaries.json")]);if(!e.ok||!t.ok)throw Error("Failed to load data");let l=await e.json(),a=await t.json();i(l);let n={};a.features&&a.features.forEach(e=>{let s=e.properties?.ZCTA5CE10||e.properties?.ZIP||e.properties?.zip;s&&(n[s]={geometry:e.geometry,properties:e.properties})}),m(n),l.metadata.years.length>0&&f(Math.max(...l.metadata.years))}catch(e){console.error("Error loading ancillary sales data:",e),r("Failed to load ancillary sales data")}finally{s(!1)}}()},[]);let U=(0,a.useMemo)(()=>{if(!n)return[];let e="view1"===x?n.view1.filter(e=>e.year===u):n.view2;return(e=e.filter(e=>{let s=e.branch||"Unassigned";return("Glendale"!==s||!!T)&&("Scottsdale"!==s||!!A)&&("Chandler"!==s||!!P)&&("Tucson"!==s||!!F)})).map(e=>{let s=y?e.ots:0,t=C?e.repair:0,l=S?e.remodel:0,a=s+t+l;if("view2"===x){let r=e.activeCustomers>0?s/e.activeCustomers:0,n=e.activeCustomers>0?t/e.activeCustomers:0,i=e.activeCustomers>0?l/e.activeCustomers:0,o=e.activeCustomers>0?a/e.activeCustomers:0;return{...e,ots:s,repair:t,remodel:l,total:a,avgOts:r,avgRepair:n,avgRemodel:i,avgTotal:o}}return{...e,ots:s,repair:t,remodel:l,total:a}}).filter(e=>e.total>0)},[n,x,u,y,C,S,T,A,P,F]),J=(e,s)=>{let t,l;if(0===e)return"rgba(200, 200, 200, 0.3)";let a=Math.pow(Math.sqrt(e/s),.6);return a<.33?(t=Math.round(a/.33*255),l=200):a<.67?(t=255,l=Math.round(200-(a-.33)/.34*100)):(t=255,l=Math.round(100*(1-(a-.67)/.33))),`rgba(${t}, ${l}, 0, 0.7)`},V=(0,a.useMemo)(()=>0===U.length?1:Math.max(...U.map(e=>e.total)),[U]),X=(0,a.useMemo)(()=>{let e=[...U];return e.sort((e,s)=>{let t=e[$]||0,l=s[$]||0;return"desc"===L?l-t:t-l}),e},[U,$,L]),Q=e=>{$===e?D("desc"===L?"asc":"desc"):(O(e),D("desc"))},G=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),_=(e,s,t)=>{j(e),N({lat:s,lng:t})};if(e)return(0,l.jsx)(o.Zb,{className:"w-full",children:(0,l.jsxs)(o.aY,{className:"flex items-center justify-center p-8",children:[(0,l.jsx)(ex.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,l.jsx)("span",{className:"ml-2",children:"Loading ancillary sales data..."})]})});if(t)return(0,l.jsx)(o.Zb,{className:"w-full",children:(0,l.jsx)(o.aY,{className:"p-8",children:(0,l.jsx)("div",{className:"text-red-600",children:t})})});let H=p?U.find(e=>e.zip===p):null;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(b.Z,{className:"h-6 w-6"}),"Ancillary Sales Analysis"]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(c.z,{variant:"view1"===x?"default":"outline",onClick:()=>h("view1"),children:"By Year"}),(0,l.jsx)(c.z,{variant:"view2"===x?"default":"outline",onClick:()=>h("view2"),children:"2025 Analysis"})]}),"view1"===x&&n&&(0,l.jsxs)(K.Ph,{value:u.toString(),onValueChange:e=>f(parseInt(e)),children:[(0,l.jsx)(K.i4,{className:"w-32",children:(0,l.jsx)(K.ki,{})}),(0,l.jsx)(K.Bw,{children:n.metadata.years.map(e=>(0,l.jsx)(K.Ql,{value:e.toString(),children:e},e))})]})]}),(0,l.jsx)("div",{className:"mt-4 text-sm text-muted-foreground",children:"view1"===x?(0,l.jsxs)("p",{children:["Showing total ancillary sales by ZIP code for year ",u,".",(0,l.jsx)("br",{}),(0,l.jsx)("strong",{children:"OTS"})," = Other Than Service (minor tasks), ",(0,l.jsx)("strong",{children:"Repair"})," = Major repairs, ",(0,l.jsx)("strong",{children:"Remodel"})," = Major renovations."]}):(0,l.jsxs)("p",{children:["Showing 2025 totals and averages per active customer by ZIP code.",(0,l.jsx)("br",{}),"Averages help identify high-value territories for marketing allocation."]})}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-3",children:"Filter by Sale Type:"}),(0,l.jsxs)("div",{className:"flex gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-ots",checked:y,onCheckedChange:e=>v(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-ots",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"OTS (Other Than Service)"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-repair",checked:C,onCheckedChange:e=>k(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-repair",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Repair"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-remodel",checked:S,onCheckedChange:e=>z(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-remodel",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Remodel"})]})]})]}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-3",children:"Filter by Branch Location:"}),(0,l.jsxs)("div",{className:"flex gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-glendale",checked:T,onCheckedChange:e=>Z(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-glendale",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Glendale"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-scottsdale",checked:A,onCheckedChange:e=>R(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-scottsdale",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Scottsdale"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-chandler",checked:P,onCheckedChange:e=>E(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-chandler",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Chandler"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ep,{id:"filter-tucson",checked:F,onCheckedChange:e=>M(!!e)}),(0,l.jsx)("label",{htmlFor:"filter-tucson",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Tucson"})]})]})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:G(U.reduce((e,s)=>e+s.total,0))}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Sales"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:G(U.reduce((e,s)=>e+s.ots,0))}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"OTS Sales"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:G(U.reduce((e,s)=>e+s.repair,0))}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"Repair Sales"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:G(U.reduce((e,s)=>e+s.remodel,0))}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"Remodel Sales"})]})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"view1"===x?`Sales by ZIP Code - ${u}`:"2025 Sales by ZIP Code"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"rounded-lg overflow-hidden border",children:(0,l.jsxs)(w.b6,{mapContainerStyle:ej,center:eg,zoom:8,options:eb,children:[U.map(e=>{let s=d[e.zip];if(!s||!s.geometry)return null;let t=s.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.Q8,{paths:t,options:{fillColor:J(e.total,V),fillOpacity:.6,strokeColor:"#333",strokeWeight:1,clickable:!0},onClick:()=>{e.latitude&&e.longitude&&_(e.zip,e.latitude,e.longitude)}},e.zip)}),H&&g&&(0,l.jsx)(w.kp,{position:g,onCloseClick:()=>{j(null),N(null)},children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("h3",{className:"font-bold text-lg",children:["ZIP ",H.zip]}),"view1"===x?(0,l.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Year:"})," ",H.year]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Total:"})," ",G(H.total)]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"OTS:"})," ",G(H.ots)]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Repair:"})," ",G(H.repair)]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Remodel:"})," ",G(H.remodel)]})]}):(0,l.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Active Customers:"})," ",H.activeCustomers]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Total 2025:"})," ",G(H.total)]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Avg per Customer:"})," ",G(H.avgTotal)]}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground mt-2",children:["OTS Avg: ",G(H.avgOts)]}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Repair Avg: ",G(H.avgRepair)]}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Remodel Avg: ",G(H.avgRemodel)]})]})]})})]})})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)(o.ll,{children:["view1"===x?`All ZIP Codes - ${u}`:"All ZIP Codes - 2025"," (",X.length," total)"]}),(0,l.jsxs)(c.z,{onClick:()=>{if(0===X.length)return;let e="view1"===x?["ZIP Code","Branch","City","Year","OTS","Repair","Remodel","Total"]:["ZIP Code","Branch","City","Active Customers","OTS","Repair","Remodel","Total","Avg per Customer"],s=X.map(e=>"view1"===x?[e.zip,e.branch||"",e.city||"",e.year,e.ots.toFixed(2),e.repair.toFixed(2),e.remodel.toFixed(2),e.total.toFixed(2)]:[e.zip,e.branch||"",e.city||"",e.activeCustomers,e.ots.toFixed(2),e.repair.toFixed(2),e.remodel.toFixed(2),e.total.toFixed(2),e.avgTotal.toFixed(2)]),t=new Blob([[e.join(","),...s.map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),a=URL.createObjectURL(t);l.setAttribute("href",a);let r="view1"===x?`ancillary-sales-${u}.csv`:"ancillary-sales-2025-analysis.csv";l.setAttribute("download",r),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},variant:"outline",size:"sm",className:"gap-2",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Export CSV"]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"rounded-md border max-h-[600px] overflow-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{className:"sticky top-0 bg-background z-10",children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Q("zip"),children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:["ZIP Code","zip"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"zip"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Q("branch"),children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:["Branch","branch"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"branch"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),"view2"===x&&(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Q("activeCustomers"),children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:["Active Customers","activeCustomers"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"activeCustomers"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>Q("ots"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["OTS","ots"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"ots"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>Q("repair"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["Repair","repair"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"repair"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>Q("remodel"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["Remodel","remodel"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"remodel"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>Q("total"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["Total","total"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"total"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})}),"view2"===x&&(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>Q("avgTotal"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-1",children:["Avg per Customer","avgTotal"===$&&("desc"===L?(0,l.jsx)(W.Z,{className:"h-4 w-4"}):(0,l.jsx)(Y.Z,{className:"h-4 w-4"})),"avgTotal"!==$&&(0,l.jsx)(B.Z,{className:"h-4 w-4 opacity-30"})]})})]})}),(0,l.jsx)(I.RM,{children:X.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.zip}),(0,l.jsx)(I.pj,{children:e.branch||"Unassigned"}),"view2"===x&&(0,l.jsx)(I.pj,{children:e.activeCustomers}),(0,l.jsx)(I.pj,{className:"text-right",children:G(e.ots)}),(0,l.jsx)(I.pj,{className:"text-right",children:G(e.repair)}),(0,l.jsx)(I.pj,{className:"text-right",children:G(e.remodel)}),(0,l.jsx)(I.pj,{className:"text-right font-bold",children:G(e.total)}),"view2"===x&&(0,l.jsx)(I.pj,{className:"text-right",children:G(e.avgTotal)})]},e.zip))})]})})})]})]})}var ey=t(6595);let ev={width:"100%",height:"700px"},eC={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function ew(e){switch(e){case"North":return"#3B82F6";case"Central":return"#10B981";case"South":return"#F59E0B";default:return"#6B7280"}}function ek(e){switch(e){case"North":return"APS Miami - North";case"Central":return"APS Miami - Central";case"South":return"APS Miami - South";default:return e}}function eS({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)({}),[i,d]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[u,f]=(0,a.useState)(!1),[p,j]=(0,a.useState)(""),[g,b]=(0,a.useState)(null),N=(0,a.useRef)(null);(0,a.useEffect)(()=>{fetch("/miami-map-data.json").then(e=>e.json()).then(e=>t(e)).catch(e=>console.error("Error loading Miami map data:",e)),fetch("/miami-zip-boundaries.json").then(e=>e.json()).then(e=>n(e)).catch(e=>console.error("Error loading Miami boundaries:",e)),fetch("/miami-office-location.json").then(e=>e.json()).then(e=>{e&&e.length>0&&d(e[0])}).catch(e=>console.error("Error loading office location:",e))},[]);let v=(0,a.useCallback)(e=>{N.current=e},[]),C=()=>{let e=p.trim();if(!e)return;let t=s.find(s=>s.zip===e);t&&N.current&&(N.current.panTo({lat:t.latitude,lng:t.longitude}),N.current.setZoom(12),b(e),h(e),setTimeout(()=>b(null),3e3))},k=e=>{h(e),f(!1)},S=e=>{if(!e||!e.coordinates)return[];try{if("Polygon"===e.type)return e.coordinates.map(e=>e.map(([e,s])=>({lat:s,lng:e})));if("MultiPolygon"===e.type)return e.coordinates.flatMap(e=>e.map(e=>e.map(([e,s])=>({lat:s,lng:e}))))}catch(e){console.error("Error converting geometry:",e)}return[]},T=s.filter(s=>e[s.territory]),Z=x?s.find(e=>e.zip===x):null;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(z.I,{placeholder:"Enter ZIP code to locate...",value:p,onChange:e=>j(e.target.value),onKeyDown:e=>"Enter"===e.key&&C(),className:"max-w-xs"}),(0,l.jsxs)(c.z,{onClick:C,size:"sm",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Search"]})]})}),(0,l.jsx)(o.Zb,{className:"p-2",children:(0,l.jsxs)(w.b6,{mapContainerStyle:ev,center:{lat:25.87,lng:-80.19},zoom:10,options:eC,onLoad:v,children:[T.map(e=>{let s=r[e.zip];if(!s)return null;let t=S(s);if(0===t.length)return null;let a=g===e.zip,n=x===e.zip,i=ew(e.territory);return(0,l.jsx)(w.Q8,{paths:t,options:{fillColor:i,fillOpacity:a?.6:n?.5:.25,strokeColor:a?"#000000":"#1e293b",strokeOpacity:a?1:.85,strokeWeight:a?3:2,clickable:!0},onClick:()=>k(e.zip)},e.zip)}),i&&(0,l.jsx)(w.jC,{position:{lat:i.lat,lng:i.lng},icon:{path:google.maps.SymbolPath.CIRCLE,scale:12,fillColor:"#FFD700",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:3},onClick:()=>{f(!0),h(null)}}),x&&Z&&(0,l.jsx)(w.kp,{position:{lat:Z.latitude,lng:Z.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4",style:{color:ew(Z.territory)}}),(0,l.jsxs)("h3",{className:"font-semibold",children:["ZIP ",Z.zip]})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"City:"})," ",Z.city]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Territory:"})," ",ek(Z.territory)]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Accounts:"})," ",Z.accountCount]})]})]})}),u&&i&&(0,l.jsx)(w.kp,{position:{lat:i.lat,lng:i.lng},onCloseClick:()=>f(!1),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(ey.Z,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),(0,l.jsx)("h3",{className:"font-semibold",children:i.fullName})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:"Central Office"})}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"11720 Biscayne Blvd, Miami, FL 33181"})]})]})})]})}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Proposed Miami Territory Distribution (Scenario II - ZIP Codes)"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["North","Central","South"].map(e=>{let t=s.filter(s=>s.territory===e),a=t.reduce((e,s)=>e+s.accountCount,0),r=ew(e);return(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded mt-0.5 flex-shrink-0",style:{backgroundColor:r}}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:ek(e)}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a," accounts • ",t.length," ZIP codes"]})]})]},e)})}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Total:"}),(0,l.jsxs)("span",{children:[s.reduce((e,s)=>e+s.accountCount,0)," accounts in ",s.length," ZIP codes"]})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"ZIP codes assigned based on geographic location to achieve balanced account distribution (~285 per territory)."})]})]})]})}let ez={width:"100%",height:"700px"},eT={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function eZ(e){switch(e){case"North":return"#3B82F6";case"Central":return"#10B981";case"South":return"#F59E0B";default:return"#6B7280"}}function eA(e){switch(e){case"North":return"APS Miami - North";case"Central":return"APS Miami - Central";case"South":return"APS Miami - South";default:return e}}function eR({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(null),[i,d]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[u,f]=(0,a.useState)(!1),[p,j]=(0,a.useState)(""),[g,b]=(0,a.useState)(null),N=(0,a.useRef)(null);(0,a.useEffect)(()=>{fetch("/miami-kml-scenario.json").then(e=>e.json()).then(e=>t(e)).catch(e=>console.error("Error loading KML scenario data:",e)),fetch("/miami-kml-boundaries.json").then(e=>e.json()).then(e=>n(e)).catch(e=>console.error("Error loading KML boundaries:",e)),fetch("/miami-office-location.json").then(e=>e.json()).then(e=>{e&&e.length>0&&d(e[0])}).catch(e=>console.error("Error loading office location:",e))},[]);let v=(0,a.useCallback)(e=>{N.current=e},[]),C=()=>{let e=p.trim().toUpperCase();if(!e)return;let t=s.find(s=>s.customerNumber.toUpperCase().includes(e)||s.customerName.toUpperCase().includes(e)||s.address.toUpperCase().includes(e));t&&N.current&&(N.current.panTo({lat:t.latitude,lng:t.longitude}),N.current.setZoom(14),b(t.customerNumber),h(t),setTimeout(()=>b(null),3e3))},k=e=>{h(e),f(!1)},S=s.filter(s=>e[s.kmlTerritory]),T={North:s.filter(e=>"North"===e.kmlTerritory).length,Central:s.filter(e=>"Central"===e.kmlTerritory).length,South:s.filter(e=>"South"===e.kmlTerritory).length};return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(z.I,{placeholder:"Search by account number, name, or address...",value:p,onChange:e=>j(e.target.value),onKeyDown:e=>"Enter"===e.key&&C(),className:"max-w-md"}),(0,l.jsxs)(c.z,{onClick:C,size:"sm",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Search"]})]})}),(0,l.jsx)(o.Zb,{className:"p-2",children:(0,l.jsxs)(w.b6,{mapContainerStyle:ez,center:{lat:25.87,lng:-80.19},zoom:10,options:eT,onLoad:v,children:[r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w.dp,{path:r.north.map(e=>({lat:e.lat,lng:e.lng})),options:{strokeColor:"#3B82F6",strokeOpacity:.8,strokeWeight:4,geodesic:!0}}),(0,l.jsx)(w.dp,{path:r.south.map(e=>({lat:e.lat,lng:e.lng})),options:{strokeColor:"#F59E0B",strokeOpacity:.8,strokeWeight:4,geodesic:!0}})]}),S.map(e=>{let s=g===e.customerNumber,t=eZ(e.kmlTerritory);return(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:s?10:6,fillColor:t,fillOpacity:s?1:.8,strokeColor:s?"#000000":"#FFFFFF",strokeWeight:s?3:1},onClick:()=>k(e),zIndex:s?1e3:void 0},e.customerNumber)}),i&&(0,l.jsx)(w.jC,{position:{lat:i.lat,lng:i.lng},icon:{path:google.maps.SymbolPath.CIRCLE,scale:12,fillColor:"#FFD700",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:3},onClick:()=>{f(!0),h(null)}}),x&&(0,l.jsx)(w.kp,{position:{lat:x.latitude,lng:x.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4",style:{color:eZ(x.kmlTerritory)}}),(0,l.jsx)("h3",{className:"font-semibold",children:x.customerName})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Account:"})," ",x.customerNumber]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",x.address]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"City:"})," ",x.city,", ",x.state," ",x.zip]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"KML Territory:"})," ",eA(x.kmlTerritory)]}),x.kmlTerritory!==x.originalTerritory&&(0,l.jsxs)("p",{className:"text-orange-600",children:[(0,l.jsx)("strong",{children:"Changed from:"})," ",eA(x.originalTerritory)]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Monthly:"})," $",x.monthlyPrice.toFixed(2)]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Route:"})," ",x.route]})]})]})}),u&&i&&(0,l.jsx)(w.kp,{position:{lat:i.lat,lng:i.lng},onCloseClick:()=>f(!1),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(ey.Z,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),(0,l.jsx)("h3",{className:"font-semibold",children:i.fullName})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:"Central Office"})}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"11720 Biscayne Blvd, Miami, FL 33181"})]})]})})]})}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Miami KML Boundary Scenario"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:["North","Central","South"].map(e=>{let s=T[e],t=eZ(e);return(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full mt-0.5 flex-shrink-0",style:{backgroundColor:t}}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:eA(e)}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s," accounts"]})]})]},e)})}),(0,l.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,l.jsx)("strong",{children:"Note:"})," Territory assignments based on precise KML boundary lines. Each dot represents one customer account, colored by assigned territory."]})})]})]})}var eP=t(2135),eE=t(875);let eF={width:"100%",height:"500px"},eM={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function e$(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function eO(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function eL({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[i,x]=(0,a.useState)({}),[h,u]=(0,a.useState)(null),[p,j]=(0,a.useState)("summary"),g=(0,a.useRef)(null),b={lat:25.85,lng:-80.19};(0,a.useEffect)(()=>{Promise.all([fetch("/miami-final-territory-assignments.json").then(e=>e.json()),fetch("/miami-final-territory-data.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json())]).then(([e,s,l])=>{t(e),n(s),x(l)})},[]);let N=(0,a.useCallback)(e=>{g.current=e},[]),y=e=>{j(p===e?null:e)},v=e=>{let t={};s.forEach(e=>{t[e.zip]=e.territory});let l=r.map(e=>({...e,territory:t[e.zip]||"Unknown"}));e&&(l=l.filter(s=>s.territory===e)),l.sort((e,s)=>e.zip.localeCompare(s.zip));let a=new Blob([["Customer Number,Account Name,Address,City,ZIP,Territory,Route",...l.map(e=>[e.customerNumber,e.accountName,e.address,e.city,e.zip,e.territory,e.route]).map(e=>e.map(e=>"string"==typeof e&&(e.includes(",")||e.includes('"'))?`"${e.replace(/"/g,'""')}"`:e).join(","))].join("\n")],{type:"text/csv"}),n=URL.createObjectURL(a),i=document.createElement("a");i.href=n,i.download=e?`miami-${e.toLowerCase()}-customers.csv`:"miami-all-customers.csv",i.click()},C=s.filter(s=>e[s.territory]),k={North:{zips:0,accounts:0},Central:{zips:0,accounts:0},South:{zips:0,accounts:0}};s.forEach(e=>{k[e.territory]&&(k[e.territory].zips++,k[e.territory].accounts+=e.accountCount)});let S=k.North.accounts+k.Central.accounts+k.South.accounts;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"MIAMI BREAKUP SCENARIO II - ZIP CODES"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"This scenario assigns entire ZIP codes to North/Central/South territories based on geographic location."})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y("summary"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-blue-600"}),"Territory Distribution Summary"]}),"summary"===p?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),"summary"===p&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-700",children:S}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Accounts"})]}),["North","Central","South"].map(e=>(0,l.jsxs)("div",{className:"text-center p-4 rounded-lg",style:{backgroundColor:e$(e,.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:eO(e)},children:e}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:k[e].accounts}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[k[e].zips," ZIPs"]})]},e))]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>v(null),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export All (",S,")"]}),["North","Central","South"].map(e=>(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>v(e),style:{borderColor:eO(e),color:eO(e)},children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),e," (",k[e].accounts,")"]},e))]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Territory Map"}),(0,l.jsxs)(w.b6,{mapContainerStyle:eF,center:b,zoom:10,options:eM,onLoad:N,children:[C.map(e=>{let s=i[e.zip];if(!s?.geometry?.coordinates)return null;let t=s.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.Q8,{paths:t,options:{fillColor:e$(e.territory,.4),fillOpacity:.4,strokeColor:eO(e.territory),strokeOpacity:1,strokeWeight:1},onClick:()=>u(e.zip)},e.zip)}),h&&(0,l.jsx)(w.kp,{position:(()=>{let e=s.find(e=>e.zip===h);return e?{lat:e.latitude,lng:e.longitude}:b})(),onCloseClick:()=>u(null),children:(0,l.jsx)("div",{className:"p-2",children:(()=>{let e=s.find(e=>e.zip===h);return e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold",children:e.zip}),(0,l.jsx)("p",{className:"text-sm",children:e.city}),(0,l.jsxs)("p",{className:"text-sm",children:["Territory: ",e.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[e.accountCount," accounts"]})]}):null})()})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y("zips"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"ZIP Code Assignments (",s.length," ZIPs)"]}),"zips"===p?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),"zips"===p&&(0,l.jsx)("div",{className:"mt-4 max-h-96 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"ZIP"}),(0,l.jsx)(I.ss,{children:"City"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Accounts"})]})}),(0,l.jsx)(I.RM,{children:s.filter(s=>e[s.territory]).sort((e,s)=>e.zip.localeCompare(s.zip)).map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.zip}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e$(e.territory,.2),borderColor:eO(e.territory),color:eO(e.territory)},children:e.territory})}),(0,l.jsx)(I.pj,{className:"text-right",children:e.accountCount})]},e.zip))})]})})]})})]})}var eD=t(6865),eI=t(2934);let eY={width:"100%",height:"650px"},eW={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function eB(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function eU(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function eJ({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[i,m]=(0,a.useState)([]),[x,h]=(0,a.useState)({}),[u,f]=(0,a.useState)(null),[p,j]=(0,a.useState)("all"),[g,b]=(0,a.useState)(""),[N,y]=(0,a.useState)(!1),[v,C]=(0,a.useState)(new Set),k=(0,a.useRef)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/miami-final-territory-data.json").then(e=>e.json()),fetch("/miami-final-territory-assignments.json").then(e=>e.json()),fetch("/miami-route-conflicts.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json())]).then(([e,s,l,a])=>{t(e),n(s),m(l),h(a)}).catch(e=>console.error("Error loading data:",e))},[]);let S=(0,a.useCallback)(e=>{k.current=e},[]),T=[...new Set(s.map(e=>e.route).filter(Boolean))].sort(),Z=s.filter(s=>{if(!e[s.newTerritory]||"all"!==p&&s.route!==p)return!1;if(g){let e=g.toLowerCase();return s.customerNumber.toLowerCase().includes(e)||s.accountName.toLowerCase().includes(e)||s.address.toLowerCase().includes(e)||s.zip.includes(e)}return!0}),A=r.filter(s=>e[s.territory]),R=e=>i.find(s=>s.route===e),P=e=>{C(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},E=(e,t)=>{let l=s.filter(s=>s.route===e);return{needsReassignment:l.filter(e=>e.newTerritory!==t),noReassignment:l.filter(e=>e.newTerritory===t)}},F=e=>{let s=x[e];if(!s)return[];try{if("Polygon"===s.type)return s.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));if("MultiPolygon"===s.type)return s.coordinates[0][0].map(e=>({lat:e[1],lng:e[0]}))}catch(e){}return[]},M=e=>{let s="all"===e?Z:Z.filter(s=>s.newTerritory===e);s.sort((e,s)=>e.zip.localeCompare(s.zip));let t=new Blob([["Customer Number,Account Name,Address,City,State,ZIP,Route,Service Days,New Territory,Monthly Price,Yearly Price",...s.map(e=>[e.customerNumber,`"${e.accountName||""}"`,`"${e.address||""}"`,`"${e.city||""}"`,e.state,e.zip,`"${e.route||""}"`,`"${e.serviceDays||""}"`,e.newTerritory,e.monthlyPrice,e.yearlyPrice].join(","))].join("\n")],{type:"text/csv"}),l=URL.createObjectURL(t),a=document.createElement("a");a.href=l,a.download=`miami-${"all"===e?"all-territories":e.toLowerCase()}-customers-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)},$={North:{customers:s.filter(e=>"North"===e.newTerritory).length,zips:r.filter(e=>"North"===e.territory).length},Central:{customers:s.filter(e=>"Central"===e.newTerritory).length,zips:r.filter(e=>"Central"===e.territory).length},South:{customers:s.filter(e=>"South"===e.newTerritory).length,zips:r.filter(e=>"South"===e.territory).length}},O=i.filter(e=>e.hasConflict);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-blue-50 to-green-50",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"FINAL MIAMI TERRITORY MAP"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"Finalized territory assignments with route conflict analysis. ZIP codes are assigned to North, Central, or South territories."})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,l.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,l.jsx)(z.I,{placeholder:"Search customer, address, or ZIP...",value:g,onChange:e=>b(e.target.value),className:"w-full"})}),(0,l.jsxs)(K.Ph,{value:p,onValueChange:j,children:[(0,l.jsx)(K.i4,{className:"w-[250px]",children:(0,l.jsx)(K.ki,{placeholder:"Filter by route"})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"all",children:"All Routes"}),T.map(e=>{let s=R(e);return(0,l.jsx)(K.Ql,{value:e,children:(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[s?.hasConflict&&(0,l.jsx)(eD.Z,{className:"h-3 w-3 text-amber-500"}),e]})},e)})]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>M("all"),className:"gap-1",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Export All"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>M("North"),className:"gap-1 border-blue-300 text-blue-700 hover:bg-blue-50",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"North"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>M("Central"),className:"gap-1 border-green-300 text-green-700 hover:bg-green-50",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Central"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>M("South"),className:"gap-1 border-amber-300 text-amber-700 hover:bg-amber-50",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"South"]})]})]})})}),(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.aY,{className:"p-2",children:(0,l.jsxs)(w.b6,{mapContainerStyle:eY,center:{lat:25.85,lng:-80.19},zoom:10,options:eW,onLoad:S,children:[A.map(e=>{let s=F(e.zip);return 0===s.length?null:(0,l.jsx)(w.Q8,{paths:s,options:{fillColor:eB(e.territory,.4),fillOpacity:.4,strokeColor:eU(e.territory),strokeOpacity:.8,strokeWeight:u===e.zip?3:1},onClick:()=>f(e.zip)},e.zip)}),Z.filter(e=>e.latitude&&e.longitude).map(e=>{let s=R(e.route),t=s?.hasConflict;return(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:6,fillColor:t?"#ef4444":eU(e.newTerritory),fillOpacity:.9,strokeColor:"#ffffff",strokeWeight:1},onClick:()=>f(e.customerNumber)},e.customerNumber)}),u&&s.find(e=>e.customerNumber===u)&&(()=>{let e=s.find(e=>e.customerNumber===u),t=R(e.route);return(0,l.jsx)(w.kp,{position:{lat:e.latitude,lng:e.longitude},onCloseClick:()=>f(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[250px]",children:[(0,l.jsx)("h3",{className:"font-bold text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:e.customerNumber}),(0,l.jsxs)("div",{className:"mt-2 space-y-1 text-xs",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",e.address]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"City:"})," ",e.city,", ",e.state," ",e.zip]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Route:"})," ",e.route]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Service:"})," ",e.serviceDays]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Territory:"})," ",(0,l.jsxs)("span",{className:"font-semibold px-1.5 py-0.5 rounded",style:{backgroundColor:eB(e.newTerritory,.2),color:eU(e.newTerritory)},children:["APS Miami - ",e.newTerritory]})]}),t?.hasConflict&&(0,l.jsxs)("div",{className:"mt-2 p-2 bg-amber-50 rounded border border-amber-200",children:[(0,l.jsxs)("p",{className:"font-semibold text-amber-800 flex items-center gap-1",children:[(0,l.jsx)(eD.Z,{className:"h-3 w-3"}),"Route Conflict"]}),(0,l.jsxs)("p",{className:"text-amber-700",children:["This route spans ",Object.keys(t.territories).length," territories:"]}),(0,l.jsx)("ul",{className:"mt-1",children:Object.entries(t.territories).map(([e,s])=>(0,l.jsxs)("li",{className:"text-amber-600",children:[e,": ",s," customers"]},e))})]})]})]})})})(),u&&r.find(e=>e.zip===u)&&(0,l.jsx)(w.kp,{position:{lat:r.find(e=>e.zip===u).latitude,lng:r.find(e=>e.zip===u).longitude},onCloseClick:()=>f(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("h3",{className:"font-bold",children:["ZIP: ",u]}),(0,l.jsx)("p",{className:"text-sm",children:r.find(e=>e.zip===u)?.city}),(0,l.jsxs)("p",{className:"text-sm mt-1",children:[(0,l.jsx)("strong",{children:"Territory:"})," ","APS Miami - ",r.find(e=>e.zip===u)?.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("strong",{children:"Accounts:"})," ",r.find(e=>e.zip===u)?.accountCount]})]})})]})})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Final Territory Distribution"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:["North","Central","South"].map(e=>(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded",style:{backgroundColor:eU(e)}}),(0,l.jsxs)("h4",{className:"font-medium",children:["APS Miami - ",e]})]}),(0,l.jsxs)("div",{className:"text-sm space-y-1",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Customers:"}),(0,l.jsx)("span",{className:"font-semibold",children:$[e].customers})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"ZIP Codes:"}),(0,l.jsx)("span",{className:"font-semibold",children:$[e].zips})]})]})]},e))}),(0,l.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Total:"}),(0,l.jsxs)("span",{children:[s.length," customers in ",r.length," ZIP codes"]})]})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[(0,l.jsx)(eD.Z,{className:"h-5 w-5 text-amber-500"}),"Route Conflicts (",O.length," of ",i.length," routes)"]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Click on a route card to see which customers need reassignment. Customers in territories other than the route's primary assignment are shown first in red."}),(0,l.jsx)("div",{className:"space-y-3",children:O.map(e=>{let s=v.has(e.route),{needsReassignment:t,noReassignment:a}=E(e.route,e.primaryTerritory);return(0,l.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-3 cursor-pointer hover:bg-amber-100 transition-colors",onClick:()=>P(e.route),children:[(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[s?(0,l.jsx)(eP.Z,{className:"h-4 w-4 text-amber-600"}):(0,l.jsx)(eE.Z,{className:"h-4 w-4 text-amber-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.route}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.totalCustomers," total customers •",(0,l.jsxs)("span",{className:"text-red-600 font-medium",children:[" ",t.length," need reassignment"]})]})]})]}),(0,l.jsxs)(d.C,{variant:"outline",className:"bg-amber-100 text-amber-800 border-amber-300",children:[Object.keys(e.territories).length," territories"]})]}),(0,l.jsx)("div",{className:"mt-2 flex flex-wrap gap-1 ml-6",children:Object.entries(e.territories).sort((e,s)=>s[1]-e[1]).map(([e,s])=>(0,l.jsxs)(d.C,{variant:"secondary",style:{backgroundColor:eB(e,.2),color:eU(e),borderColor:eU(e)},className:"text-xs border",children:[e,": ",s]},e))}),(0,l.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground ml-6",children:["Primary Assignment: ",(0,l.jsx)("strong",{className:"text-green-700",children:e.primaryTerritory})]})]}),s&&(0,l.jsxs)("div",{className:"border-t border-amber-200 bg-white",children:[t.length>0&&(0,l.jsxs)("div",{className:"p-3 bg-red-50",children:[(0,l.jsxs)("h5",{className:"text-xs font-semibold text-red-800 mb-2 flex items-center gap-1",children:[(0,l.jsx)(eD.Z,{className:"h-3 w-3"}),"NEEDS REASSIGNMENT (",t.length,")"]}),(0,l.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:t.sort((e,s)=>e.newTerritory.localeCompare(s.newTerritory)).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs p-2 rounded border",style:{backgroundColor:eB(e.newTerritory,.15),borderColor:eU(e.newTerritory)},children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium truncate",children:e.accountName}),(0,l.jsxs)("p",{className:"text-muted-foreground truncate",children:[e.address,", ",e.city," ",e.zip]})]}),(0,l.jsx)(d.C,{variant:"outline",className:"ml-2 shrink-0 text-xs",style:{backgroundColor:eB(e.newTerritory,.3),borderColor:eU(e.newTerritory),color:eU(e.newTerritory)},children:e.newTerritory})]},e.customerNumber))})]}),(0,l.jsxs)("div",{className:"p-3 bg-green-50",children:[(0,l.jsxs)("h5",{className:"text-xs font-semibold text-green-800 mb-2 flex items-center gap-1",children:[(0,l.jsx)(eI.Z,{className:"h-3 w-3"}),"NO REASSIGNMENT NEEDED (",a.length,")"]}),(0,l.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:a.sort((e,s)=>e.zip.localeCompare(s.zip)).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs p-2 rounded bg-green-100/50 border border-green-200",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium truncate",children:e.accountName}),(0,l.jsxs)("p",{className:"text-muted-foreground truncate",children:[e.address,", ",e.city," ",e.zip]})]}),(0,l.jsx)(d.C,{variant:"outline",className:"ml-2 shrink-0 text-xs bg-green-100 border-green-400 text-green-700",children:e.newTerritory})]},e.customerNumber))})]})]})]},e.route)})}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-4 w-4 text-green-500"}),"Clean Routes (",i.length-O.length," routes)"]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:i.filter(e=>!e.hasConflict).map(e=>(0,l.jsxs)(d.C,{variant:"outline",style:{backgroundColor:eB(e.primaryTerritory,.1),borderColor:eU(e.primaryTerritory)},children:[e.route," (",e.totalCustomers,")"]},e.route))})]})]})})]})}var eV=t(6858);let eX={width:"100%",height:"550px"},eQ={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function eG(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function e_(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function eH({areaFilter:e}){let[s,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[i,m]=(0,a.useState)({}),[x,h]=(0,a.useState)(null),[p,j]=(0,a.useState)(new Set(["auto"])),[g,b]=(0,a.useState)(new Set),[N,y]=(0,a.useState)("change"),[v,C]=(0,a.useState)("desc"),k=(0,a.useRef)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/miami-10pct-optimization.json").then(e=>e.json()),fetch("/miami-final-territory-assignments.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json())]).then(([e,s,l])=>{t(e),n(s),m(l)}).catch(e=>console.error("Error loading data:",e))},[]);let S=(0,a.useCallback)(e=>{k.current=e},[]),z=e=>{j(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},T=e=>{b(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},Z=r.filter(s=>e[s.territory]),A=e=>{let s=i[e];if(!s)return[];try{if("Polygon"===s.type)return s.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));if("MultiPolygon"===s.type)return s.coordinates[0][0].map(e=>({lat:e[1],lng:e[0]}))}catch(e){}return[]},R=e=>{N===e?C("asc"===v?"desc":"asc"):(y(e),C("desc"))},P=({column:e})=>N!==e?(0,l.jsx)(B.Z,{className:"h-3 w-3 ml-1 opacity-50"}):"asc"===v?(0,l.jsx)(Y.Z,{className:"h-3 w-3 ml-1"}):(0,l.jsx)(W.Z,{className:"h-3 w-3 ml-1"});if(!s)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)(u.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),(0,l.jsx)("p",{children:"Loading optimization data..."})]})});let E=(()=>{if(!s)return{};let e={};for(let t of s.autoReassignments)e[t.oldRoute]||(e[t.oldRoute]=[]),e[t.oldRoute].push(t);return e})(),F=(()=>{if(!s)return{};let e={};for(let t of s.manualReassignments)e[t.currentRoute]||(e[t.currentRoute]=[]),e[t.currentRoute].push(t);return e})();return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-purple-50 to-indigo-50",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"10% REASSIGNMENT OPTIMIZATION"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"Automated route reassignment analysis with \xb110% (or \xb18 pools) tolerance per technician. This view shows which customers can be automatically moved vs. those requiring manual decisions."})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsx)(o.Zb,{className:"bg-slate-50",children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.summary.totalConflicts}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Conflicts"})]})}),(0,l.jsx)(o.Zb,{className:"bg-green-50 border-green-200",children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-green-700",children:s.summary.autoReassigned}),(0,l.jsx)("p",{className:"text-xs text-green-600",children:"Auto-Reassigned (61%)"})]})}),(0,l.jsx)(o.Zb,{className:"bg-amber-50 border-amber-200",children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-amber-700",children:s.summary.manualRequired}),(0,l.jsx)("p",{className:"text-xs text-amber-600",children:"Manual Decisions (39%)"})]})}),(0,l.jsx)(o.Zb,{className:"bg-blue-50 border-blue-200",children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:"13 / 18"}),(0,l.jsx)("p",{className:"text-xs text-blue-600",children:"Clean Routes After"})]})})]}),(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsxs)(c.z,{variant:"default",size:"sm",onClick:()=>{if(!s)return;let e=new Blob([["Customer Number,Account Name,Address,City,ZIP,Territory,Current Route,New Route",...s.autoReassignments.map(e=>[e.customerNumber,`"${e.accountName||""}"`,`"${e.address||""}"`,`"${e.city||""}"`,e.zip,e.territory,`"${e.oldRoute||""}"`,`"${e.newRoute||""}"`].join(","))].join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download=`miami-auto-reassignments-10pct-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},className:"gap-2 bg-green-600 hover:bg-green-700",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Export Auto-Reassignments (",s.summary.autoReassigned,")"]}),(0,l.jsxs)(c.z,{variant:"default",size:"sm",onClick:()=>{if(!s)return;let e=new Blob([["Customer Number,Account Name,Address,City,ZIP,Current Route,Route Primary Territory,Customer Territory,Reason",...s.manualReassignments.map(e=>[e.customerNumber,`"${e.accountName||""}"`,`"${e.address||""}"`,`"${e.city||""}"`,e.zip,`"${e.currentRoute||""}"`,e.routePrimaryTerritory,e.currentTerritory,`"${e.reason||""}"`].join(","))].join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download=`miami-manual-decisions-10pct-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},className:"gap-2 bg-amber-600 hover:bg-amber-700",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Export Manual Decisions (",s.summary.manualRequired,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{if(!s)return;let e=new Blob([["Route,Technician,Primary Territory,Before,After,Change,Percent Change,Incoming,Outgoing",...s.routeChanges.map(e=>[`"${e.route}"`,`"${e.technician}"`,e.primaryTerritory,e.before,e.after,e.change,e.percentChange,e.incomingCount,e.outgoingCount].join(","))].join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download=`miami-route-changes-10pct-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},className:"gap-2",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4"}),"Export Route Changes"]})]})})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-2",children:[(0,l.jsxs)(w.b6,{mapContainerStyle:eX,center:{lat:25.85,lng:-80.19},zoom:10,options:eQ,onLoad:S,children:[Z.map(e=>{let s=A(e.zip);return 0===s.length?null:(0,l.jsx)(w.Q8,{paths:s,options:{fillColor:eG(e.territory,.35),fillOpacity:.35,strokeColor:e_(e.territory),strokeOpacity:.7,strokeWeight:1}},e.zip)}),s.autoReassignments.filter(s=>s.latitude&&s.longitude&&e[s.territory]).map(e=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"#22c55e",fillOpacity:.9,strokeColor:"#ffffff",strokeWeight:1},onClick:()=>h(`auto-${e.customerNumber}`)},`auto-${e.customerNumber}`)),s.manualReassignments.filter(s=>s.latitude&&s.longitude&&e[s.currentTerritory]).map(e=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:6,fillColor:"#ef4444",fillOpacity:.9,strokeColor:"#ffffff",strokeWeight:2},onClick:()=>h(`manual-${e.customerNumber}`)},`manual-${e.customerNumber}`)),x&&x.startsWith("auto-")&&(()=>{let e=s.autoReassignments.find(e=>`auto-${e.customerNumber}`===x);return e&&e.latitude&&e.longitude?(0,l.jsx)(w.kp,{position:{lat:e.latitude,lng:e.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[280px]",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(eI.Z,{className:"h-4 w-4 text-green-600"}),(0,l.jsx)("span",{className:"text-xs font-medium text-green-700",children:"AUTO-REASSIGNED"})]}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500 font-mono",children:e.customerNumber}),(0,l.jsxs)("div",{className:"mt-2 space-y-1 text-xs",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",e.address,", ",e.city," ",e.zip]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Territory:"})," ",e.territory]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2 p-2 bg-green-50 rounded",children:[(0,l.jsx)("span",{className:"text-red-600 line-through",children:e.oldRoute}),(0,l.jsx)(eV.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{className:"text-green-700 font-semibold",children:e.newRoute})]})]})]})}):null})(),x&&x.startsWith("manual-")&&(()=>{let e=s.manualReassignments.find(e=>`manual-${e.customerNumber}`===x);return e&&e.latitude&&e.longitude?(0,l.jsx)(w.kp,{position:{lat:e.latitude,lng:e.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[280px]",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(eD.Z,{className:"h-4 w-4 text-amber-600"}),(0,l.jsx)("span",{className:"text-xs font-medium text-amber-700",children:"MANUAL DECISION REQUIRED"})]}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500 font-mono",children:e.customerNumber}),(0,l.jsxs)("div",{className:"mt-2 space-y-1 text-xs",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",e.address,", ",e.city," ",e.zip]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Current Route:"})," ",e.currentRoute]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Customer Territory:"}),(0,l.jsx)(d.C,{variant:"outline",className:"ml-1",style:{backgroundColor:eG(e.currentTerritory,.2),borderColor:e_(e.currentTerritory),color:e_(e.currentTerritory)},children:e.currentTerritory})]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Route Primary:"})," ",e.routePrimaryTerritory]}),(0,l.jsx)("div",{className:"mt-2 p-2 bg-amber-50 rounded border border-amber-200",children:(0,l.jsx)("p",{className:"text-amber-800",children:e.reason})})]})]})}):null})()]}),(0,l.jsxs)("div",{className:"flex justify-center gap-6 mt-3 text-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,l.jsxs)("span",{children:["Auto-Reassigned (",s.summary.autoReassigned,")"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,l.jsxs)("span",{children:["Manual Decision (",s.summary.manualRequired,")"]})]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"Technician Pool Count Changes"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Click column headers to sort"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("technician"),children:(0,l.jsxs)("div",{className:"flex items-center",children:["Route / Technician",(0,l.jsx)(P,{column:"technician"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("primaryTerritory"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Primary",(0,l.jsx)(P,{column:"primaryTerritory"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("before"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Before",(0,l.jsx)(P,{column:"before"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("after"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["After",(0,l.jsx)(P,{column:"after"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("change"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Change",(0,l.jsx)(P,{column:"change"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("percentChange"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["% Change",(0,l.jsx)(P,{column:"percentChange"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("incomingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Incoming",(0,l.jsx)(P,{column:"incomingCount"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>R("outgoingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Outgoing",(0,l.jsx)(P,{column:"outgoingCount"})]})})]})}),(0,l.jsx)(I.RM,{children:(s?[...s.routeChanges].sort((e,s)=>{let t,l;switch(N){case"technician":t=e.technician.toLowerCase(),l=s.technician.toLowerCase();break;case"primaryTerritory":t=e.primaryTerritory,l=s.primaryTerritory;break;case"before":t=e.before,l=s.before;break;case"after":t=e.after,l=s.after;break;case"change":default:t=e.change,l=s.change;break;case"percentChange":t=e.percentChange,l=s.percentChange;break;case"incomingCount":t=e.incomingCount,l=s.incomingCount;break;case"outgoingCount":t=e.outgoingCount,l=s.outgoingCount}return"string"==typeof t&&"string"==typeof l?"asc"===v?t.localeCompare(l):l.localeCompare(t):"asc"===v?t-l:l-t}):[]).map(e=>(0,l.jsxs)(I.SC,{className:0!==e.change?"bg-yellow-50/50":"",children:[(0,l.jsx)(I.pj,{className:"font-medium",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm",children:e.technician}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.route})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:eG(e.primaryTerritory,.2),borderColor:e_(e.primaryTerritory),color:e_(e.primaryTerritory)},children:e.primaryTerritory})}),(0,l.jsx)(I.pj,{className:"text-right",children:e.before}),(0,l.jsx)(I.pj,{className:"text-right font-semibold",children:e.after}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`font-semibold ${e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-500"}`,children:[e.change>0?"+":"",e.change]})}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`${Math.abs(e.percentChange)>10?"text-amber-600 font-semibold":"text-gray-500"}`,children:[e.percentChange>0?"+":"",e.percentChange,"%"]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.incomingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:["+",e.incomingCount]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.outgoingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300",children:["-",e.outgoingCount]})})]},e.route))})]})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>z("auto"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-green-600"}),"Auto-Reassignments (",s.summary.autoReassigned," customers)"]}),p.has("auto")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"These customers can be automatically moved to new routes. Export this list to update your system."}),p.has("auto")&&(0,l.jsx)("div",{className:"mt-4 space-y-3",children:Object.entries(E).sort((e,s)=>s[1].length-e[1].length).map(([e,s])=>{let t=g.has(`auto-${e}`),a={};for(let e of s)a[e.newRoute]||(a[e.newRoute]=[]),a[e.newRoute].push(e);return(0,l.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg overflow-hidden",children:[(0,l.jsx)("div",{className:"p-3 cursor-pointer hover:bg-green-100 transition-colors",onClick:()=>T(`auto-${e}`),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[t?(0,l.jsx)(eP.Z,{className:"h-4 w-4 text-green-600"}):(0,l.jsx)(eE.Z,{className:"h-4 w-4 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium text-sm",children:["FROM: ",e]}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.length," customers moving out"]})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(a).map(([e,s])=>(0,l.jsxs)(d.C,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300 text-xs",children:["→ ",e.replace("AFP Route ","").replace("AFP ",""),": ",s.length]},e))})]})}),t&&(0,l.jsx)("div",{className:"border-t border-green-200 bg-white p-3",children:Object.entries(a).map(([e,s])=>(0,l.jsxs)("div",{className:"mb-3 last:mb-0",children:[(0,l.jsxs)("h5",{className:"text-xs font-semibold text-green-800 mb-2 flex items-center gap-1",children:[(0,l.jsx)(eV.Z,{className:"h-3 w-3"}),"TO: ",e," (",s.length,")"]}),(0,l.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:s.sort((e,s)=>e.zip.localeCompare(s.zip)).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs p-2 rounded bg-green-50 border border-green-200",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("p",{className:"font-medium",children:[(0,l.jsx)("span",{className:"text-green-700 font-mono mr-2",children:e.customerNumber}),e.accountName]}),(0,l.jsxs)("p",{className:"text-muted-foreground truncate",children:[e.address,", ",e.city," ",e.zip]})]}),(0,l.jsx)(d.C,{variant:"outline",className:"ml-2 shrink-0 text-xs",style:{backgroundColor:eG(e.territory,.2),borderColor:e_(e.territory),color:e_(e.territory)},children:e.territory})]},e.customerNumber))})]},e))})]},e)})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>z("manual"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eD.Z,{className:"h-5 w-5 text-amber-600"}),"Manual Decisions Required (",s.summary.manualRequired," customers)"]}),p.has("manual")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"These customers cannot be auto-reassigned due to route capacity limits. Management needs to decide which technician should absorb these pools."}),p.has("manual")&&(0,l.jsx)("div",{className:"mt-4 space-y-3",children:Object.entries(F).sort((e,s)=>s[1].length-e[1].length).map(([e,s])=>{let t=g.has(`manual-${e}`),a={};for(let e of s)a[e.currentTerritory]||(a[e.currentTerritory]=[]),a[e.currentTerritory].push(e);let r=s[0]?.routePrimaryTerritory||"Unknown";return(0,l.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg overflow-hidden",children:[(0,l.jsx)("div",{className:"p-3 cursor-pointer hover:bg-amber-100 transition-colors",onClick:()=>T(`manual-${e}`),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[t?(0,l.jsx)(eP.Z,{className:"h-4 w-4 text-amber-600"}):(0,l.jsx)(eE.Z,{className:"h-4 w-4 text-amber-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Primary: ",(0,l.jsx)("span",{className:"font-semibold",children:r})," •",s.length," stuck customers (route at minimum capacity)"]})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(a).map(([e,s])=>(0,l.jsxs)(d.C,{variant:"outline",className:"text-xs",style:{backgroundColor:eG(e,.2),borderColor:e_(e),color:e_(e)},children:["Need ",e,": ",s.length]},e))})]})}),t&&(0,l.jsx)("div",{className:"border-t border-amber-200 bg-white p-3",children:Object.entries(a).map(([e,s])=>(0,l.jsxs)("div",{className:"mb-3 last:mb-0",children:[(0,l.jsxs)("h5",{className:"text-xs font-semibold mb-2 flex items-center gap-1",style:{color:e_(e)},children:["NEEDS ",e.toUpperCase()," ROUTE (",s.length,")"]}),(0,l.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:s.sort((e,s)=>e.zip.localeCompare(s.zip)).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs p-2 rounded border",style:{backgroundColor:eG(e.currentTerritory,.1),borderColor:e_(e.currentTerritory)},children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("p",{className:"font-medium",children:[(0,l.jsx)("span",{className:"text-amber-700 font-mono mr-2",children:e.customerNumber}),e.accountName]}),(0,l.jsxs)("p",{className:"text-muted-foreground truncate",children:[e.address,", ",e.city," ",e.zip]})]}),(0,l.jsx)(d.C,{variant:"outline",className:"ml-2 shrink-0 text-xs",style:{backgroundColor:eG(e.currentTerritory,.3),borderColor:e_(e.currentTerritory),color:e_(e.currentTerritory)},children:e.currentTerritory})]},e.customerNumber))})]},e))})]},e)})})]})})]})}let eq={width:"100%",height:"550px"},eK={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function e0(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function e1(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function e2({areaFilter:e}){let[s,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[i,x]=(0,a.useState)({}),[h,p]=(0,a.useState)(null),[j,g]=(0,a.useState)(new Set(["comparison"])),[b,N]=(0,a.useState)("change"),[y,v]=(0,a.useState)("desc"),C=(0,a.useRef)(null),k={lat:25.85,lng:-80.19};(0,a.useEffect)(()=>{Promise.all([fetch("/miami-zip-optimized-scenario.json").then(e=>e.json()),fetch("/miami-zip-optimized-assignments.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json())]).then(([e,s,l])=>{t(e),n(s),x(l)})},[]);let S=(0,a.useCallback)(e=>{C.current=e},[]),z=e=>{g(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},T=e=>{b===e?v("asc"===y?"desc":"asc"):(N(e),v("desc"))},Z=({column:e})=>b!==e?(0,l.jsx)(B.Z,{className:"h-3 w-3 ml-1 opacity-50"}):"asc"===y?(0,l.jsx)(Y.Z,{className:"h-3 w-3 ml-1"}):(0,l.jsx)(W.Z,{className:"h-3 w-3 ml-1"}),A=(e,s)=>{if(0===e.length)return;let t=Object.keys(e[0]),l=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t??""}).join(","))].join("\n")],{type:"text/csv"}),a=URL.createObjectURL(l),r=document.createElement("a");r.href=a,r.download=s,r.click()};if(!s)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)(u.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),(0,l.jsx)("p",{children:"Loading ZIP-optimized scenario..."})]})});let R=r.filter(s=>e[s.territory]),P=new Set(s.zipChanges.map(e=>e.zip));return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 border-teal-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"ZIP-OPTIMIZED SCENARIO"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"This scenario reassigns 4 ZIP codes to better match existing route patterns, dramatically reducing conflicts."})]})}),(0,l.jsx)(o.Zb,{className:"border-2 border-teal-300",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>z("comparison"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-teal-600"}),"Scenario Comparison"]}),j.has("comparison")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),j.has("comparison")&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Original 10%"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-700",children:"42"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manual Decisions"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-teal-50 rounded-lg border-2 border-teal-300",children:[(0,l.jsx)("p",{className:"text-sm text-teal-600 font-medium",children:"ZIP-Optimized"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-teal-700",children:s.summary.manualRequired}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manual Decisions"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Improvement"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-green-700",children:["-",42-s.summary.manualRequired]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Fewer Decisions"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Original Scenario"}),(0,l.jsxs)("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[(0,l.jsx)("li",{children:"• Auto-reassigned: 91"}),(0,l.jsx)("li",{children:"• Manual decisions: 42"}),(0,l.jsx)("li",{children:"• Clean routes: 12 of 17"})]})]}),(0,l.jsxs)("div",{className:"p-3 bg-teal-50 rounded-lg border border-teal-200",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-teal-700",children:"ZIP-Optimized"}),(0,l.jsxs)("ul",{className:"text-sm text-teal-600 mt-2 space-y-1",children:[(0,l.jsxs)("li",{children:["• Auto-reassigned: ",s.summary.autoReassigned]}),(0,l.jsxs)("li",{children:["• Manual decisions: ",s.summary.manualRequired]}),(0,l.jsxs)("li",{children:["• Clean routes: ",s.summary.cleanRoutesAfter," of ",s.summary.totalRoutes]})]})]})]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-teal-600"}),"ZIP Code Reassignments (",s.zipChanges.length," changes)"]}),(0,l.jsx)("div",{className:"space-y-3",children:s.zipChanges.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium",children:[e.zip," - ",e.city]}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.customerCount," customers"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e0(e.originalTerritory,.2),borderColor:e1(e.originalTerritory),color:e1(e.originalTerritory)},children:e.originalTerritory}),(0,l.jsx)(eV.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e0(e.newTerritory,.2),borderColor:e1(e.newTerritory),color:e1(e.newTerritory)},children:e.newTerritory})]})]},e.zip))}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mt-3",children:"These ZIPs are already primarily served by routes from the suggested territory."})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"New Territory Distribution"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e0("North",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e1("North")},children:"North"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.North}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e0("Central",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e1("Central")},children:"Central"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.Central}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e0("South",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e1("South")},children:"South"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.South}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"ZIP-Optimized Territory Map"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"Changed ZIPs are highlighted with dashed borders"}),(0,l.jsxs)(w.b6,{mapContainerStyle:eq,center:k,zoom:10,options:eK,onLoad:S,children:[R.map(e=>{let s=i[e.zip];if(!s?.geometry?.coordinates)return null;let t=P.has(e.zip),a=s.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.Q8,{paths:a,options:{fillColor:e0(e.territory,.4),fillOpacity:t?.6:.4,strokeColor:t?"#0f766e":e1(e.territory),strokeOpacity:1,strokeWeight:t?3:1},onClick:()=>p(e.zip)},e.zip)}),s.zipChanges.map(e=>{let s=r.find(s=>s.zip===e.zip);return s?(0,l.jsx)(w.jC,{position:{lat:s.latitude,lng:s.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:12,fillColor:"#0d9488",fillOpacity:1,strokeColor:"#fff",strokeWeight:3},onClick:()=>p(e.zip)},`marker-${e.zip}`):null}),h&&(0,l.jsx)(w.kp,{position:(()=>{let e=r.find(e=>e.zip===h);return e?{lat:e.latitude,lng:e.longitude}:k})(),onCloseClick:()=>p(null),children:(0,l.jsx)("div",{className:"p-2",children:(()=>{let e=r.find(e=>e.zip===h),t=s.zipChanges.find(e=>e.zip===h);return e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold",children:e.zip}),(0,l.jsx)("p",{className:"text-sm",children:e.city}),(0,l.jsxs)("p",{className:"text-sm",children:["Territory: ",e.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[e.accountCount," customers"]}),t&&(0,l.jsxs)("p",{className:"text-sm text-teal-600 font-medium mt-1",children:["★ Changed from ",t.originalTerritory]})]}):null})()})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"Technician Pool Count Changes"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Click column headers to sort"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("technician"),children:(0,l.jsxs)("div",{className:"flex items-center",children:["Route / Technician",(0,l.jsx)(Z,{column:"technician"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("primaryTerritory"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Primary",(0,l.jsx)(Z,{column:"primaryTerritory"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("before"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Before",(0,l.jsx)(Z,{column:"before"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("after"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["After",(0,l.jsx)(Z,{column:"after"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("change"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Change",(0,l.jsx)(Z,{column:"change"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("percentChange"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["% Change",(0,l.jsx)(Z,{column:"percentChange"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("incomingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Incoming",(0,l.jsx)(Z,{column:"incomingCount"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>T("outgoingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Outgoing",(0,l.jsx)(Z,{column:"outgoingCount"})]})})]})}),(0,l.jsx)(I.RM,{children:(s?[...s.routeChanges].sort((e,s)=>{let t,l;switch(b){case"technician":t=e.technician.toLowerCase(),l=s.technician.toLowerCase();break;case"primaryTerritory":t=e.primaryTerritory,l=s.primaryTerritory;break;case"before":t=e.before,l=s.before;break;case"after":t=e.after,l=s.after;break;case"change":default:t=e.change,l=s.change;break;case"percentChange":t=e.percentChange,l=s.percentChange;break;case"incomingCount":t=e.incomingCount,l=s.incomingCount;break;case"outgoingCount":t=e.outgoingCount,l=s.outgoingCount}return"string"==typeof t&&"string"==typeof l?"asc"===y?t.localeCompare(l):l.localeCompare(t):"asc"===y?t-l:l-t}):[]).map(e=>(0,l.jsxs)(I.SC,{className:0!==e.change?"bg-yellow-50/50":"",children:[(0,l.jsx)(I.pj,{className:"font-medium",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm",children:e.technician}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.route})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e0(e.primaryTerritory,.2),borderColor:e1(e.primaryTerritory),color:e1(e.primaryTerritory)},children:e.primaryTerritory})}),(0,l.jsx)(I.pj,{className:"text-right",children:e.before}),(0,l.jsx)(I.pj,{className:"text-right font-semibold",children:e.after}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`font-semibold ${e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-500"}`,children:[e.change>0?"+":"",e.change]})}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`${Math.abs(e.percentChange)>10?"text-amber-600 font-semibold":"text-gray-500"}`,children:[e.percentChange>0?"+":"",e.percentChange,"%"]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.incomingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:["+",e.incomingCount]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.outgoingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300",children:["-",e.outgoingCount]})})]},e.route))})]})})]})}),s.summary.manualRequired>0&&(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>z("manual"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eD.Z,{className:"h-5 w-5 text-amber-600"}),"Remaining Manual Decisions (",s.summary.manualRequired,")"]}),j.has("manual")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"These customers still need manual review even with ZIP optimization."}),j.has("manual")&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.manualReassignments,"zip-optimized-manual-decisions.csv"),className:"mb-3",children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Manual Decisions"]}),(0,l.jsx)("div",{className:"max-h-64 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Current Route"}),(0,l.jsx)(I.ss,{children:"Reason"})]})}),(0,l.jsx)(I.RM,{children:s.manualReassignments.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsxs)(I.pj,{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]}),(0,l.jsxs)(I.pj,{className:"text-sm",children:[e.address,", ",e.city," ",e.zip]}),(0,l.jsx)(I.pj,{className:"text-sm",children:e.currentRoute}),(0,l.jsx)(I.pj,{className:"text-sm text-amber-600",children:e.reason})]},e.customerNumber))})]})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>z("autoDetail"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-green-600"}),"Auto-Reassignment Details (",s.summary.autoReassigned," customers)"]}),j.has("autoDetail")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Full list of customers being moved from one technician to another."}),j.has("autoDetail")&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{children:"From Technician"}),(0,l.jsx)(I.ss,{children:"To Technician"})]})}),(0,l.jsx)(I.RM,{children:s.autoReassignments.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsxs)(I.pj,{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]}),(0,l.jsxs)(I.pj,{className:"text-sm",children:[e.address,", ",e.city," ",e.zip]}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e0(e.territory,.2),borderColor:e1(e.territory),color:e1(e.territory)},children:e.territory})}),(0,l.jsx)(I.pj,{className:"text-sm",children:(0,l.jsx)("span",{className:"text-red-600",children:e.oldTechnician||e.oldRoute})}),(0,l.jsx)(I.pj,{className:"text-sm",children:(0,l.jsx)("span",{className:"text-green-600 font-medium",children:e.newTechnician||e.newRoute})})]},e.customerNumber))})]})})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Export Data"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.autoReassignments,"zip-optimized-auto-reassignments.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Auto-Reassignments (",s.summary.autoReassigned,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.zipChanges,"zip-changes.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"ZIP Changes (",s.zipChanges.length,")"]})]})]})})]})}var e4=t(7769),e5=t(2208);let e6={width:"100%",height:"550px"},e3={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0};function e8(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function e7(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function e9({areaFilter:e}){let[s,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[i,x]=(0,a.useState)({}),[h,p]=(0,a.useState)(null),[j,g]=(0,a.useState)(new Set(["comparison","manual"])),[b,N]=(0,a.useState)("change"),[y,v]=(0,a.useState)("desc"),C=(0,a.useRef)(null),[k,S]=(0,a.useState)([]),[z,T]=(0,a.useState)(null),[Z,A]=(0,a.useState)(null),[R,P]=(0,a.useState)(!1),[E,F]=(0,a.useState)({}),M={lat:25.85,lng:-80.19};(0,a.useEffect)(()=>{Promise.all([fetch("/miami-zip-optimized-2-scenario.json").then(e=>e.json()),fetch("/miami-zip-optimized-2-assignments.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json()),fetch("/miami-route-assignments.json").then(e=>e.json())]).then(([e,s,l,a])=>{t(e),n(s),x(l),S(a)})},[]);let $=(0,a.useCallback)(e=>{C.current=e},[]),O=e=>{g(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},L=e=>{b===e?v("asc"===y?"desc":"asc"):(N(e),v("desc"))},D=(0,a.useMemo)(()=>{if(!s)return[];let e={};return Object.values(E).forEach(s=>{e[s]=(e[s]||0)+1}),s.routeChanges.map(s=>({...s,manualIncoming:e[s.route]||0,adjustedAfter:s.after+(e[s.route]||0)}))},[s,E]),U=({column:e})=>b!==e?(0,l.jsx)(B.Z,{className:"h-3 w-3 ml-1 opacity-50"}):"asc"===y?(0,l.jsx)(Y.Z,{className:"h-3 w-3 ml-1"}):(0,l.jsx)(W.Z,{className:"h-3 w-3 ml-1"}),J=(0,a.useMemo)(()=>z&&k.length?k.filter(e=>e.routeTech===z):[],[z,k]),V=(0,a.useMemo)(()=>{if(!Z||!R||!k.length||!s)return[];let e=Z.currentTerritory,t=s.routeChanges.filter(s=>s.primaryTerritory===e).map(e=>e.route);return k.filter(e=>t.includes(e.routeTech))},[Z,R,k,s]),X=(0,a.useMemo)(()=>s?s.manualReassignments.filter(e=>!E[e.customerNumber]):[],[s,E]),Q=(e,s)=>{"undecided"===s?F(s=>{let t={...s};return delete t[e],t}):F(t=>({...t,[e]:s}))},G=e=>{z===e?T(null):(T(e),A(null),P(!1))},_=e=>{Z?.customerNumber===e.customerNumber?(A(null),P(!1)):(A(e),T(null),C.current&&e.latitude&&e.longitude&&(C.current.panTo({lat:e.latitude,lng:e.longitude}),C.current.setZoom(13)))},H=(e,s)=>{if(0===e.length)return;let t=Object.keys(e[0]),l=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t??""}).join(","))].join("\n")],{type:"text/csv"}),a=URL.createObjectURL(l),r=document.createElement("a");r.href=a,r.download=s,r.click()};if(!s)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)(u.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),(0,l.jsx)("p",{children:"Loading ZIP-optimized scenario..."})]})});let q=r.filter(s=>e[s.territory]),ee=new Set(s.zipChanges.map(e=>e.zip)),es=Object.keys(E).length,et=X.length;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 border-cyan-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"ZIP-OPTIMIZED #2 SCENARIO"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"This scenario reassigns only 1 ZIP code (33137) to better match existing route patterns, dramatically reducing conflicts."})]})}),(0,l.jsx)(o.Zb,{className:"border-2 border-cyan-300",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>O("comparison"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-cyan-600"}),"Scenario Comparison"]}),j.has("comparison")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),j.has("comparison")&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Original 10%"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-700",children:"42"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manual Decisions"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-cyan-50 rounded-lg border-2 border-cyan-300",children:[(0,l.jsx)("p",{className:"text-sm text-cyan-600 font-medium",children:"ZIP-Optimized"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-cyan-700",children:s.summary.manualRequired}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manual Decisions"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Improvement"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-green-700",children:["-",42-s.summary.manualRequired]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Fewer Decisions"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Original Scenario"}),(0,l.jsxs)("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[(0,l.jsx)("li",{children:"• Auto-reassigned: 91"}),(0,l.jsx)("li",{children:"• Manual decisions: 42"}),(0,l.jsx)("li",{children:"• Clean routes: 12 of 17"})]})]}),(0,l.jsxs)("div",{className:"p-3 bg-cyan-50 rounded-lg border border-cyan-200",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-cyan-700",children:"ZIP-Optimized"}),(0,l.jsxs)("ul",{className:"text-sm text-cyan-600 mt-2 space-y-1",children:[(0,l.jsxs)("li",{children:["• Auto-reassigned: ",s.summary.autoReassigned]}),(0,l.jsxs)("li",{children:["• Manual decisions: ",s.summary.manualRequired]}),(0,l.jsxs)("li",{children:["• Clean routes: ",s.summary.cleanRoutesAfter," of ",s.summary.totalRoutes]})]})]})]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-cyan-600"}),"ZIP Code Reassignments (",s.zipChanges.length," changes)"]}),(0,l.jsx)("div",{className:"space-y-3",children:s.zipChanges.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium",children:[e.zip," - ",e.city]}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.customerCount," customers"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e8(e.originalTerritory,.2),borderColor:e7(e.originalTerritory),color:e7(e.originalTerritory)},children:e.originalTerritory}),(0,l.jsx)(eV.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e8(e.newTerritory,.2),borderColor:e7(e.newTerritory),color:e7(e.newTerritory)},children:e.newTerritory})]})]},e.zip))}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mt-3",children:"These ZIPs are already primarily served by routes from the suggested territory."})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"New Territory Distribution"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e8("North",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e7("North")},children:"North"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.North}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e8("Central",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e7("Central")},children:"Central"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.Central}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:e8("South",.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:e7("South")},children:"South"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.territoryStats.South}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"customers"})]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"ZIP-Optimized Territory Map"}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:z?`Showing ${J.length} stops for ${z.split(" Route ")[1]||z}`:Z?`Viewing pool: ${Z.accountName}`:"Changed ZIPs are highlighted with dashed borders. Click technician rows to view routes."}),(z||Z)&&(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{T(null),A(null),P(!1)},children:[(0,l.jsx)(e4.Z,{className:"h-4 w-4 mr-1"}),"Clear Selection"]})]}),Z&&(0,l.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,l.jsxs)(c.z,{variant:R?"default":"outline",size:"sm",onClick:()=>P(!R),children:[R?(0,l.jsx)(e4.Z,{className:"h-4 w-4 mr-1"}):(0,l.jsx)(e5.Z,{className:"h-4 w-4 mr-1"}),R?"Hide":"Show"," ",Z.currentTerritory," Territory Stops (",V.length,")"]})}),(0,l.jsxs)(w.b6,{mapContainerStyle:e6,center:M,zoom:10,options:e3,onLoad:$,children:[q.map(e=>{let s=i[e.zip];if(!s?.geometry?.coordinates)return null;let t=ee.has(e.zip),a=s.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.Q8,{paths:a,options:{fillColor:e8(e.territory,.4),fillOpacity:t?.6:.4,strokeColor:t?"#0f766e":e7(e.territory),strokeOpacity:1,strokeWeight:t?3:1},onClick:()=>p(e.zip)},e.zip)}),z&&J.map((e,s)=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#3b82f6",fillOpacity:.9,strokeColor:"#1e40af",strokeWeight:2},label:{text:String(s+1),color:"#fff",fontSize:"10px",fontWeight:"bold"},onClick:()=>p(e.customerNumber)},`tech-stop-${e.customerNumber}`)),Z&&Z.latitude&&Z.longitude&&(0,l.jsx)(w.jC,{position:{lat:Z.latitude,lng:Z.longitude},icon:{path:google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,scale:8,fillColor:"#dc2626",fillOpacity:1,strokeColor:"#fff",strokeWeight:3},onClick:()=>p(Z.customerNumber)},`pool-${Z.customerNumber}`),R&&V.map(e=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:6,fillColor:e7(Z?.currentTerritory||"North"),fillOpacity:.8,strokeColor:"#fff",strokeWeight:1.5},onClick:()=>p(e.customerNumber)},`territory-stop-${e.customerNumber}`)),h&&(0,l.jsx)(w.kp,{position:(()=>{let e=r.find(e=>e.zip===h);if(e)return{lat:e.latitude,lng:e.longitude};let s=J.find(e=>e.customerNumber===h);if(s)return{lat:s.latitude,lng:s.longitude};if(Z&&Z.customerNumber===h&&Z.latitude&&Z.longitude)return{lat:Z.latitude,lng:Z.longitude};let t=V.find(e=>e.customerNumber===h);return t?{lat:t.latitude,lng:t.longitude}:M})(),onCloseClick:()=>p(null),children:(0,l.jsx)("div",{className:"p-2 min-w-[200px]",children:(()=>{let e=r.find(e=>e.zip===h);if(e){let t=s.zipChanges.find(e=>e.zip===h);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold",children:e.zip}),(0,l.jsx)("p",{className:"text-sm",children:e.city}),(0,l.jsxs)("p",{className:"text-sm",children:["Territory: ",e.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[e.accountCount," customers"]}),t&&(0,l.jsxs)("p",{className:"text-sm text-cyan-600 font-medium mt-1",children:["★ Changed from ",t.originalTerritory]})]})}let t=J.find(e=>e.customerNumber===h);if(t)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold",children:t.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:t.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:t.address}),(0,l.jsxs)("p",{className:"text-sm",children:[t.city,", ",t.state," ",t.zip]}),(0,l.jsxs)("p",{className:"text-sm mt-1",children:["Route: ",t.routeTech]}),(0,l.jsxs)("p",{className:"text-sm",children:["Day: ",t.dayOfService]})]});if(Z&&Z.customerNumber===h)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold text-red-600",children:Z.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:Z.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:Z.address}),(0,l.jsxs)("p",{className:"text-sm",children:[Z.city," ",Z.zip]}),(0,l.jsxs)("p",{className:"text-sm mt-1",children:["Current: ",Z.currentRoute]}),(0,l.jsxs)("p",{className:"text-sm text-amber-600",children:["Territory: ",Z.currentTerritory]})]});let a=V.find(e=>e.customerNumber===h);return a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"font-bold",style:{color:e7(Z?.currentTerritory||"North")},children:a.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:a.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:a.address}),(0,l.jsxs)("p",{className:"text-sm",children:[a.city,", ",a.state," ",a.zip]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Route:"})," ",a.routeTech]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Day:"})," ",a.dayOfService]})]})]}):null})()})})]})]})}),s.summary.manualRequired>0&&(0,l.jsx)(o.Zb,{className:"border-2 border-amber-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>O("manual"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eD.Z,{className:"h-5 w-5 text-amber-600"}),"Remaining Manual Decisions (",et,")",es>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"ml-2 bg-green-50 text-green-700 border-green-300",children:[es," assigned"]})]}),j.has("manual")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Click a pool to view on map. Use the dropdown to reassign to a route."}),j.has("manual")&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>H(X,"zip-optimized-manual-decisions.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Remaining (",et,")"]}),es>0&&(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{H(s.manualReassignments.filter(e=>E[e.customerNumber]).map(e=>({...e,assignedRoute:E[e.customerNumber]})),"manual-assignments.csv")},children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Assigned (",es,")"]})]}),(0,l.jsx)("div",{className:"max-h-80 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"w-10"}),(0,l.jsx)(I.ss,{children:"Customer"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Current Route"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{className:"w-48",children:"Assign To"})]})}),(0,l.jsx)(I.RM,{children:s.manualReassignments.map(e=>{let t=!!E[e.customerNumber],a=Z?.customerNumber===e.customerNumber;return(0,l.jsxs)(I.SC,{className:`cursor-pointer transition-colors ${t?"bg-green-50/50":a?"bg-amber-100":"hover:bg-slate-50"}`,children:[(0,l.jsx)(I.pj,{children:(0,l.jsx)(c.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>_(e),children:a?(0,l.jsx)(e4.Z,{className:"h-4 w-4 text-amber-600"}):(0,l.jsx)(e5.Z,{className:"h-4 w-4"})})}),(0,l.jsxs)(I.pj,{onClick:()=>_(e),children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]}),(0,l.jsxs)(I.pj,{className:"text-sm",onClick:()=>_(e),children:[e.address,", ",e.city," ",e.zip]}),(0,l.jsx)(I.pj,{className:"text-sm",onClick:()=>_(e),children:e.currentRoute}),(0,l.jsx)(I.pj,{onClick:()=>_(e),children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e8(e.currentTerritory,.2),borderColor:e7(e.currentTerritory),color:e7(e.currentTerritory)},children:e.currentTerritory})}),(0,l.jsx)(I.pj,{children:(0,l.jsxs)(K.Ph,{value:E[e.customerNumber]||"undecided",onValueChange:s=>Q(e.customerNumber,s),children:[(0,l.jsx)(K.i4,{className:`w-full ${t?"border-green-500":""}`,children:(0,l.jsx)(K.ki,{placeholder:"Undecided"})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"undecided",children:(0,l.jsx)("span",{className:"text-amber-600",children:"Undecided"})}),s.routeChanges.map(e=>(0,l.jsx)(K.Ql,{value:e.route,children:(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e7(e.primaryTerritory)}}),e.technician]})},e.route))]})]})})]},e.customerNumber)})})]})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"Technician Pool Count Changes",es>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"ml-2 bg-cyan-50 text-cyan-700 border-cyan-300",children:["+",es," manual"]})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Click a technician row to view their current route on the map. Click column headers to sort."}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("technician"),children:(0,l.jsxs)("div",{className:"flex items-center",children:["Route / Technician",(0,l.jsx)(U,{column:"technician"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("primaryTerritory"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Primary",(0,l.jsx)(U,{column:"primaryTerritory"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("before"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Before",(0,l.jsx)(U,{column:"before"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("after"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["After",(0,l.jsx)(U,{column:"after"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("change"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["Change",(0,l.jsx)(U,{column:"change"})]})}),(0,l.jsx)(I.ss,{className:"text-right cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("percentChange"),children:(0,l.jsxs)("div",{className:"flex items-center justify-end",children:["% Change",(0,l.jsx)(U,{column:"percentChange"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("incomingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Incoming",(0,l.jsx)(U,{column:"incomingCount"})]})}),(0,l.jsx)(I.ss,{className:"text-center cursor-pointer hover:bg-slate-100 select-none",onClick:()=>L("outgoingCount"),children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:["Outgoing",(0,l.jsx)(U,{column:"outgoingCount"})]})})]})}),(0,l.jsx)(I.RM,{children:(D.length?[...D].sort((e,s)=>{let t,l;switch(b){case"technician":t=e.technician.toLowerCase(),l=s.technician.toLowerCase();break;case"primaryTerritory":t=e.primaryTerritory,l=s.primaryTerritory;break;case"before":t=e.before,l=s.before;break;case"after":t=e.adjustedAfter,l=s.adjustedAfter;break;case"change":default:t=e.adjustedAfter-e.before,l=s.adjustedAfter-s.before;break;case"percentChange":t=e.percentChange,l=s.percentChange;break;case"incomingCount":t=e.incomingCount+e.manualIncoming,l=s.incomingCount+s.manualIncoming;break;case"outgoingCount":t=e.outgoingCount,l=s.outgoingCount}return"string"==typeof t&&"string"==typeof l?"asc"===y?t.localeCompare(l):l.localeCompare(t):"asc"===y?t-l:l-t}):[]).map(e=>{let s=e.adjustedAfter-e.before,t=z===e.route;return(0,l.jsxs)(I.SC,{className:`cursor-pointer transition-colors ${t?"bg-blue-100":0!==s?"bg-yellow-50/50 hover:bg-yellow-100/50":"hover:bg-slate-50"}`,onClick:()=>G(e.route),children:[(0,l.jsx)(I.pj,{className:"font-medium",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,l.jsx)(e5.Z,{className:"h-4 w-4 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm",children:e.technician}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.route})]})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e8(e.primaryTerritory,.2),borderColor:e7(e.primaryTerritory),color:e7(e.primaryTerritory)},children:e.primaryTerritory})}),(0,l.jsx)(I.pj,{className:"text-right",children:e.before}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold",children:[e.adjustedAfter,e.manualIncoming>0&&(0,l.jsxs)("span",{className:"text-xs text-cyan-600 ml-1",children:["(+",e.manualIncoming,")"]})]}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`font-semibold ${s>0?"text-green-600":s<0?"text-red-600":"text-gray-500"}`,children:[s>0?"+":"",s]})}),(0,l.jsx)(I.pj,{className:"text-right",children:(0,l.jsxs)("span",{className:`${Math.abs(e.percentChange)>10?"text-amber-600 font-semibold":"text-gray-500"}`,children:[e.percentChange>0?"+":"",e.percentChange,"%"]})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[e.incomingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:["+",e.incomingCount]}),e.manualIncoming>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-cyan-50 text-cyan-700 border-cyan-300",children:["+",e.manualIncoming]})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.outgoingCount>0&&(0,l.jsxs)(d.C,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300",children:["-",e.outgoingCount]})})]},e.route)})})]})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>O("autoDetail"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-green-600"}),"Auto-Reassignment Details (",s.summary.autoReassigned," customers)"]}),j.has("autoDetail")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Full list of customers being moved from one technician to another."}),j.has("autoDetail")&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{children:"From Technician"}),(0,l.jsx)(I.ss,{children:"To Technician"})]})}),(0,l.jsx)(I.RM,{children:s.autoReassignments.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsxs)(I.pj,{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]}),(0,l.jsxs)(I.pj,{className:"text-sm",children:[e.address,", ",e.city," ",e.zip]}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:e8(e.territory,.2),borderColor:e7(e.territory),color:e7(e.territory)},children:e.territory})}),(0,l.jsx)(I.pj,{className:"text-sm",children:(0,l.jsx)("span",{className:"text-red-600",children:e.oldTechnician||e.oldRoute})}),(0,l.jsx)(I.pj,{className:"text-sm",children:(0,l.jsx)("span",{className:"text-green-600 font-medium",children:e.newTechnician||e.newRoute})})]},e.customerNumber))})]})})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Export Data"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>H(s.autoReassignments,"zip-optimized-2-auto-reassignments.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Auto-Reassignments (",s.summary.autoReassigned,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>H(s.zipChanges,"zip-changes-2.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"ZIP Changes (",s.zipChanges.length,")"]})]})]})})]})}var se=t(7806);let ss={width:"100%",height:"550px"},st={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0},sl=["#3b82f6","#ef4444","#22c55e","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1","#14b8a6","#a855f7","#eab308"];function sa(e,s=.5){return({North:`rgba(59, 130, 246, ${s})`,Central:`rgba(16, 185, 129, ${s})`,South:`rgba(245, 158, 11, ${s})`})[e]||`rgba(107, 114, 128, ${s})`}function sr(e){return({North:"#2563eb",Central:"#059669",South:"#d97706"})[e]||"#6b7280"}function sn({areaFilter:e}){let[s,t]=(0,a.useState)(null),[r,n]=(0,a.useState)({}),[i,m]=(0,a.useState)({}),[x,h]=(0,a.useState)(null),[u,p]=(0,a.useState)(new Set),[j,g]=(0,a.useState)(!0),[b,N]=(0,a.useState)(new Set(["summary","routes"])),y=(0,a.useRef)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/miami-radical-reroute.json").then(e=>e.json()),fetch("/miami-zip-boundaries.json").then(e=>e.json()),fetch("/miami-kml-boundaries.json").then(e=>e.json()).catch(()=>[])]).then(([e,s,l])=>{t(e),n(s),m(l||[])})},[]);let v=(0,a.useCallback)(e=>{y.current=e},[]),C=e=>{N(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},k=e=>{p(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},S=(0,a.useMemo)(()=>{let e={};return Array.from(u).forEach((s,t)=>{e[s]=sl[t%sl.length]}),e},[u]),z=(0,a.useMemo)(()=>{if(!s)return[];let e={};return s.customers.forEach(s=>{s.zip&&s.assignedTerritory&&(e[s.zip]=s.assignedTerritory)}),Object.entries(e).map(([e,s])=>({zip:e,territory:s}))},[s]),T=(0,a.useMemo)(()=>s&&0!==u.size?s.customers.filter(e=>u.has(e.assignedRoute)):[],[s,u]),Z=(0,a.useMemo)(()=>s&&0!==u.size?s.routeSummary.filter(e=>u.has(e.routeKey)).map(e=>e.technician):[],[s,u]),A=(e,s)=>{if(0===e.length)return;let t=Object.keys(e[0]),l=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t??""}).join(","))].join("\n")],{type:"text/csv"}),a=URL.createObjectURL(l),r=document.createElement("a");r.href=a,r.download=s,r.click()};if(!s)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{children:"Loading radical reroute scenario..."})]})});let R=z.filter(s=>e[s.territory]);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border-purple-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"RADICAL REROUTE SCENARIO"}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"Optimized technician assignments targeting Min/Max pool counts while maximizing retained accounts. Two new hire positions assigned to fill gaps in Central and South territories."})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>C("summary"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(eI.Z,{className:"h-5 w-5 text-green-600"}),"Assignment Summary"]}),b.has("summary")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),b.has("summary")&&(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(s.summary.territorySummary).map(([e,s])=>(0,l.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:sa(e,.15)},children:[(0,l.jsx)("p",{className:"text-sm font-medium",style:{color:sr(e)},children:e}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.assigned}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["of ",s.target," capacity (",Math.round(s.assigned/s.target*100),"%)"]})]},e))}),(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-3 text-center",children:[(0,l.jsxs)("div",{className:"p-2 bg-green-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-xs text-green-600",children:"Kept"}),(0,l.jsx)("p",{className:"text-lg font-bold text-green-700",children:s.routeSummary.reduce((e,s)=>e+s.keptFromOriginal,0)})]}),(0,l.jsxs)("div",{className:"p-2 bg-amber-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-xs text-amber-600",children:"Reassigned"}),(0,l.jsx)("p",{className:"text-lg font-bold text-amber-700",children:s.routeSummary.filter(e=>!e.isNewHire).reduce((e,s)=>e+s.addedNew,0)})]}),(0,l.jsxs)("div",{className:"p-2 bg-purple-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-xs text-purple-600",children:"New Hire"}),(0,l.jsx)("p",{className:"text-lg font-bold text-purple-700",children:s.routeSummary.filter(e=>e.isNewHire).reduce((e,s)=>e+s.poolCount,0)})]}),(0,l.jsxs)("div",{className:"p-2 bg-red-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-xs text-red-600",children:"Floater Pool"}),(0,l.jsx)("p",{className:"text-lg font-bold text-red-700",children:s.floaterPool.length})]})]}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Floater Technicians:"})," ",s.floaterTechs.map(e=>e.name).join(", ")]})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Radical Reroute Territory Map"}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3 flex-wrap gap-2",children:[(0,l.jsx)("div",{className:"flex-1",children:u.size>0?(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,l.jsxs)("span",{className:"font-medium",children:[T.length," stops"]})," for ",u.size," technician",u.size>1?"s":"",":",(0,l.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:Z.map((e,s)=>(0,l.jsx)(d.C,{variant:"outline",className:"text-xs",style:{borderColor:sl[s%sl.length],color:sl[s%sl.length]},children:e},e))})]}):(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Click technician rows to view their routes (multi-select supported)"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(ep,{id:"showOutlines",checked:j,onCheckedChange:e=>g(!0===e)}),(0,l.jsx)("label",{htmlFor:"showOutlines",className:"text-sm cursor-pointer",children:"Territory Outlines"})]}),u.size>0&&(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{p(new Set),h(null)},children:[(0,l.jsx)(e4.Z,{className:"h-4 w-4 mr-1"})," Clear All"]})]})]}),(0,l.jsxs)(w.b6,{mapContainerStyle:ss,center:{lat:25.85,lng:-80.19},zoom:10,options:st,onLoad:v,children:[R.map(({zip:e,territory:s})=>{let t=r[e];if(!t?.geometry?.coordinates)return null;let a=t.geometry.coordinates[0].map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.Q8,{paths:a,options:{fillColor:sa(s,.25),fillOpacity:.25,strokeColor:sr(s),strokeOpacity:.5,strokeWeight:1}},e)}),j&&i.north&&(e.North||e.Central)&&(0,l.jsx)(w.dp,{path:i.north.map(e=>({lat:e.lat,lng:e.lng})),options:{strokeColor:"#1e40af",strokeOpacity:1,strokeWeight:4}},"outline-north"),j&&i.south&&(e.Central||e.South)&&(0,l.jsx)(w.dp,{path:i.south.map(e=>({lat:e.lat,lng:e.lng})),options:{strokeColor:"#92400e",strokeOpacity:1,strokeWeight:4}},"outline-south"),T.map(e=>{let s=S[e.assignedRoute]||"#6b7280";return(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:7,fillColor:s,fillOpacity:.9,strokeColor:"#fff",strokeWeight:2},onClick:()=>h(e.customerNumber)},e.customerNumber)}),x&&(()=>{let e=s.customers.find(e=>e.customerNumber===x);return e?(0,l.jsx)(w.kp,{position:{lat:e.latitude,lng:e.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[200px]",children:[(0,l.jsx)("p",{className:"font-bold",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:e.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:e.address}),(0,l.jsxs)("p",{className:"text-sm",children:[e.city," ",e.zip]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Original:"})," ",e.route]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Assigned:"})," ",e.assignedTech]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,l.jsx)("span",{style:{color:{kept:"#22c55e",reassigned:"#f59e0b","new-hire":"#8b5cf6",floater:"#ef4444"}[e.status]||"#6b7280"},children:e.status})]})]})]})}):null})()]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,l.jsx)("span",{className:"font-medium",children:"Status:"}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full bg-green-500"})," Kept"]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full bg-amber-500"})," Reassigned"]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full bg-purple-500"})," New Hire"]})]}),u.size>1&&(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Markers colored by technician"})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>C("routes"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"Technician Assignments (",s.routeSummary.length," routes)",u.size>0&&(0,l.jsxs)(d.C,{variant:"secondary",className:"ml-2",children:[u.size," selected"]})]}),b.has("routes")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),b.has("routes")&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Click rows to toggle selection (multi-select enabled)"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{className:"w-8"}),(0,l.jsx)(I.ss,{children:"Technician"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Territory"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Target"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Assigned"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Kept"}),(0,l.jsx)(I.ss,{className:"text-center",children:"New"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Status"})]})}),(0,l.jsx)(I.RM,{children:s.routeSummary.sort((e,s)=>{let t=["North","Central","South"];return t.indexOf(e.territory)-t.indexOf(s.territory)}).map(e=>{let s=u.has(e.routeKey),t=s?S[e.routeKey]:void 0;return(0,l.jsxs)(I.SC,{className:`cursor-pointer transition-colors ${s?"bg-blue-50":e.isNewHire?"bg-purple-50/50":"hover:bg-slate-50"}`,onClick:()=>k(e.routeKey),children:[(0,l.jsx)(I.pj,{className:"w-8",children:s&&(0,l.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow",style:{backgroundColor:t}})}),(0,l.jsx)(I.pj,{children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,l.jsx)(e5.Z,{className:"h-4 w-4 text-blue-600"}),e.isNewHire&&(0,l.jsx)(se.Z,{className:"h-4 w-4 text-purple-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.technician}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Route ",e.route]})]})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",style:{backgroundColor:sa(e.territory,.2),borderColor:sr(e.territory),color:sr(e.territory)},children:e.territory})}),(0,l.jsx)(I.pj,{className:"text-center text-sm",children:e.min&&e.max?`${e.min}-${e.max}`:"-"}),(0,l.jsx)(I.pj,{className:"text-center font-semibold",children:e.poolCount}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)("span",{className:"text-green-600",children:e.keptFromOriginal})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)("span",{className:e.isNewHire?"text-purple-600":"text-amber-600",children:e.addedNew})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.meetsTarget?(0,l.jsx)(eI.Z,{className:"h-4 w-4 text-green-600 mx-auto"}):(0,l.jsx)(eD.Z,{className:"h-4 w-4 text-amber-600 mx-auto"})})]},e.routeKey)})})]})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Export Data"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.customers,"radical-reroute-all-assignments.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"All Assignments (",s.customers.length,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.customers.filter(e=>"reassigned"===e.status||"new-hire"===e.status),"radical-reroute-changes.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Changes Only"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(s.routeSummary,"radical-reroute-summary.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Route Summary"]}),u.size>0&&(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(T,"radical-reroute-selected-techs.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Selected Techs (",T.length,")"]})]})]})})]})}var si=t(1047);let so={width:"100%",height:"550px"},sc={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0},sd={"11 AFP Route Honatann B":"#3b82f6","14 AFP Route Jorge A":"#ef4444","15 AFP Route Kymani P":"#22c55e","2 AFP Route William A":"#f59e0b","22 AFP Route Ramon R":"#8b5cf6","23 AFP Route Juan C":"#ec4899","25 AFP Route Carlos S":"#06b6d4","28 AFP Route Jean D":"#84cc16","8 AFP Route Spartacus P":"#f97316",Unassigned:"#6b7280"},sm={Monday:"#3b82f6",Tuesday:"#22c55e",Wednesday:"#f59e0b",Thursday:"#8b5cf6",Friday:"#ef4444",Saturday:"#06b6d4",Sunday:"#ec4899",Unknown:"#6b7280"};function sx(e){return sd[e]||"#6b7280"}function sh(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(new Set),[m,x]=(0,a.useState)(new Set),[h,u]=(0,a.useState)(new Set(["filters","accounts"])),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{fetch("/miami-commercial-routes.json").then(e=>e.json()).then(e=>s(e))},[]);let g=(0,a.useCallback)(e=>{j.current=e},[]),b=e=>{u(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},N=(0,a.useMemo)(()=>[...new Set(e.map(e=>e.route))].sort((e,s)=>"Unassigned"===e?1:"Unassigned"===s?-1:e.localeCompare(s)),[e]),y=(0,a.useMemo)(()=>{let s=new Set;return e.forEach(e=>e.days.forEach(e=>s.add(e))),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Unknown"].filter(e=>s.has(e))},[e]),v=e=>{i(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},k=e=>{x(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},S=(0,a.useMemo)(()=>{let s=e;return n.size>0&&(s=s.filter(e=>n.has(e.route))),m.size>0&&(s=s.filter(e=>e.days.some(e=>m.has(e)))),s},[e,n,m]),z=(0,a.useMemo)(()=>{let e={},s={},t=0;return S.forEach(l=>{e[l.route]=(e[l.route]||0)+1,l.days.forEach(e=>{s[e]=(s[e]||0)+1}),t+=l.monthlyPrice||0}),{routeCounts:e,dayCounts:s,totalRevenue:t}},[S]),T=(e,s)=>{if(0===e.length)return;let t=["customerNumber","accountName","address","city","state","zip","route","routeTech","daysOfServiceRaw","monthlyPrice","oldTerritory"],l=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t??""}).join(","))].join("\n")],{type:"text/csv"}),a=URL.createObjectURL(l),r=document.createElement("a");r.href=a,r.download=s,r.click()};if(0===e.length)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{children:"Loading commercial routes..."})]})});let Z=n.size>0||m.size>0;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-emerald-50 to-teal-50 border-emerald-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-2 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-6 w-6 text-emerald-600"}),"MIAMI COMMERCIAL ROUTES"]}),(0,l.jsxs)("p",{className:"text-sm text-slate-600",children:[e.length," commercial pools across ",N.length," routes. Filter by route and/or day of service to view specific assignments."]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>b("filters"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(C.Z,{className:"h-5 w-5 text-slate-600"}),"Filters",Z&&(0,l.jsxs)(d.C,{variant:"secondary",className:"ml-2",children:[n.size>0&&`${n.size} routes`,n.size>0&&m.size>0&&", ",m.size>0&&`${m.size} days`]})]}),h.has("filters")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),h.has("filters")&&(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4"})," Filter by Route"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>{i(new Set(N))},className:"text-xs h-7",children:"Select All"}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>i(new Set),className:"text-xs h-7",children:"Clear"})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:N.map(s=>{let t=n.has(s),a=e.filter(e=>e.route===s).length;return(0,l.jsxs)(d.C,{variant:t?"default":"outline",className:"cursor-pointer transition-all px-3 py-1",style:{backgroundColor:t?sx(s):"transparent",borderColor:sx(s),color:t?"white":sx(s)},onClick:()=>v(s),children:["Unassigned"===s?"Unassigned":s.replace(/^\d+\s+AFP\s+Route\s+/,"")," (",a,")"]},s)})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,l.jsx)(si.Z,{className:"h-4 w-4"})," Filter by Day of Service"]}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>x(new Set),className:"text-xs h-7",children:"Clear"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map(s=>{let t=m.has(s),a=e.filter(e=>e.days.includes(s)).length;return(0,l.jsxs)(d.C,{variant:t?"default":"outline",className:"cursor-pointer transition-all px-3 py-1",style:{backgroundColor:t?sm[s]:"transparent",borderColor:sm[s],color:t?"white":sm[s]},onClick:()=>k(s),children:[s," (",a,")"]},s)})})]}),Z&&(0,l.jsx)("div",{className:"pt-2 border-t",children:(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>{i(new Set),x(new Set),r(null)},children:[(0,l.jsx)(e4.Z,{className:"h-4 w-4 mr-2"})," Clear All Filters"]})})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:S.length}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pools Shown"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["$",z.totalRevenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monthly Revenue"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(z.routeCounts).length}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Routes"})]})})]}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Commercial Pool Locations"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:Z?`Showing ${S.length} pools matching filters`:"Select routes and/or days above to filter the map"}),(0,l.jsxs)(w.b6,{mapContainerStyle:so,center:{lat:25.82,lng:-80.2},zoom:10,options:sc,onLoad:g,children:[S.map(e=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:sx(e.route),fillOpacity:.9,strokeColor:"#fff",strokeWeight:2},onClick:()=>r(e.customerNumber)},e.customerNumber)),t&&(()=>{let s=e.find(e=>e.customerNumber===t);return s?(0,l.jsx)(w.kp,{position:{lat:s.latitude,lng:s.longitude},onCloseClick:()=>r(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[220px]",children:[(0,l.jsx)("p",{className:"font-bold text-sm",children:s.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:s.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:s.address}),(0,l.jsxs)("p",{className:"text-sm",children:[s.city,", ",s.state," ",s.zip]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Route:"})," ",(0,l.jsx)("span",{style:{color:sx(s.route)},children:s.routeTech})]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Days:"})," ",s.days.join(", ")]}),s.monthlyPrice>0&&(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Monthly:"})," ","$",s.monthlyPrice.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})}):null})()]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3 text-xs",children:[(0,l.jsx)("span",{className:"font-medium",children:"Routes:"}),N.filter(e=>"Unassigned"!==e).slice(0,6).map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:sx(e)}}),e.replace(/^\d+\s+AFP\s+Route\s+/,"")]},e)),N.length>6&&(0,l.jsxs)("span",{className:"text-muted-foreground",children:["+",N.length-6," more"]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>b("accounts"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5"}),"Account List (",S.length,")"]}),h.has("accounts")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),h.has("accounts")&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{className:"sticky top-0 bg-white z-10",children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Property"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Route"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Days"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly"})]})}),(0,l.jsx)(I.RM,{children:S.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-slate-50",onClick:()=>{r(e.customerNumber),j.current&&(j.current.panTo({lat:e.latitude,lng:e.longitude}),j.current.setZoom(14))},children:[(0,l.jsx)(I.pj,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]})}),(0,l.jsxs)(I.pj,{className:"text-sm",children:[e.address,", ",e.city]}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",className:"text-xs",style:{borderColor:sx(e.route),color:sx(e.route)},children:e.routeTech})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-1 justify-center",children:e.days.map(e=>(0,l.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{backgroundColor:sm[e]+"20",color:sm[e]},children:e.substring(0,3)},e))})}),(0,l.jsx)(I.pj,{className:"text-right text-sm",children:e.monthlyPrice>0?`$${e.monthlyPrice.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"})]},e.customerNumber))})]})})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Export Data"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>T(S,"miami-commercial-filtered.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Filtered (",S.length,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>T(e,"miami-commercial-all.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export All (",e.length,")"]})]})]})})]})}let su={width:"100%",height:"550px"},sf={styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0},sp={"15 AFP Route Kymani P":"#22c55e","22 AFP Route Ramon R":"#8b5cf6","23 AFP Route Juan C":"#ec4899","25 AFP Route Carlos S":"#06b6d4"},sj={Monday:"#3b82f6",Tuesday:"#22c55e",Wednesday:"#f59e0b",Thursday:"#8b5cf6",Friday:"#ef4444",Saturday:"#06b6d4",Sunday:"#ec4899",Unknown:"#6b7280"};function sg(e){return sp[e]||"#6b7280"}function sb(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(new Set),[m,x]=(0,a.useState)(new Set),[h,u]=(0,a.useState)(!1),[j,g]=(0,a.useState)(new Set(["summary","filters","accounts"])),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{fetch("/miami-future-commercial-routes.json").then(e=>e.json()).then(e=>s(e))},[]);let N=(0,a.useCallback)(e=>{b.current=e},[]),y=e=>{g(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},v=(0,a.useMemo)(()=>[...new Set(e.map(e=>e.route))].sort(),[e]),k=(0,a.useMemo)(()=>{let s=new Set;return e.forEach(e=>e.days.forEach(e=>s.add(e))),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Unknown"].filter(e=>s.has(e))},[e]),S=e=>{i(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},z=e=>{x(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},T=(0,a.useMemo)(()=>{let s=e;return n.size>0&&(s=s.filter(e=>n.has(e.route))),m.size>0&&(s=s.filter(e=>e.days.some(e=>m.has(e)))),h&&(s=s.filter(e=>e.reassigned)),s},[e,n,m,h]),Z=(0,a.useMemo)(()=>{let s={},t=0,l=0;return e.forEach(e=>{s[e.route]||(s[e.route]={total:0,kept:0,added:0}),s[e.route].total++,e.reassigned?(s[e.route].added++,l++):s[e.route].kept++,t+=e.monthlyPrice||0}),{routeCounts:s,totalRevenue:t,totalReassigned:l}},[e]),A=(e,s)=>{if(0===e.length)return;let t=["customerNumber","accountName","address","city","state","zip","route","routeTech","daysOfServiceRaw","monthlyPrice","reassigned","originalRoute","originalTech"],l=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t??""}).join(","))].join("\n")],{type:"text/csv"}),a=URL.createObjectURL(l),r=document.createElement("a");r.href=a,r.download=s,r.click()};if(0===e.length)return(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{children:"Loading future commercial routes..."})]})});let R=n.size>0||m.size>0||h;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(o.Zb,{className:"bg-gradient-to-r from-amber-50 to-orange-50 border-amber-200",children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-2 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-6 w-6 text-amber-600"}),"FUTURE COMMERCIAL ROUTES"]}),(0,l.jsxs)("p",{className:"text-sm text-slate-600",children:["Consolidated routes for ",e.length," commercial pools across 4 technicians. All pools reassigned from other techs while maintaining geographic efficiency."]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y("summary"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5"}),"Technician Summary"]}),j.has("summary")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),j.has("summary")&&(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4",children:v.map(e=>{let s=Z.routeCounts[e],t=e.replace(/^\d+\s+AFP\s+Route\s+/,"");return(0,l.jsx)(o.Zb,{className:"cursor-pointer hover:shadow-md transition-shadow",style:{borderColor:sg(e),borderWidth:2},onClick:()=>{i(new Set([e])),u(!1)},children:(0,l.jsxs)(o.aY,{className:"p-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:sg(e)}}),(0,l.jsx)("span",{className:"font-semibold text-sm",children:t})]}),(0,l.jsx)("p",{className:"text-2xl font-bold",style:{color:sg(e)},children:s?.total||0}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[(0,l.jsxs)("span",{className:"text-green-600",children:[s?.kept||0," kept"]})," \xb7 ",(0,l.jsxs)("span",{className:"text-amber-600",children:["+",s?.added||0," added"]})]})]})},e)})})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:e.length}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Pools"})]})}),(0,l.jsx)(o.Zb,{className:"cursor-pointer hover:bg-slate-50",onClick:()=>u(!h),children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:Z.totalReassigned}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Reassigned"}),h&&(0,l.jsx)(d.C,{className:"mt-1 bg-orange-100 text-orange-700",children:"Filtered"})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["$",Z.totalRevenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monthly Revenue"})]})})]}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y("filters"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(C.Z,{className:"h-5 w-5 text-slate-600"}),"Filters",R&&(0,l.jsx)(d.C,{variant:"secondary",className:"ml-2",children:"Active"})]}),j.has("filters")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),j.has("filters")&&(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4"})," Filter by Technician"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>i(new Set(v)),className:"text-xs h-7",children:"Select All"}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>i(new Set),className:"text-xs h-7",children:"Clear"})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map(e=>{let s=n.has(e),t=e.replace(/^\d+\s+AFP\s+Route\s+/,""),a=Z.routeCounts[e]?.total||0;return(0,l.jsxs)(d.C,{variant:s?"default":"outline",className:"cursor-pointer transition-all px-3 py-1",style:{backgroundColor:s?sg(e):"transparent",borderColor:sg(e),color:s?"white":sg(e)},onClick:()=>S(e),children:[t," (",a,")"]},e)})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,l.jsx)(si.Z,{className:"h-4 w-4"})," Filter by Day"]}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>x(new Set),className:"text-xs h-7",children:"Clear"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:k.map(s=>{let t=m.has(s),a=e.filter(e=>e.days.includes(s)).length;return(0,l.jsxs)(d.C,{variant:t?"default":"outline",className:"cursor-pointer transition-all px-3 py-1",style:{backgroundColor:t?sj[s]:"transparent",borderColor:sj[s],color:t?"white":sj[s]},onClick:()=>z(s),children:[s," (",a,")"]},s)})})]}),R&&(0,l.jsx)("div",{className:"pt-2 border-t",children:(0,l.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>{i(new Set),x(new Set),u(!1),r(null)},children:"Clear All Filters"})})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Pool Locations"}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Showing ",T.length," pools",h&&" (reassigned only)"]}),(0,l.jsxs)(w.b6,{mapContainerStyle:su,center:{lat:25.82,lng:-80.2},zoom:10,options:sf,onLoad:N,children:[T.map(e=>(0,l.jsx)(w.jC,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:e.reassigned?10:8,fillColor:sg(e.route),fillOpacity:.9,strokeColor:e.reassigned?"#f59e0b":"#fff",strokeWeight:e.reassigned?3:2},onClick:()=>r(e.customerNumber)},e.customerNumber)),t&&(()=>{let s=e.find(e=>e.customerNumber===t);return s?(0,l.jsx)(w.kp,{position:{lat:s.latitude,lng:s.longitude},onCloseClick:()=>r(null),children:(0,l.jsxs)("div",{className:"p-2 min-w-[240px]",children:[(0,l.jsx)("p",{className:"font-bold text-sm",children:s.accountName}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:s.customerNumber}),(0,l.jsx)("p",{className:"text-sm mt-1",children:s.address}),(0,l.jsxs)("p",{className:"text-sm",children:[s.city,", ",s.state," ",s.zip]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Tech:"})," ",(0,l.jsx)("span",{style:{color:sg(s.route)},children:s.routeTech})]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Days:"})," ",s.days.join(", ")]}),s.monthlyPrice>0&&(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Monthly:"})," ","$",s.monthlyPrice.toLocaleString(void 0,{minimumFractionDigits:2})]}),s.reassigned&&(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,l.jsx)(d.C,{className:"bg-amber-100 text-amber-700",children:"Reassigned"}),(0,l.jsxs)("p",{className:"text-xs mt-1 text-gray-600",children:["From: ",s.originalTech]})]})]})]})}):null})()]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mt-3 text-xs",children:[(0,l.jsx)("span",{className:"font-medium",children:"Technicians:"}),v.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:sg(e)}}),e.replace(/^\d+\s+AFP\s+Route\s+/,"")]},e)),(0,l.jsx)("span",{className:"text-muted-foreground",children:"|"}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full border-2 border-amber-500 bg-gray-300"}),"Reassigned (amber border)"]})]})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y("accounts"),children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5"}),"Account List (",T.length,")"]}),j.has("accounts")?(0,l.jsx)(eP.Z,{className:"h-5 w-5"}):(0,l.jsx)(eE.Z,{className:"h-5 w-5"})]}),j.has("accounts")&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{className:"sticky top-0 bg-white z-10",children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Property"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Tech"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Days"}),(0,l.jsx)(I.ss,{className:"text-center",children:"Status"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly"})]})}),(0,l.jsx)(I.RM,{children:T.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-slate-50",onClick:()=>{r(e.customerNumber),b.current&&(b.current.panTo({lat:e.latitude,lng:e.longitude}),b.current.setZoom(14))},children:[(0,l.jsx)(I.pj,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.accountName}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.customerNumber})]})}),(0,l.jsxs)(I.pj,{className:"text-sm",children:[e.address,", ",e.city]}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsx)(d.C,{variant:"outline",className:"text-xs",style:{borderColor:sg(e.route),color:sg(e.route)},children:e.routeTech})}),(0,l.jsx)(I.pj,{className:"text-center",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-1 justify-center",children:[e.days.slice(0,3).map(e=>(0,l.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{backgroundColor:sj[e]+"20",color:sj[e]},children:e.substring(0,3)},e)),e.days.length>3&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground",children:["+",e.days.length-3]})]})}),(0,l.jsx)(I.pj,{className:"text-center",children:e.reassigned?(0,l.jsx)("div",{className:"text-xs",children:(0,l.jsxs)(d.C,{className:"bg-amber-100 text-amber-700 text-[10px]",children:[(0,l.jsx)(eV.Z,{className:"h-3 w-3 mr-1"}),"From ",e.originalTech]})}):(0,l.jsx)(eI.Z,{className:"h-4 w-4 text-green-500 mx-auto"})}),(0,l.jsx)(I.pj,{className:"text-right text-sm",children:e.monthlyPrice>0?`$${e.monthlyPrice.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"})]},e.customerNumber))})]})})})]})}),(0,l.jsx)(o.Zb,{children:(0,l.jsxs)(o.aY,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Export Data"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(T,"miami-future-commercial-filtered.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Filtered (",T.length,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(e.filter(e=>e.reassigned),"miami-future-commercial-reassigned.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export Reassigned (",Z.totalReassigned,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>A(e,"miami-future-commercial-all.csv"),children:[(0,l.jsx)(eh.Z,{className:"h-4 w-4 mr-2"}),"Export All (",e.length,")"]})]})]})})]})}let sN={width:"100%",height:"600px"},sy={lat:30.3322,lng:-81.6557},sv={disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},sC=e=>({"JAX - Maint Ponte Vedra":"#06b6d4","JAX - Maint Jacksonville":"#2563eb","JAX - Maint St. Augustine":"#14b8a6","JAX - Maint St. Johns":"#10b981","JAX - Maint Nocatee":"#84cc16","JAX - Maint Beaches":"#0ea5e9","JAX - Maint Outskirts":"#6366f1","JAX - Comm Maint":"#8b5cf6"})[e]||"#6b7280",sw=e=>0===e?"#f3f4f6":e<1e3?"#fef3c7":e<3e3?"#fde68a":e<5e3?"#fcd34d":e<8e3?"#fbbf24":e<12e3?"#f59e0b":"#d97706";function sk(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)({}),[n,i]=(0,a.useState)(!0),[x,h]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),[p,j]=(0,a.useState)(null),[g,N]=(0,a.useState)({}),[y,v]=(0,a.useState)("none");(0,a.useEffect)(()=>{Promise.all([fetch("/jacksonville-zip-revenue-data.json").then(e=>e.json()),fetch("/jacksonville-zip-boundaries.json").then(e=>e.json())]).then(([e,t])=>{s(e),r(t);let l=[...new Set(e.map(e=>e.territory))],a={};l.forEach(e=>a[e]=!0),N(a),i(!1)}).catch(e=>{console.error("Error loading data:",e),h("Failed to load Jacksonville revenue data"),i(!1)})},[]);let C=(0,a.useCallback)(e=>{N(s=>({...s,[e]:!s[e]}))},[]),k=(0,a.useMemo)(()=>e.filter(e=>g[e.territory]),[e,g]),S=(0,a.useMemo)(()=>u&&e.find(e=>e.zip===u)||null,[u,e]),z=(0,a.useMemo)(()=>{if(!S||!S.accounts)return[];let e=[...S.accounts];return"asc"===y?e.sort((e,s)=>e.monthlyPrice-s.monthlyPrice):"desc"===y?e.sort((e,s)=>s.monthlyPrice-e.monthlyPrice):e},[S,y]),T=(0,a.useMemo)(()=>{let e={};return k.forEach(s=>{e[s.territory]||(e[s.territory]={count:0,avgResidentialPrice:0,residentialCount:0,totalResidentialRevenue:0}),e[s.territory].count+=s.accountCount,s.accounts.forEach(t=>{"Residential"===t.accountType&&(e[s.territory].residentialCount+=1,e[s.territory].totalResidentialRevenue+=t.monthlyPrice)})}),Object.keys(e).forEach(s=>{e[s].residentialCount>0&&(e[s].avgResidentialPrice=e[s].totalResidentialRevenue/e[s].residentialCount)}),e},[k]),Z=(0,a.useCallback)(e=>{f(e),v("none")},[]),A=(0,a.useCallback)(()=>{v(e=>"none"===e?"desc":"desc"===e?"asc":"none")},[]);return n?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsx)("span",{className:"ml-3",children:"Loading Jacksonville revenue data..."})]})}):x?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:x})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Territory Filters"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.keys(g).map(e=>{let s=T[e]||{count:0,avgResidentialPrice:0,residentialCount:0,totalResidentialRevenue:0};return(0,l.jsxs)(c.z,{variant:g[e]?"default":"outline",size:"sm",onClick:()=>C(e),style:{backgroundColor:g[e]?sC(e):void 0,borderColor:sC(e),color:g[e]?"#ffffff":sC(e)},className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:e}),(0,l.jsxs)(d.C,{variant:"secondary",className:"ml-1",children:[s.count," accounts"]}),(0,l.jsxs)(d.C,{variant:"secondary",children:["Avg: $",s.avgResidentialPrice.toFixed(2)]})]},e)})})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-5 h-5"}),"Revenue by ZIP Code"]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sN,center:sy,zoom:10,options:sv,children:[k.map(e=>{let s=t[e.zip];return s&&s.coordinates?("MultiPolygon"===s.type?s.coordinates:[s.coordinates]).map((t,a)=>{let r=(s.type,t[0]).map(e=>({lat:e[1],lng:e[0]})),n=u===e.zip,i=p===e.zip;return(0,l.jsx)(w.mg,{paths:r,options:{fillColor:sw(e.totalRevenue),fillOpacity:n?.8:i?.6:.5,strokeColor:n?"#000000":sC(e.territory),strokeOpacity:.9,strokeWeight:n?3:2,clickable:!0},onClick:()=>Z(e.zip),onMouseOver:()=>j(e.zip),onMouseOut:()=>j(null)},`${e.zip}-${a}`)}):null}),S&&(0,l.jsx)(w.nx,{position:{lat:e.find(e=>e.zip===u)?.accounts[0]?.latitude||sy.lat,lng:e.find(e=>e.zip===u)?.accounts[0]?.longitude||sy.lng},onCloseClick:()=>f(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("h4",{className:"font-semibold text-lg",children:["ZIP ",S.zip]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:S.city}),(0,l.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",S.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Accounts:"})," ",S.accountCount]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Monthly Revenue:"})," $",S.totalRevenue.toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Yearly Revenue:"})," $",(12*S.totalRevenue).toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Avg Price/Account:"})," $",S.accountCount>0?(S.totalRevenue/S.accountCount).toFixed(2):"0.00"]})]})]})})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-4 flex-wrap",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Monthly Revenue:"}),[{label:"$0",color:"#f3f4f6"},{label:"<$1k",color:"#fef3c7"},{label:"$1k-$3k",color:"#fde68a"},{label:"$3k-$5k",color:"#fcd34d"},{label:"$5k-$8k",color:"#fbbf24"},{label:"$8k-$12k",color:"#f59e0b"},{label:">$12k",color:"#d97706"}].map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"w-4 h-4 border border-gray-300 rounded",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"text-xs",children:e.label})]},e.label))]})]}),S&&S.accounts.length>0&&(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(b.Z,{className:"w-5 h-5"}),"Accounts in ZIP ",S.zip," (",z.length,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:A,className:"flex items-center gap-2",children:[(0,l.jsx)(B.Z,{className:"w-4 h-4"}),"Sort by Price","desc"===y&&" (High to Low)","asc"===y&&" (Low to High)","none"===y&&" (Default)"]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Type"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Yearly Price"})]})}),(0,l.jsx)(I.RM,{children:z.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.customerName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"Commercial"===e.accountType?"default":"secondary",children:e.accountType})}),(0,l.jsx)(I.pj,{children:(0,l.jsx)("div",{className:"inline-block px-2 py-1 rounded text-xs text-white",style:{backgroundColor:sC(e.territory)},children:e.territory})}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold",children:["$",e.monthlyPrice.toFixed(2)]}),(0,l.jsxs)(I.pj,{className:"text-right",children:["$",e.yearlyPrice.toFixed(2)]})]},e.customerNumber))})]})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"font-semibold",children:["Total for ZIP ",S.zip,":"]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Monthly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",S.totalRevenue.toLocaleString()]})]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Yearly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",(12*S.totalRevenue).toLocaleString()]})]})]})]})})]})]})}let sS={width:"100%",height:"600px"},sz={lat:30.3322,lng:-81.6557},sT={disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]};function sZ(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(!0),[n,i]=(0,a.useState)(null),[c,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetch("/jacksonville-commercial-accounts.json").then(e=>e.json()).then(e=>{s(e),r(!1)}).catch(e=>{console.error("Error loading commercial accounts:",e),i("Failed to load Jacksonville commercial accounts"),r(!1)})},[]);let f=(0,a.useCallback)(e=>{x(e)},[]),j=e.reduce((e,s)=>e+s.monthlyPrice,0),g=12*j;return t?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsx)("span",{className:"ml-3",children:"Loading Jacksonville commercial accounts..."})]})}):n?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:n})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(p.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Total Accounts"})]}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:e.length})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(b.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Monthly Revenue"})]}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",j.toLocaleString()]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(b.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Yearly Revenue"})]}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",g.toLocaleString()]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(m.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Unique ZIPs"})]}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:[...new Set(e.map(e=>e.zip))].length})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"w-5 h-5"}),"Commercial Accounts Map"]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sS,center:sz,zoom:10,options:sT,children:[e.map(e=>(0,l.jsx)(w.Jx,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:h===e.customerNumber?12:8,fillColor:"#8b5cf6",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2},onClick:()=>f(e),onMouseOver:()=>u(e.customerNumber),onMouseOut:()=>u(null)},e.customerNumber)),c&&(0,l.jsx)(w.nx,{position:{lat:c.latitude,lng:c.longitude},onCloseClick:()=>x(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h4",{className:"font-semibold text-lg",children:c.customerName}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:c.customerNumber}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Address:"})," ",c.address]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"City:"})," ",c.city,", ",c.state," ",c.zip]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",c.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Technician:"})," ",c.technician]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Service Day:"})," ",c.dayOfWeek]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t",children:[(0,l.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:["Monthly: $",c.monthlyPrice.toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Yearly: $",c.yearlyPrice.toLocaleString()]})]})]})]})})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"w-5 h-5"}),"All Commercial Accounts (",e.length,")"]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"City"}),(0,l.jsx)(I.ss,{children:"ZIP"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{children:"Technician"}),(0,l.jsx)(I.ss,{children:"Service Day"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Yearly Price"})]})}),(0,l.jsx)(I.RM,{children:e.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>f(e),children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.customerName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:e.zip}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"default",className:"bg-violet-500",children:e.territory})}),(0,l.jsx)(I.pj,{children:e.technician}),(0,l.jsx)(I.pj,{children:e.dayOfWeek}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold text-green-600",children:["$",e.monthlyPrice.toFixed(2)]}),(0,l.jsxs)(I.pj,{className:"text-right",children:["$",e.yearlyPrice.toFixed(2)]})]},e.customerNumber))})]})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Total Commercial Revenue:"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Monthly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",j.toLocaleString()]})]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Yearly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",g.toLocaleString()]})]})]})]})})]})]})}let sA={width:"100%",height:"600px"},sR={lat:30.3322,lng:-81.6557},sP={disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},sE=e=>({"JAX - Maint Ponte Vedra":"#06b6d4","JAX - Maint Jacksonville":"#2563eb","JAX - Maint St. Augustine":"#14b8a6","JAX - Maint St. Johns":"#10b981","JAX - Maint Nocatee":"#84cc16","JAX - Maint Beaches":"#0ea5e9","JAX - Maint Outskirts":"#6366f1","JAX - Comm Maint":"#8b5cf6"})[e]||"#6b7280",sF=e=>({Monday:"#3b82f6",Tuesday:"#10b981",Wednesday:"#f59e0b",Thursday:"#ec4899",Friday:"#8b5cf6",Saturday:"#06b6d4",Sunday:"#ef4444"})[e]||"#6b7280";function sM(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)({}),[n,i]=(0,a.useState)(!0),[c,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(""),[p,j]=(0,a.useState)("all"),[g,b]=(0,a.useState)(null),[N,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{Promise.all([fetch("/jacksonville-route-assignments.json").then(e=>e.json()),fetch("/jacksonville-zip-boundaries.json").then(e=>e.json())]).then(([e,t])=>{s(e),r(t),i(!1)}).catch(e=>{console.error("Error loading routes:",e),x("Failed to load Jacksonville route data"),i(!1)})},[]);let v=(0,a.useMemo)(()=>{let s={};return e.forEach(e=>{s[e.technician]||(s[e.technician]={count:0,territories:new Set}),s[e.technician].count++,s[e.technician].territories.add(e.territory)}),Object.entries(s).map(([e,s])=>({name:e,count:s.count,territories:Array.from(s.territories)})).sort((e,s)=>s.count-e.count)},[e]),C=(0,a.useMemo)(()=>{let s=["Monday","Tuesday","Wednesday","Thursday","Friday","Sunday"];return["all",...Array.from(new Set(e.map(e=>e.dayOfWeek))).filter(Boolean).sort((e,t)=>s.indexOf(e)-s.indexOf(t))]},[e]),k=(0,a.useMemo)(()=>{let s=e;return h&&(s=s.filter(e=>e.technician===h)),p&&"all"!==p&&(s=s.filter(e=>e.dayOfWeek===p)),s},[e,h,p]),S=(0,a.useMemo)(()=>[...new Set(k.map(e=>e.zip))],[k]),z=(0,a.useMemo)(()=>{let e={},s={};return k.forEach(t=>{e[t.dayOfWeek]=(e[t.dayOfWeek]||0)+1,s[t.territory]=(s[t.territory]||0)+1}),{dayStats:e,territoryStats:s}},[k]),T=(0,a.useCallback)(e=>{b(e)},[]);return n?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsx)("span",{className:"ml-3",children:"Loading Jacksonville routes..."})]})}):c?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:c})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(f.Z,{className:"w-5 h-5"}),"Route Filters"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Select Technician"}),(0,l.jsxs)(K.Ph,{value:h,onValueChange:u,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{placeholder:"Select technician..."})}),(0,l.jsx)(K.Bw,{children:v.map(e=>(0,l.jsxs)(K.Ql,{value:e.name,children:[e.name," (",e.count," stops) → ",e.territories.join(", ")]},e.name))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Service Day"}),(0,l.jsxs)(K.Ph,{value:p,onValueChange:j,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{placeholder:"Select day..."})}),(0,l.jsx)(K.Bw,{children:C.map(e=>(0,l.jsx)(K.Ql,{value:e,children:"all"===e?"All Days":e},e))})]})]})]}),h&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Showing:"})," ",k.length," stops","all"!==p&&` on ${p}`]})})]}),h&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Stops"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:k.length})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Unique ZIPs"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:S.length})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Territories"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:Object.keys(z.territoryStats).length})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Service Days"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:Object.keys(z.dayStats).length})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-5 h-5"}),"Route Map - ",h]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sA,center:sR,zoom:10,options:sP,children:[S.map(e=>{let s=t[e];if(!s||!s.coordinates)return null;let a="MultiPolygon"===s.type?s.coordinates:[s.coordinates],r=k.filter(s=>s.zip===e),n=r[0]?.territory;return a.map((t,a)=>{let r=(s.type,t[0]).map(e=>({lat:e[1],lng:e[0]}));return(0,l.jsx)(w.mg,{paths:r,options:{fillColor:sE(n),fillOpacity:.2,strokeColor:sE(n),strokeOpacity:.6,strokeWeight:2,clickable:!1}},`${e}-${a}`)})}),k.map(e=>(0,l.jsx)(w.Jx,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:N===e.customerNumber?10:7,fillColor:"Commercial"===e.accountType?"#8b5cf6":sF(e.dayOfWeek),fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2},onClick:()=>T(e),onMouseOver:()=>y(e.customerNumber),onMouseOut:()=>y(null)},e.customerNumber)),g&&(0,l.jsx)(w.nx,{position:{lat:g.latitude,lng:g.longitude},onCloseClick:()=>b(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h4",{className:"font-semibold text-lg",children:g.customerName}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:g.customerNumber}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Address:"})," ",g.address]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"City:"})," ",g.city,", ",g.zip]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Type:"})," ",(0,l.jsx)(d.C,{variant:"Commercial"===g.accountType?"default":"secondary",children:g.accountType})]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",g.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Service Day:"})," ",g.dayOfWeek]}),(0,l.jsx)("div",{className:"mt-2 pt-2 border-t",children:(0,l.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:["Monthly: $",g.monthlyPrice.toFixed(2)]})})]})]})})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-4 flex-wrap",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Service Days:"}),Object.entries(z.dayStats).map(([e,s])=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-white",style:{backgroundColor:sF(e)}}),(0,l.jsxs)("span",{className:"text-xs",children:[e," (",s,")"]})]},e)),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-white",style:{backgroundColor:"#8b5cf6"}}),(0,l.jsx)("span",{className:"text-xs",children:"Commercial"})]})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(si.Z,{className:"w-5 h-5"}),"Route Details (",k.length," stops)"]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"City"}),(0,l.jsx)(I.ss,{children:"ZIP"}),(0,l.jsx)(I.ss,{children:"Type"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{children:"Day"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"})]})}),(0,l.jsx)(I.RM,{children:k.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>T(e),children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.customerName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:e.zip}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"Commercial"===e.accountType?"default":"secondary",children:e.accountType})}),(0,l.jsx)(I.pj,{children:(0,l.jsx)("div",{className:"inline-block px-2 py-1 rounded text-xs text-white",style:{backgroundColor:sE(e.territory)},children:e.territory})}),(0,l.jsx)(I.pj,{children:(0,l.jsx)("div",{className:"inline-block px-2 py-1 rounded text-xs text-white",style:{backgroundColor:sF(e.dayOfWeek)},children:e.dayOfWeek})}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold text-green-600",children:["$",e.monthlyPrice.toFixed(2)]})]},e.customerNumber))})]})})]})]}),!h&&(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center text-gray-500",children:[(0,l.jsx)(f.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,l.jsx)("p",{children:"Please select a technician to view their routes"})]})})]})}let s$={dallas:{name:"Dallas",center:{lat:32.7767,lng:-96.797},zoom:10},orlando:{name:"Orlando",center:{lat:28.5383,lng:-81.3792},zoom:10},portCharlotte:{name:"Port Charlotte",center:{lat:26.9762,lng:-82.0909},zoom:11},miami:{name:"Miami",center:{lat:25.7617,lng:-80.1918},zoom:10},jacksonville:{name:"Jacksonville",center:{lat:30.3322,lng:-81.6557},zoom:10}},sO={width:"100%",height:"600px"},sL={disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]};function sD({location:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),j=s$[e];(0,a.useEffect)(()=>{fetch(`/${e}-commercial-accounts.json`).then(e=>e.json()).then(e=>{t(e),n(!1)}).catch(e=>{console.error("Error loading commercial accounts:",e),c(`Failed to load ${j.name} commercial accounts`),n(!1)})},[e,j.name]);let g=(0,a.useCallback)(e=>{h(e)},[]),N=s.reduce((e,s)=>e+s.monthlyPrice,0),y=12*N;return r?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsxs)("span",{className:"ml-3",children:["Loading ",j.name," commercial accounts..."]})]})}):i?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:i})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(p.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Total Accounts"})]}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:s.length})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(b.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Monthly Revenue"})]}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",N.toLocaleString()]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(b.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Yearly Revenue"})]}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",y.toLocaleString()]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,l.jsx)(m.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Unique ZIPs"})]}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:[...new Set(s.map(e=>e.zip))].length})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"w-5 h-5"}),"Commercial Accounts Map"]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sO,center:j.center,zoom:j.zoom,options:sL,children:[s.map(e=>(0,l.jsx)(w.Jx,{position:{lat:e.latitude,lng:e.longitude},icon:{path:google.maps.SymbolPath.CIRCLE,scale:u===e.customerNumber?12:8,fillColor:"#8b5cf6",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2},onClick:()=>g(e),onMouseOver:()=>f(e.customerNumber),onMouseOut:()=>f(null)},e.customerNumber)),x&&(0,l.jsx)(w.nx,{position:{lat:x.latitude,lng:x.longitude},onCloseClick:()=>h(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h4",{className:"font-semibold text-lg",children:x.accountName}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:x.customerNumber}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Address:"})," ",x.address]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"City:"})," ",x.city,", ",x.state," ",x.zip]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",x.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Technician:"})," ",x.routeTech]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Service Day:"})," ",x.dayOfService]}),(0,l.jsxs)("div",{className:"mt-2 pt-2 border-t",children:[(0,l.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:["Monthly: $",x.monthlyPrice.toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Yearly: $",x.yearlyPrice.toLocaleString()]})]})]})]})})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"w-5 h-5"}),"All Commercial Accounts (",s.length,")"]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"City"}),(0,l.jsx)(I.ss,{children:"ZIP"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{children:"Technician"}),(0,l.jsx)(I.ss,{children:"Service Day"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Yearly Price"})]})}),(0,l.jsx)(I.RM,{children:s.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>g(e),children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.accountName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:e.zip}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"default",className:"bg-violet-500",children:e.territory})}),(0,l.jsx)(I.pj,{children:e.routeTech}),(0,l.jsx)(I.pj,{children:e.dayOfService}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold text-green-600",children:["$",e.monthlyPrice.toFixed(2)]}),(0,l.jsxs)(I.pj,{className:"text-right",children:["$",e.yearlyPrice.toFixed(2)]})]},e.customerNumber))})]})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Total Commercial Revenue:"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Monthly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",N.toLocaleString()]})]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Yearly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",y.toLocaleString()]})]})]})]})})]})]})}function sI({location:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(null),[x,h]=(0,a.useState)("all"),[u,p]=(0,a.useState)("all"),[j,g]=(0,a.useState)(null),[b,N]=(0,a.useState)(null),y=s$[e];(0,a.useEffect)(()=>{fetch(`/${e}-route-assignments.json`).then(e=>e.json()).then(e=>{t(e),n(!1)}).catch(e=>{console.error("Error loading routes:",e),c(`Failed to load ${y.name} routes`),n(!1)})},[e,y.name]);let v=(0,a.useMemo)(()=>[...new Set(s.map(e=>e.routeTech).filter(Boolean))].sort(),[s]),C=(0,a.useMemo)(()=>s.filter(e=>("all"===x||e.routeTech===x)&&("all"===u||e.dayOfService===u)),[s,x,u]),k=(0,a.useCallback)(e=>{g(e)},[]);return r?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsxs)("span",{className:"ml-3",children:["Loading ",y.name," routes..."]})]})}):i?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:i})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Select Technician"}),(0,l.jsxs)(K.Ph,{value:x,onValueChange:h,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{placeholder:"Select a technician"})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"all",children:"All Technicians"}),v.map(e=>(0,l.jsxs)(K.Ql,{value:e,children:[e," (",s.filter(s=>s.routeTech===e).length,")"]},e))]})]})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Filter by Service Day"}),(0,l.jsxs)(K.Ph,{value:u,onValueChange:p,children:[(0,l.jsx)(K.i4,{children:(0,l.jsx)(K.ki,{})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"all",children:"All Days"}),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>(0,l.jsx)(K.Ql,{value:e,children:e},e))]})]})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex gap-2 items-center",children:[(0,l.jsx)(f.Z,{className:"w-4 h-4 text-gray-600"}),(0,l.jsxs)("span",{className:"text-sm font-medium",children:["Showing ",C.length," of ",s.length," accounts"]})]}),"all"===x&&(0,l.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,l.jsxs)("p",{className:"text-sm text-blue-800 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-4 h-4"}),(0,l.jsxs)("span",{children:[(0,l.jsx)("strong",{children:"Tip:"})," Select a specific technician above to view the route map."]})]})})]}),"all"!==x&&(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-5 h-5"}),"Route Map - ",x]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sO,center:y.center,zoom:y.zoom,options:sL,children:[C.map((e,s)=>(0,l.jsx)(w.Jx,{position:{lat:e.latitude,lng:e.longitude},label:{text:String(s+1),color:"white",fontSize:"12px",fontWeight:"bold"},icon:{path:google.maps.SymbolPath.CIRCLE,scale:b===e.customerNumber?16:12,fillColor:"#3b82f6",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2},onClick:()=>k(e),onMouseOver:()=>N(e.customerNumber),onMouseOut:()=>N(null)},e.customerNumber)),j&&(0,l.jsx)(w.nx,{position:{lat:j.latitude,lng:j.longitude},onCloseClick:()=>g(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsx)("h4",{className:"font-semibold text-lg",children:j.accountName}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:j.customerNumber}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Address:"})," ",j.address]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"City:"})," ",j.city,", ",j.state]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Service Day:"})," ",j.dayOfService]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",j.territory]}),j.monthlyPrice>0&&(0,l.jsx)("div",{className:"mt-2 pt-2 border-t",children:(0,l.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:["$",j.monthlyPrice.toFixed(2),"/month"]})})]})]})})]})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(si.Z,{className:"w-5 h-5"}),"Route Assignments (",C.length,")"]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"City"}),(0,l.jsx)(I.ss,{children:"ZIP"}),(0,l.jsx)(I.ss,{children:"Technician"}),(0,l.jsx)(I.ss,{children:"Service Day"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"})]})}),(0,l.jsx)(I.RM,{children:C.map(e=>(0,l.jsxs)(I.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>k(e),children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.accountName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:e.city}),(0,l.jsx)(I.pj,{children:e.zip}),(0,l.jsx)(I.pj,{children:e.routeTech}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"default",children:e.dayOfService})}),(0,l.jsx)(I.pj,{children:e.territory}),(0,l.jsx)(I.pj,{className:"text-right font-semibold text-green-600",children:e.monthlyPrice>0?`$${e.monthlyPrice.toFixed(2)}`:"-"})]},e.customerNumber))})]})})]})]})}let sY={width:"100%",height:"600px"},sW={dallas:{name:"Dallas",center:{lat:32.7767,lng:-96.797},zoom:10},orlando:{name:"Orlando",center:{lat:28.5383,lng:-81.3792},zoom:10},portCharlotte:{name:"Port Charlotte",center:{lat:26.9762,lng:-82.0909},zoom:11},miami:{name:"Miami",center:{lat:25.7617,lng:-80.1918},zoom:10},jacksonville:{name:"Jacksonville",center:{lat:30.3322,lng:-81.6557},zoom:10}},sB={disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},sU=e=>({"JAX - Maint Ponte Vedra":"#06b6d4","JAX - Maint Jacksonville":"#2563eb","JAX - Maint St. Augustine":"#14b8a6","JAX - Maint St. Johns":"#10b981","JAX - Maint Nocatee":"#84cc16","JAX - Maint Beaches":"#0ea5e9","JAX - Maint Outskirts":"#6366f1","JAX - Comm Maint":"#8b5cf6"})[e]||"#6b7280",sJ=e=>0===e?"#f3f4f6":e<1e3?"#fef3c7":e<3e3?"#fde68a":e<5e3?"#fcd34d":e<8e3?"#fbbf24":e<12e3?"#f59e0b":"#d97706",sV=e=>e.totalMonthlyRevenue??e.totalRevenue??0,sX=e=>e.totalYearlyRevenue??(e.totalRevenue?12*e.totalRevenue:0);function sQ({location:e}){let s=sW[e],[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)({}),[x,h]=(0,a.useState)(!0),[u,f]=(0,a.useState)(null),[p,j]=(0,a.useState)(null),[g,N]=(0,a.useState)(null),[y,v]=(0,a.useState)({}),[C,k]=(0,a.useState)("none");(0,a.useEffect)(()=>{h(!0),f(null),j(null),N(null),k("none"),Promise.all([fetch(`/${e}-zip-revenue-data.json`).then(e=>e.json()),fetch(`/${e}-zip-boundaries.json`).then(e=>e.json())]).then(([e,s])=>{r(e);let t=s;Array.isArray(s)&&(t={},s.forEach(e=>{e.zipCode&&e.geometry&&(t[e.zipCode]=e.geometry)})),i(t);let l=[...new Set(e.map(e=>e.territory))],a={};l.forEach(e=>a[e]=!0),v(a),h(!1)}).catch(e=>{console.error("Error loading data:",e),f("Failed to load "+s.name+" revenue data"),h(!1)})},[e,s.name]);let S=(0,a.useCallback)(e=>{v(s=>({...s,[e]:!s[e]}))},[]),z=(0,a.useMemo)(()=>t.filter(e=>y[e.territory]),[t,y]),T=(0,a.useMemo)(()=>p&&t.find(e=>e.zip===p)||null,[p,t]),Z=(0,a.useMemo)(()=>{if(!T||!T.accounts)return[];let e=[...T.accounts];return"asc"===C?e.sort((e,s)=>e.monthlyPrice-s.monthlyPrice):"desc"===C?e.sort((e,s)=>s.monthlyPrice-e.monthlyPrice):e},[T,C]),A=(0,a.useMemo)(()=>{let e={};return z.forEach(s=>{if(e[s.territory]||(e[s.territory]={count:0,avgResidentialPrice:0,residentialCount:0,totalResidentialRevenue:0}),e[s.territory].count+=s.accountCount,s.accounts&&Array.isArray(s.accounts))s.accounts.forEach(t=>{"Residential"===t.accountType&&(e[s.territory].residentialCount+=1,e[s.territory].totalResidentialRevenue+=t.monthlyPrice)});else if(void 0!==s.residentialCount&&void 0!==s.totalMonthlyRevenue){let t=s.totalAccounts?s.residentialCount/s.totalAccounts:1,l=s.totalMonthlyRevenue*t;e[s.territory].residentialCount+=s.residentialCount,e[s.territory].totalResidentialRevenue+=l}}),Object.keys(e).forEach(s=>{e[s].residentialCount>0&&(e[s].avgResidentialPrice=e[s].totalResidentialRevenue/e[s].residentialCount)}),e},[z]),R=(0,a.useCallback)(e=>{j(e),k("none")},[]),P=(0,a.useCallback)(()=>{k(e=>"none"===e?"desc":"desc"===e?"asc":"none")},[]);return x?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,l.jsxs)("span",{className:"ml-3",children:["Loading ",s.name," revenue data..."]})]})}):u?(0,l.jsx)(o.Zb,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,l.jsx)(ee.Z,{className:"mr-2"}),(0,l.jsx)("span",{children:u})]})}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Territory Filters"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.keys(y).map(e=>{let s=A[e]||{count:0,avgResidentialPrice:0,residentialCount:0,totalResidentialRevenue:0};return(0,l.jsxs)(c.z,{variant:y[e]?"default":"outline",size:"sm",onClick:()=>S(e),style:{backgroundColor:y[e]?sU(e):void 0,borderColor:sU(e),color:y[e]?"#ffffff":sU(e)},className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:e}),(0,l.jsxs)(d.C,{variant:"secondary",className:"ml-1",children:[s.count," accounts"]}),(0,l.jsxs)(d.C,{variant:"secondary",children:["Avg: $",s.avgResidentialPrice.toFixed(2)]})]},e)})})]}),(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-5 h-5"}),"Revenue by ZIP Code"]}),(0,l.jsxs)(w.b6,{mapContainerStyle:sY,center:s.center,zoom:s.zoom,options:sB,children:[z.map(e=>{let s=n[e.zip];return s&&s.coordinates?("MultiPolygon"===s.type?s.coordinates:[s.coordinates]).map((t,a)=>{if(!t||!Array.isArray(t)||0===t.length)return null;let r=(s.type,t[0]);if(!r||!Array.isArray(r)||0===r.length)return null;let n=r.map(e=>({lat:e[1],lng:e[0]})),i=p===e.zip,o=g===e.zip;return(0,l.jsx)(w.mg,{paths:n,options:{fillColor:sJ(sV(e)),fillOpacity:i?.8:o?.6:.5,strokeColor:i?"#000000":sU(e.territory),strokeOpacity:.9,strokeWeight:i?3:2,clickable:!0},onClick:()=>R(e.zip),onMouseOver:()=>N(e.zip),onMouseOut:()=>N(null)},`${e.zip}-${a}`)}):null}),T&&(0,l.jsx)(w.nx,{position:{lat:t.find(e=>e.zip===p)?.accounts?.[0]?.latitude||s.center.lat,lng:t.find(e=>e.zip===p)?.accounts?.[0]?.longitude||s.center.lng},onCloseClick:()=>j(null),children:(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)("h4",{className:"font-semibold text-lg",children:["ZIP ",T.zip]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:T.city}),(0,l.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Territory:"})," ",T.territory]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Accounts:"})," ",T.accountCount]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Monthly Revenue:"})," $",sV(T).toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Yearly Revenue:"})," $",sX(T).toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Avg Price/Account:"})," $",T.accountCount>0?(sV(T)/T.accountCount).toFixed(2):"0.00"]})]})]})})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-4 flex-wrap",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Monthly Revenue:"}),[{label:"$0",color:"#f3f4f6"},{label:"<$1k",color:"#fef3c7"},{label:"$1k-$3k",color:"#fde68a"},{label:"$3k-$5k",color:"#fcd34d"},{label:"$5k-$8k",color:"#fbbf24"},{label:"$8k-$12k",color:"#f59e0b"},{label:">$12k",color:"#d97706"}].map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"w-4 h-4 border border-gray-300 rounded",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"text-xs",children:e.label})]},e.label))]})]}),T&&T.accounts&&T.accounts.length>0&&(0,l.jsxs)(o.Zb,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,l.jsx)(b.Z,{className:"w-5 h-5"}),"Accounts in ZIP ",T.zip," (",Z.length,")"]}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:P,className:"flex items-center gap-2",children:[(0,l.jsx)(B.Z,{className:"w-4 h-4"}),"Sort by Price","desc"===C&&" (High to Low)","asc"===C&&" (Low to High)","none"===C&&" (Default)"]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(I.iA,{children:[(0,l.jsx)(I.xD,{children:(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.ss,{children:"Customer #"}),(0,l.jsx)(I.ss,{children:"Name"}),(0,l.jsx)(I.ss,{children:"Address"}),(0,l.jsx)(I.ss,{children:"Type"}),(0,l.jsx)(I.ss,{children:"Territory"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Monthly Price"}),(0,l.jsx)(I.ss,{className:"text-right",children:"Yearly Price"})]})}),(0,l.jsx)(I.RM,{children:Z.map(e=>(0,l.jsxs)(I.SC,{children:[(0,l.jsx)(I.pj,{className:"font-medium",children:e.customerNumber}),(0,l.jsx)(I.pj,{children:e.customerName}),(0,l.jsx)(I.pj,{children:e.address}),(0,l.jsx)(I.pj,{children:(0,l.jsx)(d.C,{variant:"Commercial"===e.accountType?"default":"secondary",children:e.accountType})}),(0,l.jsx)(I.pj,{children:(0,l.jsx)("div",{className:"inline-block px-2 py-1 rounded text-xs text-white",style:{backgroundColor:sU(e.territory)},children:e.territory})}),(0,l.jsxs)(I.pj,{className:"text-right font-semibold",children:["$",e.monthlyPrice.toFixed(2)]}),(0,l.jsxs)(I.pj,{className:"text-right",children:["$",e.yearlyPrice.toFixed(2)]})]},e.customerNumber))})]})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"font-semibold",children:["Total for ZIP ",T.zip,":"]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Monthly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",sV(T).toLocaleString()]})]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Yearly:"})," ",(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["$",sX(T).toLocaleString()]})]})]})]})})]})]})}var sG=t(4938);function s_({densityMode:e,onDensityModeChange:s,showLifetime:t=!1,accountType:a="residential",onAccountTypeChange:r,showAccountTypeToggle:n=!1}){return(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"space-y-4",children:[n&&r&&(0,l.jsxs)("div",{className:"pb-4 border-b border-slate-200",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Account Type"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(c.z,{variant:"residential"===a?"default":"outline",className:`flex-1 ${"residential"===a?"bg-blue-500 hover:bg-blue-600 text-white":"hover:bg-blue-50"}`,onClick:()=>r("residential"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(sG.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Residential"})]})}),(0,l.jsx)(c.z,{variant:"commercial"===a?"default":"outline",className:`flex-1 ${"commercial"===a?"bg-purple-500 hover:bg-purple-600 text-white":"hover:bg-purple-50"}`,onClick:()=>r("commercial"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Commercial"})]})})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(e5.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Density View Mode"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsx)(c.z,{variant:"active"===e?"default":"outline",className:`px-6 py-2 ${"active"===e?"bg-green-500 hover:bg-green-600 text-white":"hover:bg-green-50"}`,onClick:()=>s("active"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-lg",children:"✅"}),(0,l.jsx)("span",{children:"Active Accounts"})]})}),(0,l.jsx)(c.z,{variant:"terminated"===e?"default":"outline",className:`px-6 py-2 ${"terminated"===e?"bg-red-500 hover:bg-red-600 text-white":"hover:bg-red-50"}`,onClick:()=>s("terminated"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-lg",children:"❌"}),(0,l.jsx)("span",{children:"Terminated Accounts"})]})}),(0,l.jsx)(c.z,{variant:"both"===e?"default":"outline",className:`px-6 py-2 ${"both"===e?"bg-orange-500 hover:bg-orange-600 text-white":"hover:bg-orange-50"}`,onClick:()=>s("both"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-lg",children:"\uD83D\uDCCA"}),(0,l.jsx)("span",{children:"Churn Rate"})]})}),t&&(0,l.jsx)(c.z,{variant:"lifetime"===e?"default":"outline",className:`px-6 py-2 ${"lifetime"===e?"bg-blue-500 hover:bg-blue-600 text-white":"hover:bg-blue-50"}`,onClick:()=>s("lifetime"),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-lg",children:"⏱️"}),(0,l.jsx)("span",{children:"Customer Lifetime"})]})})]}),(0,l.jsx)("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:(0,l.jsxs)("p",{className:"text-sm text-slate-600",children:["active"===e&&"\uD83D\uDFE2 Darker green = more active accounts","terminated"===e&&"\uD83D\uDD34 Darker red = more terminated accounts","both"===e&&"\uD83D\uDCC8 Green (low churn) → Red (high churn)","lifetime"===e&&"\uD83D\uDFE2 Darker green = longer customer lifetime (months)"]})})]})})})}function sH({mode:e,location:s="arizona",accountType:t="residential"}){let a={active:[{label:"0-5",color:"#f0fdf4",textColor:"#166534"},{label:"6-15",color:"#86efac",textColor:"#15803d"},{label:"16-30",color:"#22c55e",textColor:"#ffffff"},{label:"31-50",color:"#16a34a",textColor:"#ffffff"},{label:"50+",color:"#15803d",textColor:"#ffffff"}],terminated:[{label:"0-20",color:"#fef2f2",textColor:"#991b1b"},{label:"21-50",color:"#fca5a5",textColor:"#7f1d1d"},{label:"51-100",color:"#f87171",textColor:"#ffffff"},{label:"101-200",color:"#dc2626",textColor:"#ffffff"},{label:"200+",color:"#991b1b",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]},r=a;"miami"===s?r="commercial"===t?{active:[{label:"0-2",color:"#f0fdf4",textColor:"#166534"},{label:"3-4",color:"#d1fae5",textColor:"#15803d"},{label:"5-6",color:"#a7f3d0",textColor:"#047857"},{label:"7-9",color:"#6ee7b7",textColor:"#ffffff"},{label:"10-12",color:"#34d399",textColor:"#ffffff"},{label:"13-15",color:"#10b981",textColor:"#ffffff"},{label:"16-18",color:"#059669",textColor:"#ffffff"},{label:"18+",color:"#065f46",textColor:"#ffffff"}],terminated:[{label:"0-3",color:"#fef2f2",textColor:"#991b1b"},{label:"4-6",color:"#fecaca",textColor:"#7f1d1d"},{label:"7-9",color:"#fca5a5",textColor:"#7f1d1d"},{label:"10-12",color:"#f87171",textColor:"#ffffff"},{label:"13-15",color:"#ef4444",textColor:"#ffffff"},{label:"16-18",color:"#dc2626",textColor:"#ffffff"},{label:"19-21",color:"#b91c1c",textColor:"#ffffff"},{label:"21+",color:"#991b1b",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:{active:[{label:"0-10",color:"#f0fdf4",textColor:"#166534"},{label:"11-20",color:"#d1fae5",textColor:"#15803d"},{label:"21-35",color:"#a7f3d0",textColor:"#047857"},{label:"36-50",color:"#6ee7b7",textColor:"#ffffff"},{label:"51-75",color:"#34d399",textColor:"#ffffff"},{label:"76-100",color:"#10b981",textColor:"#ffffff"},{label:"101-125",color:"#059669",textColor:"#ffffff"},{label:"125+",color:"#065f46",textColor:"#ffffff"}],terminated:[{label:"0-15",color:"#fef2f2",textColor:"#991b1b"},{label:"16-30",color:"#fecaca",textColor:"#7f1d1d"},{label:"31-50",color:"#fca5a5",textColor:"#7f1d1d"},{label:"51-75",color:"#f87171",textColor:"#ffffff"},{label:"76-100",color:"#ef4444",textColor:"#ffffff"},{label:"101-150",color:"#dc2626",textColor:"#ffffff"},{label:"151-200",color:"#b91c1c",textColor:"#ffffff"},{label:"200+",color:"#991b1b",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:"dallas"===s?r="commercial"===t?{active:[{label:"0",color:"#f0fdf4",textColor:"#166534"},{label:"1",color:"#6ee7b7",textColor:"#ffffff"},{label:"2+",color:"#10b981",textColor:"#ffffff"}],terminated:[{label:"0-2",color:"#fef2f2",textColor:"#991b1b"},{label:"3-4",color:"#fecaca",textColor:"#7f1d1d"},{label:"5-6",color:"#fca5a5",textColor:"#7f1d1d"},{label:"7-8",color:"#f87171",textColor:"#ffffff"},{label:"8+",color:"#ef4444",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:{active:[{label:"0-5",color:"#f0fdf4",textColor:"#166534"},{label:"6-10",color:"#d1fae5",textColor:"#15803d"},{label:"11-20",color:"#a7f3d0",textColor:"#047857"},{label:"21-30",color:"#6ee7b7",textColor:"#ffffff"},{label:"31-40",color:"#34d399",textColor:"#ffffff"},{label:"41-50",color:"#10b981",textColor:"#ffffff"},{label:"50+",color:"#059669",textColor:"#ffffff"}],terminated:[{label:"0-20",color:"#fef2f2",textColor:"#991b1b"},{label:"21-40",color:"#fecaca",textColor:"#7f1d1d"},{label:"41-60",color:"#fca5a5",textColor:"#7f1d1d"},{label:"61-80",color:"#f87171",textColor:"#ffffff"},{label:"81-100",color:"#ef4444",textColor:"#ffffff"},{label:"101-150",color:"#dc2626",textColor:"#ffffff"},{label:"150+",color:"#b91c1c",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:"orlando"===s?r="commercial"===t?{active:[{label:"0-2",color:"#f0fdf4",textColor:"#166534"},{label:"3-4",color:"#d1fae5",textColor:"#15803d"},{label:"5-6",color:"#6ee7b7",textColor:"#ffffff"},{label:"7-9",color:"#34d399",textColor:"#ffffff"},{label:"9+",color:"#10b981",textColor:"#ffffff"}],terminated:[{label:"0-5",color:"#fef2f2",textColor:"#991b1b"},{label:"6-10",color:"#fecaca",textColor:"#7f1d1d"},{label:"11-15",color:"#fca5a5",textColor:"#7f1d1d"},{label:"16-20",color:"#f87171",textColor:"#ffffff"},{label:"21-30",color:"#ef4444",textColor:"#ffffff"},{label:"30+",color:"#dc2626",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:{active:[{label:"0-10",color:"#f0fdf4",textColor:"#166534"},{label:"11-20",color:"#d1fae5",textColor:"#15803d"},{label:"21-35",color:"#a7f3d0",textColor:"#047857"},{label:"36-50",color:"#6ee7b7",textColor:"#ffffff"},{label:"51-70",color:"#34d399",textColor:"#ffffff"},{label:"71-90",color:"#10b981",textColor:"#ffffff"},{label:"90+",color:"#059669",textColor:"#ffffff"}],terminated:[{label:"0-10",color:"#fef2f2",textColor:"#991b1b"},{label:"11-20",color:"#fecaca",textColor:"#7f1d1d"},{label:"21-30",color:"#fca5a5",textColor:"#7f1d1d"},{label:"31-50",color:"#f87171",textColor:"#ffffff"},{label:"51-75",color:"#ef4444",textColor:"#ffffff"},{label:"76-100",color:"#dc2626",textColor:"#ffffff"},{label:"100+",color:"#b91c1c",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:"jacksonville"===s&&(r="commercial"===t?{active:[{label:"0",color:"#f0fdf4",textColor:"#166534"},{label:"1",color:"#6ee7b7",textColor:"#ffffff"},{label:"2+",color:"#10b981",textColor:"#ffffff"}],terminated:[{label:"0 (No Losses)",color:"#fef2f2",textColor:"#991b1b"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]}:{active:[{label:"0-10",color:"#f0fdf4",textColor:"#166534"},{label:"11-25",color:"#d1fae5",textColor:"#15803d"},{label:"26-40",color:"#a7f3d0",textColor:"#047857"},{label:"41-60",color:"#6ee7b7",textColor:"#ffffff"},{label:"61-80",color:"#34d399",textColor:"#ffffff"},{label:"81-110",color:"#10b981",textColor:"#ffffff"},{label:"110+",color:"#059669",textColor:"#ffffff"}],terminated:[{label:"0-5",color:"#fef2f2",textColor:"#991b1b"},{label:"6-10",color:"#fecaca",textColor:"#7f1d1d"},{label:"11-20",color:"#fca5a5",textColor:"#7f1d1d"},{label:"21-30",color:"#f87171",textColor:"#ffffff"},{label:"31-50",color:"#ef4444",textColor:"#ffffff"},{label:"50+",color:"#dc2626",textColor:"#ffffff"}],both:[{label:"0-50%",color:"#f0fdf4",textColor:"#166534"},{label:"51-70%",color:"#fef3c7",textColor:"#854d0e"},{label:"71-85%",color:"#fbbf24",textColor:"#ffffff"},{label:"86-95%",color:"#f97316",textColor:"#ffffff"},{label:"95-100%",color:"#991b1b",textColor:"#ffffff"}],lifetime:[{label:"0-12",color:"#fbbf24",textColor:"#ffffff"},{label:"13-24",color:"#a3e635",textColor:"#ffffff"},{label:"25-36",color:"#86efac",textColor:"#15803d"},{label:"37-60",color:"#22c55e",textColor:"#ffffff"},{label:"61-120",color:"#16a34a",textColor:"#ffffff"},{label:"120+",color:"#15803d",textColor:"#ffffff"}]});let n="both"===e||"lifetime"===e?a[e]:r[e];return(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsxs)(o.aY,{className:"p-6",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-4",children:{active:"Active Accounts Density",terminated:"Terminated Accounts Density",both:"Churn Rate",lifetime:"Average Customer Lifetime"}[e]}),(0,l.jsx)("div",{className:"space-y-2",children:n.map((s,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-8 rounded border border-slate-200 flex items-center justify-center text-xs font-medium",style:{backgroundColor:s.color,color:s.textColor},children:s.label}),(0,l.jsxs)("span",{className:"text-sm text-slate-600",children:["active"===e&&"Active accounts","terminated"===e&&"Terminated accounts","both"===e&&"Churn rate","lifetime"===e&&"Months"]})]},t))})]})})}function sq(){return(0,l.jsxs)(o.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsxs)(o.Ol,{className:"pb-3",children:[(0,l.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,l.jsx)(g.Z,{className:"h-5 w-5 text-blue-600"}),"Market Size Legend"]}),(0,l.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Permitted pools per zip code"})]}),(0,l.jsxs)(o.aY,{className:"space-y-2",children:[[{color:"#1a237e",label:"6,000+ pools",range:"Very High"},{color:"#283593",label:"4,000 - 5,999",range:"High"},{color:"#3949ab",label:"3,000 - 3,999",range:"Medium-High"},{color:"#5e35b1",label:"2,000 - 2,999",range:"Medium"},{color:"#7e57c2",label:"1,500 - 1,999",range:"Medium-Low"},{color:"#9575cd",label:"1,000 - 1,499",range:"Low-Medium"},{color:"#b39ddb",label:"500 - 999",range:"Low"},{color:"#d1c4e9",label:"250 - 499",range:"Very Low"},{color:"#e8eaf6",label:"< 250",range:"Minimal"}].map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-6 rounded border border-slate-300 flex-shrink-0",style:{backgroundColor:e.color,opacity:.7}}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-700 leading-tight",children:e.label}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:e.range})]})]},s)),(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-slate-200",children:(0,l.jsx)(d.C,{variant:"outline",className:"w-full justify-center text-xs",children:"Click any zip code for details"})})]})]})}var sK=t(8896);function s0({areaFilter:e}){let[s,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0);if((0,a.useEffect)(()=>{(async()=>{try{let s=await fetch("/market-size-data.json"),l=await s.json(),a=await fetch("/phoenix-tucson-map-data.json"),r=await a.json(),i={};r.forEach(e=>{let s=e.area,t=l.find(s=>s.zipCode===e.zip);i[s]||(i[s]={area:s,totalPermittedPools:0,currentAccounts:0,penetrationRate:0,zipCodes:0}),i[s].zipCodes++,i[s].currentAccounts+=e.accounts||0,t&&(i[s].totalPermittedPools+=t.permittedPools)}),Object.values(i).forEach(e=>{e.totalPermittedPools>0&&(e.penetrationRate=e.currentAccounts/e.totalPermittedPools*100)});let o=Object.values(i).filter(s=>e[s.area]).sort((e,s)=>s.totalPermittedPools-e.totalPermittedPools);t(o),n(!1)}catch(e){console.error("Error loading market stats:",e),n(!1)}})()},[e]),r)return(0,l.jsx)(o.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6 text-center",children:(0,l.jsx)("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full mx-auto"})})});let i=s.reduce((e,s)=>e+s.totalPermittedPools,0),c=s.reduce((e,s)=>e+s.currentAccounts,0);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5 text-blue-600"}),"Market Overview"]})}),(0,l.jsx)(o.aY,{className:"space-y-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-slate-600",children:"Total Market:"}),(0,l.jsx)("span",{className:"text-lg font-bold text-blue-700",children:i.toLocaleString()})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-slate-600",children:"Current Accounts:"}),(0,l.jsx)("span",{className:"text-lg font-bold text-green-700",children:c.toLocaleString()})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-slate-600",children:"Penetration:"}),(0,l.jsxs)("span",{className:"text-lg font-bold text-purple-700",children:[(i>0?c/i*100:0).toFixed(1),"%"]})]})]})})]}),(0,l.jsxs)(o.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,l.jsx)(sK.Z,{className:"h-5 w-5 text-green-600"}),"Area Breakdown"]})}),(0,l.jsx)(o.aY,{className:"space-y-3",children:s.map(e=>{let s="West"===e.area?"text-blue-600":"Central"===e.area?"text-green-600":"East"===e.area?"text-orange-600":"text-purple-600";return(0,l.jsxs)("div",{className:"border-b border-slate-100 last:border-0 pb-3 last:pb-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("span",{className:`font-semibold ${s}`,children:"Tucson"===e.area?"Tucson":`Phoenix ${e.area}`}),(0,l.jsxs)("span",{className:"text-xs text-slate-500",children:[e.zipCodes," zip codes"]})]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Market Size:"}),(0,l.jsx)("span",{className:"font-medium",children:e.totalPermittedPools.toLocaleString()})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Accounts:"}),(0,l.jsx)("span",{className:"font-medium",children:e.currentAccounts.toLocaleString()})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Penetration:"}),(0,l.jsxs)("span",{className:"font-semibold text-purple-600",children:[e.penetrationRate.toFixed(1),"%"]})]})]})]},e.area)})})]})]})}var s1=t(3245);function s2(){let e=[{name:"APS of Glendale",color:"#3B82F6",description:"Western Phoenix metropolitan area",accounts:483},{name:"APS of Scottsdale",color:"#10B981",description:"Central Phoenix metropolitan core",accounts:598},{name:"APS of Chandler",color:"#F59E0B",description:"Eastern Phoenix + San Tan Valley area",accounts:554},{name:"APS of Tucson",color:"#A855F7",description:"Tucson metropolitan area",accounts:64}],s=e.reduce((e,s)=>e+s.accounts,0);return(0,l.jsxs)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2 text-slate-900",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5"}),"Territory Legend"]})}),(0,l.jsxs)(o.aY,{className:"pt-0",children:[(0,l.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full mt-0.5 flex-shrink-0",style:{backgroundColor:e.color}}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,l.jsx)("h4",{className:"font-medium text-slate-900 text-sm",children:e.name}),(0,l.jsxs)("span",{className:"text-xs font-medium text-slate-600",children:[(e.accounts/s*100).toFixed(1),"%"]})]}),(0,l.jsx)("p",{className:"text-xs text-slate-600 leading-relaxed",children:e.description})]})]},e.name))}),(0,l.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-200",children:(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)(s1.Z,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),(0,l.jsx)("p",{className:"text-xs text-slate-600 leading-relaxed",children:"Click on map markers to view detailed zip code information and account counts."})]})})]})]})}var s4=t(610);let s5=a.forwardRef(({className:e,value:s,...t},a)=>(0,l.jsx)(s4.fC,{ref:a,className:(0,Z.cn)("relative h-2 w-full overflow-hidden rounded-full bg-slate-100",e),...t,children:(0,l.jsx)(s4.z$,{className:"h-full w-full flex-1 bg-slate-900 transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));function s6({areaStats:e}){let s=Object.values(e).reduce((e,s)=>e+(s?.totalAccounts||0),0),t=Object.values(e).reduce((e,s)=>e+(s?.zipCodes||0),0),a=[{name:"APS of Glendale",color:"#3B82F6",accounts:e?.West?.totalAccounts||0,zipCodes:e?.West?.zipCodes||0},{name:"APS of Scottsdale",color:"#10B981",accounts:e?.Central?.totalAccounts||0,zipCodes:e?.Central?.zipCodes||0},{name:"APS of Chandler",color:"#F59E0B",accounts:e?.East?.totalAccounts||0,zipCodes:e?.East?.zipCodes||0},{name:"APS of Tucson",color:"#A855F7",accounts:e?.Tucson?.totalAccounts||0,zipCodes:e?.Tucson?.zipCodes||0}];return(0,l.jsxs)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2 text-slate-900",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5"}),"Territory Statistics"]})}),(0,l.jsxs)(o.aY,{className:"pt-0",children:[(0,l.jsx)("div",{className:"space-y-6",children:a.map(e=>{let t=s>0?e.accounts/s*100:0,a=e.zipCodes>0?Math.round(e.accounts/e.zipCodes):0;return(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"font-medium text-slate-900 text-sm",children:e.name})]}),(0,l.jsxs)("span",{className:"text-xs text-slate-600",children:[t.toFixed(1),"%"]})]}),(0,l.jsx)(s5,{value:t,className:"h-2",style:{"--progress-background":e.color}}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600",children:"Accounts"}),(0,l.jsx)("p",{className:"font-semibold text-slate-900",children:e.accounts.toLocaleString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600",children:"Zip Codes"}),(0,l.jsx)("p",{className:"font-semibold text-slate-900",children:e.zipCodes})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,l.jsx)(g.Z,{className:"h-3 w-3 text-green-500"}),(0,l.jsxs)("span",{className:"text-slate-600",children:[a," avg accounts per zip"]})]})]},e.name)})}),(0,l.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-200",children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:s.toLocaleString()}),(0,l.jsx)("p",{className:"text-xs text-slate-600",children:"Total Accounts"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:t}),(0,l.jsx)("p",{className:"text-xs text-slate-600",children:"Total Zip Codes"})]})]})})]})]})}function s3({message:e="Loading...",className:s}){return(0,l.jsx)("div",{className:(0,Z.cn)("flex items-center justify-center h-96",s),children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:e})]})})}function s8({title:e,description:s,icon:t,iconClassName:a,action:r,className:n}){return(0,l.jsx)(o.Zb,{className:(0,Z.cn)("max-w-md mx-auto",n),children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[t?(0,l.jsx)(t,{className:(0,Z.cn)("h-12 w-12 text-slate-500 mx-auto mb-4",a)}):null,(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:e}),s?(0,l.jsx)("p",{className:"text-slate-600 mb-4",children:s}):null,r]})})}s5.displayName=s4.fC.displayName;let s7={North:{emoji:"\uD83D\uDFE6",color:"#3B82F6"},Central:{emoji:"\uD83D\uDFE9",color:"#10B981"},South:{emoji:"\uD83D\uDFE7",color:"#F59E0B"}};function s9({areaFilter:e,onToggle:s,onReset:t,variant:a="compact",data:r=[],className:n}){let i=Object.keys(e),m=i.map(e=>{let s=r.filter(s=>s.territory===e),t=s.reduce((e,s)=>e+(s.accountCount||0),0);return{territory:e,zipCount:s.length,accountCount:t}});return"detailed"===a?(0,l.jsx)(o.Zb,{className:(0,Z.cn)("bg-white/80 backdrop-blur-sm border-0 shadow-lg",n),children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Territory Filters"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:m.map(({territory:t,zipCount:a,accountCount:r})=>{let n=e[t],i=s7[t].color;return(0,l.jsxs)("button",{className:(0,Z.cn)("cursor-pointer px-4 py-3 rounded-md border transition-all hover:shadow-md flex flex-col items-start",n?"text-white border-transparent":"bg-white hover:bg-slate-100 text-slate-700 border-slate-300"),style:{backgroundColor:n?i:void 0,borderColor:n?i:void 0},onClick:()=>s(t),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 font-medium",children:[s7[t].emoji,"APS Miami - ",t,(0,l.jsxs)("span",{className:"text-xs",children:["(",a,")"]})]}),(0,l.jsxs)("div",{className:(0,Z.cn)("text-[10px] italic mt-0.5",n?"text-white/80":"text-slate-500"),children:[r," accounts"]})]},t)})})]}),(0,l.jsx)("div",{className:"lg:w-auto",children:(0,l.jsx)(c.z,{onClick:t,variant:"outline",className:"w-full lg:w-auto",children:"Reset Filters"})})]})})}):(0,l.jsx)(o.Zb,{className:(0,Z.cn)("bg-white/80 backdrop-blur-sm border-0 shadow-lg",n),children:(0,l.jsx)(o.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Territory Filters"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:i.map(t=>(0,l.jsxs)(d.C,{variant:e[t]?"default":"outline",className:(0,Z.cn)("cursor-pointer px-4 py-2 transition-all hover:shadow-md","North"===t&&e[t]?"bg-blue-500 hover:bg-blue-600":"","Central"===t&&e[t]?"bg-green-500 hover:bg-green-600":"","South"===t&&e[t]?"bg-amber-500 hover:bg-amber-600":"",e[t]?"":"hover:bg-slate-100"),onClick:()=>s(t),children:["APS Miami - ",t]},t))}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:t,className:"text-xs",children:"Reset"})]})})})}let te=(0,a.createContext)(null);function ts({value:e,children:s}){return(0,l.jsx)(te.Provider,{value:e,children:s})}function tt({location:e,onLocationChange:s}){let{data:t}=(0,r.useSession)(),n=t?.user?.role,[i,w]=(0,a.useState)("territory"),[k,z]=(0,a.useState)("active"),[T,Z]=(0,a.useState)("residential"),[A,R]=(0,a.useState)([]),[P,F]=(0,a.useState)([]),[M,O]=(0,a.useState)({West:!0,Central:!0,East:!0,Tucson:!0,Commercial:!0}),[L,I]=(0,a.useState)({North:!0,Central:!0,South:!0}),[Y,W]=(0,a.useState)(null),[B,U]=(0,a.useState)([]),[J,V]=(0,a.useState)(!0),[G,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{H()},[]),(0,a.useEffect)(()=>{"miami"===e&&K()},[e]),(0,a.useEffect)(()=>{A?.length&&(F(A.filter(e=>M?.[e?.area]===!0)),ee(A))},[A,M]);let H=async()=>{try{V(!0),console.log("\uD83D\uDCCA Starting to load territory data...");let e=await fetch("/phoenix-tucson-map-data.json");if(console.log("\uD83D\uDCCA Fetch response received:",e?.status,e?.ok),!e?.ok)throw Error("Failed to load territory data");let s=await e.json();console.log("\uD83D\uDCCA Data loaded successfully:",s?.length,"records"),R(s||[]),console.log("\uD83D\uDCCA State updated with data")}catch(e){console.error("❌ Error loading territory data:",e),_("Failed to load territory data")}finally{V(!1),console.log("\uD83D\uDCCA Loading complete")}},K=async()=>{try{let e=await fetch("/miami-map-data.json");if(!e?.ok)throw Error("Failed to load Miami data");let s=await e.json();U(s||[])}catch(e){console.error("❌ Error loading Miami data:",e)}},ee=e=>{let s={West:{zipCodes:0,totalAccounts:0},Central:{zipCodes:0,totalAccounts:0},East:{zipCodes:0,totalAccounts:0},Tucson:{zipCodes:0,totalAccounts:0}};e?.forEach(e=>{let t=e?.area;s?.[t]&&(s[t].zipCodes+=1,s[t].totalAccounts+=e?.accounts||0)}),W(s)},es=e=>{O(s=>({...s,[e]:!s?.[e]}))},et=()=>{O({West:!0,Central:!0,East:!0,Tucson:!0,Commercial:!0})},el=e=>{I(s=>({...s,[e]:!s[e]}))},er=()=>{I({North:!0,Central:!0,South:!0})},en=(0,a.useCallback)(e=>{"all"===e?O({West:!0,Central:!0,East:!0,Tucson:!0,Commercial:!0}):O({West:!1,Central:!1,East:!1,Tucson:!1,Commercial:!1,[e]:!0})},[]);if(J)return(0,l.jsx)(s3,{message:"Loading territory data..."});if(G)return(0,l.jsx)(s8,{title:"Error Loading Data",description:G,icon:m.Z,iconClassName:"text-red-500",action:(0,l.jsx)(c.z,{onClick:H,className:"w-full",children:"Try Again"})});let ei=Y?Object.values(Y).reduce((e,s)=>e+(s?.totalAccounts||0),0):0,eo=P?.length||0;return(0,l.jsx)(ts,{value:{areaFilter:M,setAreaFilter:O,densityMode:k,setDensityMode:z,accountType:T,setAccountType:Z},children:(0,l.jsx)(S,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:["arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("territory"),variant:"territory"===i?"default":"outline",className:`px-5 py-5 text-sm ${"territory"===i?"bg-blue-600 hover:bg-blue-700 text-white shadow-lg":"hover:bg-blue-50"}`,children:[(0,l.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Residential Account Territory Assignments"]}),"miami"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("kmlScenario"),variant:"kmlScenario"===i?"default":"outline",className:`px-5 py-5 text-sm ${"kmlScenario"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Miami Breakup Scenario I - Fixed Boundaries"]}),(0,l.jsxs)(c.z,{onClick:()=>w("territory"),variant:"territory"===i?"default":"outline",className:`px-5 py-5 text-sm ${"territory"===i?"bg-blue-600 hover:bg-blue-700 text-white shadow-lg":"hover:bg-blue-50"}`,children:[(0,l.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Miami Breakup Scenario II - Zip Codes"]}),(0,l.jsxs)(c.z,{onClick:()=>w("assignmentTool"),variant:"assignmentTool"===i?"default":"outline",className:`px-5 py-5 text-sm ${"assignmentTool"===i?"bg-pink-600 hover:bg-pink-700 text-white shadow-lg":"hover:bg-pink-50"}`,children:[(0,l.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Zip Code Assignment Tool"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miamiFinal"),variant:"miamiFinal"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miamiFinal"===i?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg":"hover:bg-emerald-50 border-emerald-300 text-emerald-700"}`,children:[(0,l.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"FINAL MIAMI TERRITORY MAP"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miami10pct"),variant:"miami10pct"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miami10pct"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50 border-indigo-300 text-indigo-700"}`,children:[(0,l.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"10% REASSIGNMENT"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miamiZipOptimized"),variant:"miamiZipOptimized"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miamiZipOptimized"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50 border-teal-300 text-teal-700"}`,children:[(0,l.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"ZIP-OPTIMIZED"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miamiZipOptimized2"),variant:"miamiZipOptimized2"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miamiZipOptimized2"===i?"bg-cyan-600 hover:bg-cyan-700 text-white shadow-lg":"hover:bg-cyan-50 border-cyan-300 text-cyan-700"}`,children:[(0,l.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"ZIP-OPTIMIZED #2"]}),(0,l.jsxs)(c.z,{onClick:()=>w("radicalReroute"),variant:"radicalReroute"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"radicalReroute"===i?"bg-purple-600 hover:bg-purple-700 text-white shadow-lg":"hover:bg-purple-50 border-purple-300 text-purple-700"}`,children:[(0,l.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"RADICAL REROUTE"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miamiCommercialRoutes"),variant:"miamiCommercialRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miamiCommercialRoutes"===i?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg":"hover:bg-emerald-50 border-emerald-300 text-emerald-700"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"COMMERCIAL ROUTES"]}),(0,l.jsxs)(c.z,{onClick:()=>w("miamiFutureCommercialRoutes"),variant:"miamiFutureCommercialRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm font-bold ${"miamiFutureCommercialRoutes"===i?"bg-amber-600 hover:bg-amber-700 text-white shadow-lg":"hover:bg-amber-50 border-amber-300 text-amber-700"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"FUTURE COMMERCIAL"]})]}),(0,l.jsxs)(c.z,{onClick:()=>w("density"),variant:"density"===i?"default":"outline",className:`px-5 py-5 text-sm ${"density"===i?"bg-purple-600 hover:bg-purple-700 text-white shadow-lg":"hover:bg-purple-50"}`,children:[(0,l.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Density Analysis"]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("market"),variant:"market"===i?"default":"outline",className:`px-5 py-5 text-sm ${"market"===i?"bg-green-600 hover:bg-green-700 text-white shadow-lg":"hover:bg-green-50"}`,children:[(0,l.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Market Size"]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("revenue"),variant:"revenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"revenue"===i?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg":"hover:bg-emerald-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),"arizona"===e&&("LEVEL2"===n||"ADMIN"===n)&&(0,l.jsxs)(c.z,{onClick:()=>w("employees"),variant:"employees"===i?"default":"outline",className:`px-5 py-5 text-sm ${"employees"===i?"bg-orange-600 hover:bg-orange-700 text-white shadow-lg":"hover:bg-orange-50"}`,children:[(0,l.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Employee Locations"]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("commercial"),variant:"commercial"===i?"default":"outline",className:`px-5 py-5 text-sm ${"commercial"===i?"bg-amber-600 hover:bg-amber-700 text-white shadow-lg":"hover:bg-amber-50"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Commercial Accounts"]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("routes"),variant:"routes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"routes"===i?"bg-rose-600 hover:bg-rose-700 text-white shadow-lg":"hover:bg-rose-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("ancillarySales"),variant:"ancillarySales"===i?"default":"outline",className:`px-5 py-5 text-sm ${"ancillarySales"===i?"bg-amber-600 hover:bg-amber-700 text-white shadow-lg":"hover:bg-amber-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Ancillary Sales"]}),"jacksonville"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("jaxRevenue"),variant:"jaxRevenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"jaxRevenue"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),(0,l.jsxs)(c.z,{onClick:()=>w("jaxCommercial"),variant:"jaxCommercial"===i?"default":"outline",className:`px-5 py-5 text-sm ${"jaxCommercial"===i?"bg-violet-600 hover:bg-violet-700 text-white shadow-lg":"hover:bg-violet-50"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Commercial Accounts"]}),(0,l.jsxs)(c.z,{onClick:()=>w("jaxRoutes"),variant:"jaxRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"jaxRoutes"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]})]}),"dallas"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("locRevenue"),variant:"locRevenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRevenue"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locCommercial"),variant:"locCommercial"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locCommercial"===i?"bg-violet-600 hover:bg-violet-700 text-white shadow-lg":"hover:bg-violet-50"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Commercial Accounts"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locRoutes"),variant:"locRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRoutes"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]})]}),"orlando"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("locRevenue"),variant:"locRevenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRevenue"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locRoutes"),variant:"locRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRoutes"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]})]}),"portCharlotte"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("locRevenue"),variant:"locRevenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRevenue"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locRoutes"),variant:"locRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRoutes"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]})]}),"miami"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{onClick:()=>w("locRevenue"),variant:"locRevenue"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRevenue"===i?"bg-teal-600 hover:bg-teal-700 text-white shadow-lg":"hover:bg-teal-50"}`,children:[(0,l.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Revenue Analysis"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locCommercial"),variant:"locCommercial"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locCommercial"===i?"bg-violet-600 hover:bg-violet-700 text-white shadow-lg":"hover:bg-violet-50"}`,children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Commercial Accounts"]}),(0,l.jsxs)(c.z,{onClick:()=>w("locRoutes"),variant:"locRoutes"===i?"default":"outline",className:`px-5 py-5 text-sm ${"locRoutes"===i?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg":"hover:bg-indigo-50"}`,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Routes by Tech"]})]}),"arizona"===e&&(0,l.jsxs)(c.z,{onClick:()=>w("lookup"),variant:"lookup"===i?"default":"outline",className:`px-5 py-5 text-sm ${"lookup"===i?"bg-cyan-600 hover:bg-cyan-700 text-white shadow-lg":"hover:bg-cyan-50"}`,children:[(0,l.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Customer Lookup"]})]})})}),"territory"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Total Territories"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:"3"}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"North, Central, South"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-green-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"ZIP Codes"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:B.length}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Across Miami-Dade County"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5 text-orange-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Total Accounts"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:B.reduce((e,s)=>e+(s.accountCount||0),0)}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Residential customers"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5 text-purple-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Avg per ZIP"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:B.length>0?Math.round(B.reduce((e,s)=>e+(s.accountCount||0),0)/B.length):0}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Account density"})]})]})})}),(0,l.jsx)(s9,{variant:"detailed",areaFilter:L,data:B,onToggle:el,onReset:er}),(0,l.jsx)(eS,{areaFilter:L})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Total Areas"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:"4"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-green-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Zip Codes"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:eo})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(f.Z,{className:"h-5 w-5 text-orange-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Total Accounts"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:ei})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5 text-purple-600 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:"Avg per Zip"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:eo>0?Math.round(ei/eo):0})]})]})})}),(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Territory Filters"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:Object.entries(M).filter(([e])=>"Commercial"!==e).map(([e,s])=>(0,l.jsxs)("button",{className:`cursor-pointer px-4 py-3 rounded-md border transition-all hover:shadow-md flex flex-col items-start ${"West"===e&&s?"bg-blue-500 hover:bg-blue-600 text-white border-blue-600":"Central"===e&&s?"bg-green-500 hover:bg-green-600 text-white border-green-600":"East"===e&&s?"bg-orange-500 hover:bg-orange-600 text-white border-orange-600":"Tucson"===e&&s?"bg-purple-500 hover:bg-purple-600 text-white border-purple-600":"bg-white hover:bg-slate-100 text-slate-700 border-slate-300"}`,onClick:()=>es(e),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 font-medium",children:["West"===e&&"\uD83D\uDFE6","Central"===e&&"\uD83D\uDFE9","East"===e&&"\uD83D\uDFE7","Tucson"===e&&"\uD83D\uDFEA","West"===e&&"APS-Glendale","Central"===e&&"APS-Scottsdale","East"===e&&"APS-Chandler","Tucson"===e&&"APS-Tucson",(0,l.jsxs)("span",{className:"text-xs",children:["(",Y?.[e]?.zipCodes||0,")"]})]}),(0,l.jsxs)("div",{className:`text-[10px] italic mt-0.5 ${s?"text-white/80":"text-slate-500"}`,children:["West"===e&&"Phoenix west metro area","Central"===e&&"Phoenix central/north metro area","East"===e&&"Phoenix east metro area","Tucson"===e&&"Tucson metro area"]})]},e))})]}),(0,l.jsx)("div",{className:"lg:w-auto",children:(0,l.jsx)(c.z,{onClick:et,variant:"outline",className:"w-full lg:w-auto",children:"Reset Filters"})})]})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[(0,l.jsx)("div",{className:"xl:col-span-3",children:(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-0",children:(0,l.jsx)(E,{territoryData:P,areaFilter:M})})})}),(0,l.jsxs)("div",{className:"xl:col-span-1 space-y-6",children:[(0,l.jsx)(s2,{}),Y&&(0,l.jsx)(s6,{areaStats:Y})]})]})]})}):"kmlScenario"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsx)(eR,{areaFilter:L}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(m.Z,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"KML Boundary Scenario is only available for Miami, FL."})]})})}):"assignmentTool"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(eL,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(m.Z,{className:"h-12 w-12 text-pink-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Miami Breakup Scenario II is only available for Miami, FL."})]})})}):"miamiFinal"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(eJ,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(h.Z,{className:"h-12 w-12 text-emerald-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Final Miami Territory Map is only available for Miami, FL."})]})})}):"miami10pct"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(eH,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(u.Z,{className:"h-12 w-12 text-indigo-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"10% Reassignment Optimization is only available for Miami, FL."})]})})}):"miamiZipOptimized"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(e2,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(m.Z,{className:"h-12 w-12 text-teal-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"ZIP-Optimized Scenario is only available for Miami, FL."})]})})}):"miamiZipOptimized2"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(e9,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(m.Z,{className:"h-12 w-12 text-cyan-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"ZIP-Optimized #2 Scenario is only available for Miami, FL."})]})})}):"radicalReroute"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s9,{className:"mb-4",areaFilter:L,onToggle:el,onReset:er}),(0,l.jsx)(sn,{areaFilter:L})]}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(f.Z,{className:"h-12 w-12 text-purple-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Radical Reroute Scenario is only available for Miami, FL."})]})})}):"miamiCommercialRoutes"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsx)(sh,{}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(p.Z,{className:"h-12 w-12 text-emerald-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Commercial Routes is only available for Miami, FL."})]})})}):"miamiFutureCommercialRoutes"===i?(0,l.jsx)(l.Fragment,{children:"miami"===e?(0,l.jsx)(sb,{}):(0,l.jsx)(o.Zb,{className:"max-w-md mx-auto",children:(0,l.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,l.jsx)(p.Z,{className:"h-12 w-12 text-amber-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Miami Only"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Future Commercial Routes is only available for Miami, FL."})]})})}):"density"===i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s_,{densityMode:k,onDensityModeChange:z,showLifetime:"miami"===e||"dallas"===e||"orlando"===e||"jacksonville"===e,accountType:T,onAccountTypeChange:Z,showAccountTypeToggle:"miami"===e||"dallas"===e||"orlando"===e||"jacksonville"===e}),"arizona"===e&&(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Territory Filters"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:Object.entries(M).map(([e,s])=>(0,l.jsxs)(d.C,{variant:s?"default":"outline",className:`cursor-pointer px-4 py-2 transition-all hover:shadow-md ${"West"===e&&s?"bg-blue-500 hover:bg-blue-600":"Central"===e&&s?"bg-green-500 hover:bg-green-600":"East"===e&&s?"bg-orange-500 hover:bg-orange-600":"Tucson"===e&&s?"bg-purple-500 hover:bg-purple-600":"hover:bg-slate-100"}`,onClick:()=>es(e),children:["West"===e&&"\uD83D\uDFE6","Central"===e&&"\uD83D\uDFE9","East"===e&&"\uD83D\uDFE7","Tucson"===e&&"\uD83D\uDFEA","Tucson"===e?"Tucson":`Phoenix ${e}`]},e))})]}),(0,l.jsx)("div",{className:"lg:w-auto",children:(0,l.jsx)(c.z,{onClick:et,variant:"outline",className:"w-full lg:w-auto",children:"Reset Filters"})})]})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[(0,l.jsx)("div",{className:"xl:col-span-3",children:(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-0",children:(0,l.jsx)($,{densityMode:k,areaFilter:M,location:e,accountType:T})})})}),(0,l.jsx)("div",{className:"xl:col-span-1 space-y-6",children:(0,l.jsx)(sH,{mode:k,location:e,accountType:T})})]})]}):"market"===i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Territory Filters"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:Object.entries(M).map(([e,s])=>(0,l.jsxs)(d.C,{variant:s?"default":"outline",className:`cursor-pointer px-4 py-2 transition-all hover:shadow-md ${"West"===e&&s?"bg-blue-500 hover:bg-blue-600":"Central"===e&&s?"bg-green-500 hover:bg-green-600":"East"===e&&s?"bg-orange-500 hover:bg-orange-600":"Tucson"===e&&s?"bg-purple-500 hover:bg-purple-600":"hover:bg-slate-100"}`,onClick:()=>es(e),children:["West"===e&&"\uD83D\uDFE6","Central"===e&&"\uD83D\uDFE9","East"===e&&"\uD83D\uDFE7","Tucson"===e&&"\uD83D\uDFEA","Tucson"===e?"Tucson":`Phoenix ${e}`]},e))})]}),(0,l.jsx)("div",{className:"lg:w-auto",children:(0,l.jsx)(c.z,{onClick:et,variant:"outline",className:"w-full lg:w-auto",children:"Reset Filters"})})]})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[(0,l.jsx)("div",{className:"xl:col-span-3",children:(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-0",children:(0,l.jsx)(D,{areaFilter:M})})})}),(0,l.jsxs)("div",{className:"xl:col-span-1 space-y-6",children:[(0,l.jsx)(sq,{}),(0,l.jsx)(s0,{areaFilter:M})]})]})]}):"revenue"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(X,{areaFilter:M,onToggleArea:es,onResetFilters:et})}):"employees"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg h-[800px]",children:(0,l.jsx)(o.aY,{className:"p-0 h-full",children:(0,l.jsx)(Q,{})})})}):"commercial"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.Zb,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsxs)(o.aY,{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Commercial Account Locations"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Visualization of 73 commercial pool accounts across Arizona. Each account is shown as a marker color-coded by its assigned branch. Click any marker to view account details."})]}),(0,l.jsxs)("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900 mb-3",children:"Legend"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-700 mb-2",children:"Account Markers (by Branch Assignment):"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:"#9333ea",border:"2px solid white"}}),(0,l.jsx)("span",{children:"APS - Commercial (58.9% of accounts)"})]}),(0,l.jsx)("div",{className:"text-xs text-slate-600 ml-6 mt-1",children:"Commercial locations within the footprint of APS of Glendale and APS of Scottsdale"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:"#f97316",border:"2px solid white"}}),(0,l.jsx)("span",{children:"APS of Chandler (38.4% of accounts)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:"#ec4899",border:"2px solid white"}}),(0,l.jsx)("span",{children:"APS of Tucson (2.7% of accounts)"})]})]})]}),(0,l.jsxs)("div",{className:"pt-2 border-t border-slate-200",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-700 mb-2",children:"Office Locations:"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"text-blue-600 text-lg",children:"★"}),(0,l.jsx)("span",{children:"APS of Glendale"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"text-green-600 text-lg",children:"★"}),(0,l.jsx)("span",{children:"APS of Scottsdale"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"text-orange-600 text-lg",children:"★"}),(0,l.jsx)("span",{children:"APS of Chandler"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"text-pink-600 text-lg",children:"★"}),(0,l.jsx)("span",{children:"APS of Tucson"})]})]})]})]})]}),(0,l.jsx)(q,{areaFilter:{...M,Commercial:!0}}),(0,l.jsxs)("div",{className:"mt-6 p-6 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"\uD83D\uDCCA Commercial Account Distribution"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-600"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:"APS - Commercial"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:"43"}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"accounts (58.9%)"})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-600"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:"APS of Chandler"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:"28"}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"accounts (38.4%)"})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-pink-600"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:"APS of Tucson"})]}),(0,l.jsx)("p",{className:"text-3xl font-bold text-pink-600",children:"2"}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"accounts (2.7%)"})]})]}),(0,l.jsx)("div",{className:"mt-4 pt-4 border-t border-purple-200",children:(0,l.jsxs)("p",{className:"text-sm text-slate-700",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Total Commercial Accounts:"})," 73 across all branches"]})})]})]})})}):"routes"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(ea,{areaFilter:Object.keys(M).find(e=>!0===M[e])||"all",onAreaChange:en})}):"lookup"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(em,{})}):"ancillarySales"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(eN,{})}):"jaxRevenue"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sk,{})}):"jaxCommercial"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sZ,{})}):"jaxRoutes"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sM,{})}):"locRevenue"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sQ,{location:e})}):"locCommercial"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sD,{location:e})}):"locRoutes"===i?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sI,{location:e})}):null]})})})}var tl=t(6815);function ta({selectedLocation:e,onLocationChange:s}){return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(tl._,{htmlFor:"location-select",className:"text-sm font-medium whitespace-nowrap",children:"Location:"}),(0,l.jsxs)(K.Ph,{value:e,onValueChange:s,children:[(0,l.jsx)(K.i4,{id:"location-select",className:"w-[220px]",children:(0,l.jsx)(K.ki,{placeholder:"Select location"})}),(0,l.jsxs)(K.Bw,{children:[(0,l.jsx)(K.Ql,{value:"arizona",children:"Phoenix / Tucson AZ"}),(0,l.jsx)(K.Ql,{value:"dallas",children:"Dallas TX"}),(0,l.jsx)(K.Ql,{value:"orlando",children:"Orlando FL"}),(0,l.jsx)(K.Ql,{value:"jacksonville",children:"Jacksonville FL"}),(0,l.jsx)(K.Ql,{value:"portCharlotte",children:"Port Charlotte FL"}),(0,l.jsx)(K.Ql,{value:"miami",children:"Miami FL"})]})]})]})}var tr=t(8906),tn=t(1884),ti=t(7692);function to(){let{data:e}=(0,r.useSession)(),s=e?.user?.role,t=e?.user?.email,[d,m]=(0,a.useState)("arizona"),h="ADMIN"===s?{label:"Administrator",color:"bg-red-100 text-red-800",icon:tr.Z}:"LEVEL2"===s?{label:"Level 2",color:"bg-[#27add6]/20 text-[#1e759d]",icon:tn.Z}:{label:"Level 1",color:"bg-[#53bc53]/20 text-[#53bc53]",icon:er.Z},u=h.icon;return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-[#27add6]/10",children:[(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsx)(o.Zb,{className:"mb-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:(0,l.jsxs)(o.aY,{className:"p-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u,{className:"h-5 w-5 text-slate-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:t})]}),(0,l.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${h.color}`,children:h.label})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:["ADMIN"===s&&(0,l.jsx)(n.default,{href:"/admin",children:(0,l.jsxs)(c.z,{variant:"outline",size:"sm",className:"gap-2 border-[#1e759d] text-[#1e759d] hover:bg-[#1e759d]/10",children:[(0,l.jsx)(tn.Z,{className:"h-4 w-4"}),"Manage Users"]})}),(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>(0,r.signOut)({callbackUrl:"/login"}),className:"gap-2",children:[(0,l.jsx)(ti.Z,{className:"h-4 w-4"}),"Sign Out"]})]})]})}),(0,l.jsxs)("header",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"flex justify-center mb-4",children:(0,l.jsx)(i.default,{src:"/aps-logo-horizontal.png",alt:"Amenity Pool Services",width:350,height:100,priority:!0})}),(0,l.jsx)("h1",{className:"text-3xl font-bold text-[#1e759d] mb-3",children:"Data Visualization Tools"}),(0,l.jsx)("p",{className:"text-lg text-slate-600 mb-2",children:"Marketing, Routing, Account and Personnel Assignment Tools"}),(0,l.jsxs)("p",{className:"text-sm text-[#e54e4e] font-medium",children:["v0.71 | Questions ? contact ",(0,l.jsx)("a",{href:"mailto:sjohnson@amenitypool.com",className:"hover:underline",children:"sjohnson@amenitypool.com"})]})]}),(0,l.jsx)(o.Zb,{className:"mb-6 bg-gradient-to-r from-[#27add6]/10 to-[#1e759d]/10 border-[#27add6]/30 shadow-lg",children:(0,l.jsx)(o.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"p-3 bg-[#1e759d] rounded-lg",children:(0,l.jsx)(x.Z,{className:"h-6 w-6 text-white"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-[#1e759d] mb-3",children:"Select Location for Analysis"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(ta,{selectedLocation:d,onLocationChange:e=>m(e)}),(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"Choose a location to view available data analysis tools below"})]})]})]})})}),(0,l.jsx)(tt,{location:d,onLocationChange:e=>m(e)})]}),(0,l.jsx)("footer",{className:"bg-[#1e759d] text-white py-8 mt-12",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(i.default,{src:"/aps-logo-stacked.png",alt:"Amenity Pool Services",width:100,height:100,className:"bg-white rounded-lg p-2"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[#ffdb43] font-semibold",children:"Amenity Pool Services"}),(0,l.jsx)("p",{className:"text-sm text-white/80",children:"Data Visualization Tools"})]})]}),(0,l.jsxs)("div",{className:"text-center md:text-right",children:[(0,l.jsxs)("p",{className:"text-sm text-white/80",children:["\xa9 ",new Date().getFullYear()," Amenity Pool Services. All rights reserved."]}),(0,l.jsx)("p",{className:"text-xs text-white/60 mt-1",children:"Internal use only"})]})]})})})]})}},5974:function(e,s,t){"use strict";t.d(s,{C:function(){return i}});var l=t(7437);t(2265);var a=t(7712),r=t(4508);let n=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,...t}){return(0,l.jsx)("div",{className:(0,r.cn)(n({variant:s}),e),...t})}},2869:function(e,s,t){"use strict";t.d(s,{z:function(){return c}});var l=t(7437),a=t(2265),r=t(7495),n=t(7712),i=t(4508);let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef(({className:e,variant:s,size:t,asChild:a=!1,...n},c)=>{let d=a?r.g7:"button";return(0,l.jsx)(d,{className:(0,i.cn)(o({variant:s,size:t,className:e})),ref:c,...n})});c.displayName="Button"},6070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return n},aY:function(){return d},eW:function(){return m},ll:function(){return o}});var l=t(7437),a=t(2265),r=t(4508);let n=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));n.displayName="Card";let i=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let o=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));o.displayName="CardTitle";let c=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",e),...s}));d.displayName="CardContent";let m=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s}));m.displayName="CardFooter"},5186:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var l=t(7437),a=t(2265),r=t(4508);let n=a.forwardRef(({className:e,type:s,...t},a)=>(0,l.jsx)("input",{type:s,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...t}));n.displayName="Input"},6815:function(e,s,t){"use strict";t.d(s,{_:function(){return c}});var l=t(7437),a=t(2265),r=t(6394),n=t(7712),i=t(4508);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(r.f,{ref:t,className:(0,i.cn)(o(),e),...s}));c.displayName=r.f.displayName},3647:function(e,s,t){"use strict";t.d(s,{Bw:function(){return f},Ph:function(){return d},Ql:function(){return p},i4:function(){return x},ki:function(){return m}});var l=t(7437),a=t(2265),r=t(3820),n=t(875),i=t(2135),o=t(401),c=t(4508);let d=r.fC;r.ZA;let m=r.B4,x=a.forwardRef(({className:e,children:s,...t},a)=>(0,l.jsxs)(r.xz,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[s,(0,l.jsx)(r.JO,{asChild:!0,children:(0,l.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=r.xz.displayName;let h=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(r.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,l.jsx)(i.Z,{className:"h-4 w-4"})}));h.displayName=r.u_.displayName;let u=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(r.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,l.jsx)(n.Z,{className:"h-4 w-4"})}));u.displayName=r.$G.displayName;let f=a.forwardRef(({className:e,children:s,position:t="popper",...a},n)=>(0,l.jsx)(r.h_,{children:(0,l.jsxs)(r.VY,{ref:n,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...a,children:[(0,l.jsx)(h,{}),(0,l.jsx)(r.l_,{className:(0,c.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,l.jsx)(u,{})]})}));f.displayName=r.VY.displayName,a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(r.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=r.__.displayName;let p=a.forwardRef(({className:e,children:s,...t},a)=>(0,l.jsxs)(r.ck,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(r.wU,{children:(0,l.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(r.eT,{children:s})]}));p.displayName=r.ck.displayName,a.forwardRef(({className:e,...s},t)=>(0,l.jsx)(r.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=r.Z0.displayName},3578:function(e,s,t){"use strict";t.d(s,{RM:function(){return o},SC:function(){return c},iA:function(){return n},pj:function(){return m},ss:function(){return d},xD:function(){return i}});var l=t(7437),a=t(2265),r=t(4508);let n=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...s})}));n.displayName="Table";let i=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...s}));i.displayName="TableHeader";let o=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...s}));o.displayName="TableBody",a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let c=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));c.displayName="TableRow";let d=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));d.displayName="TableHead";let m=a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));m.displayName="TableCell",a.forwardRef(({className:e,...s},t)=>(0,l.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption"},4508:function(e,s,t){"use strict";t.d(s,{G:function(){return n},cn:function(){return r}});var l=t(1994),a=t(3335);function r(...e){return(0,a.m6)((0,l.W)(e))}function n(e){return({West:"APS of Glendale",Central:"APS of Scottsdale",East:"APS of Chandler",Tucson:"APS of Tucson",Commercial:"APS - Commercial",Mesa:"APS of Mesa",Goodyear:"APS of Goodyear","Cave Creek":"APS of Cave Creek"})[e]||e}}},function(e){e.O(0,[910,960,605,145,287,197,971,117,744],function(){return e(e.s=425)}),_N_E=e.O()}]);