"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55315:e=>{e.exports=require("path")},11e3:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>g,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var o={};r.r(o),r.d(o,{POST:()=>c});var a=r(49303),s=r(88716),n=r(60670),i=r(87070);let p=require("fs/promises");var l=r(55315);let u=null;async function d(){if(!u){let e=(0,l.join)(process.cwd(),"public","az-zip-boundaries.json");u=JSON.parse(await (0,p.readFile)(e,"utf-8"))}return u}async function c(e){try{let r=(await e.json()).zipCodes||[];if(!r.length)return i.NextResponse.json({error:"No zip codes provided"},{status:400});let o=await d(),a=new Map(r.map(({zip:e,area:t})=>[e.toString(),t])),s=[];for(let e of o.features){var t;let r=e.properties?.ZCTA5CE10||e.properties?.GEOID10||e.properties?.ZCTA;if(!r)continue;let o=a.get(r.toString());if(o){for(let a of(t=e.geometry)?"Polygon"===t.type?[t.coordinates[0]]:"MultiPolygon"===t.type?t.coordinates.map(e=>e[0]):[]:[])if(a.length>0){let e=a.map(e=>({lat:e[1],lng:e[0]})),t=function(e){let t=0,r=0,o=0;for(let a of e)r+=a[0],t+=a[1],o++;return{lat:t/o,lng:r/o}}(a);s.push({zipCode:parseInt(r),area:o,paths:e,center:t})}}}let n=new Set(s.map(e=>e.zipCode)),p=r.filter(({zip:e})=>!n.has(parseInt(String(e))));if(p.length>0){let e="AIzaSyAKMtorawPHrpVNqAZlv5vUpfMSDif57MQ";for(let t=0;t<p.length;t+=10){let r=p.slice(t,t+10);await Promise.all(r.map(async({zip:t,area:r})=>{try{if(!e)return;let o=`https://maps.googleapis.com/maps/api/geocode/json?address=${t}&key=${e}`,a=await fetch(o),n=await a.json();if("OK"===n.status&&n.results?.[0]){let e=n.results[0],o=e.geometry.location,a=e.geometry.bounds;if(a){let e=[{lat:a.northeast.lat,lng:a.northeast.lng},{lat:a.northeast.lat,lng:a.southwest.lng},{lat:a.southwest.lat,lng:a.southwest.lng},{lat:a.southwest.lat,lng:a.northeast.lng}];s.push({zipCode:t,area:r,paths:e,center:o})}}}catch(e){console.error(`Error fetching fallback boundary for zip ${t}:`,e)}})),t+10<p.length&&await new Promise(e=>setTimeout(e,1e3))}}return i.NextResponse.json({boundaries:s})}catch(e){return console.error("Error in zip-boundaries API:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let g=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/zip-boundaries/route",pathname:"/api/zip-boundaries",filename:"route",bundlePath:"app/api/zip-boundaries/route"},resolvedPagePath:"/data/projects/ac_maps/phoenix_territory_map/nextjs_space/app/api/zip-boundaries/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:m}=g,w="/api/zip-boundaries/route";function y(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[276,972],()=>r(11e3));module.exports=o})();