"use strict";(()=>{var e={};e.id=4912,e.ids=[4912],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},18559:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>w,routeModule:()=>c,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var i={};r.r(i),r.d(i,{GET:()=>d,POST:()=>m});var s=r(49303),a=r(88716),o=r(60670),n=r(75571),l=r.n(n),u=r(90455),p=r(35860);let d=l()(u.L);async function m(e,t){return(0,p.Tr)("auth",e,p.rk.auth)||d(e,t)}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/data/projects/ac_maps/phoenix_territory_map/nextjs_space/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:w,staticGenerationAsyncStorage:h,serverHooks:x}=c,g="/api/auth/[...nextauth]/route";function f(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},90455:(e,t,r)=>{r.d(t,{L:()=>o});var i=r(42023),s=r(53797),a=r(9487);let o={session:{strategy:"jwt"},pages:{signIn:"/login",error:"/login"},providers:[(0,s.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Email and password are required");let t=await a._.user.findUnique({where:{email:e.email.toLowerCase()}});if(!t)throw Error("No user found with this email");if(!t.hasRegistered||!t.password)throw Error("Please register your password first");if(!await (0,i.compare)(e.password,t.password))throw Error("Invalid password");return{id:t.id,email:t.email,role:t.role}}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.email=t.email,e.role=t.role),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id,e.user.role=t.role),e)}}},9487:(e,t,r)=>{r.d(t,{_:()=>s});var i=r(53524);let s=globalThis.prisma??new i.PrismaClient},35860:(e,t,r)=>{r.d(t,{Tr:()=>n,rk:()=>s});var i=r(87070);let s={adminUpload:{limit:5,windowSeconds:60},zipBoundaries:{limit:30,windowSeconds:60},auth:{limit:10,windowSeconds:900}},a=new Map,o=null;function n(e,t,r){let s=function(e,t,r){let i;let s=((i=a.get(e))||(i=new Map,a.set(e,i),!o&&(o=setInterval(()=>{let e=Date.now();for(let[,t]of a)for(let[r,i]of t)i.resetAt<=e&&t.delete(r)},6e4))&&"object"==typeof o&&"unref"in o&&o.unref()),i),n=function(e){let t=e.headers.get("x-forwarded-for");return t?t.split(",")[0].trim():e.headers.get("x-real-ip")||"127.0.0.1"}(t),l=Date.now(),u=s.get(n);return!u||u.resetAt<=l?(s.set(n,{count:1,resetAt:l+1e3*r.windowSeconds}),{allowed:!0,limit:r.limit,remaining:r.limit-1,resetAt:l+1e3*r.windowSeconds}):(u.count++,u.count>r.limit)?{allowed:!1,limit:r.limit,remaining:0,resetAt:u.resetAt}:{allowed:!0,limit:r.limit,remaining:r.limit-u.count,resetAt:u.resetAt}}(e,t,r);if(!s.allowed){let e=Math.ceil((s.resetAt-Date.now())/1e3),t=i.NextResponse.json({error:"Too many requests",retryAfter:e},{status:429});return t.headers.set("Retry-After",e.toString()),t.headers.set("X-RateLimit-Limit",s.limit.toString()),t.headers.set("X-RateLimit-Remaining",Math.max(0,s.remaining).toString()),t.headers.set("X-RateLimit-Reset",Math.ceil(s.resetAt/1e3).toString()),t}return null}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[9276,5972,2023,1790],()=>r(18559));module.exports=i})();